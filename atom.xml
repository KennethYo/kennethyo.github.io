<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ•²é”®ç›˜çš„å‘¼ä¼¦è´å°”äºº</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.kennethyo.me/"/>
  <updated>2017-08-02T11:45:30.000Z</updated>
  <id>http://www.kennethyo.me/</id>
  
  <author>
    <name>é¸¿é›</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>adb logcat æŒ‡åŒ—</title>
    <link href="http://www.kennethyo.me/2017/08/02/untitled-1501674058670-1/"/>
    <id>http://www.kennethyo.me/2017/08/02/untitled-1501674058670-1/</id>
    <published>2017-08-02T11:40:58.000Z</published>
    <updated>2017-08-02T11:45:30.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>Nexus 5, Android 6.0.1, API 23</p>
</blockquote>
<p><code>Log</code>ç±»ï¼Œç›¸ä¿¡å¼€å‘ Android çš„åŒå­¦éƒ½ä¸é™Œç”Ÿï¼Œæ­£å¦‚å…¶åï¼Œ<code>Log</code>ç±»æä¾›äº†æ‰“å°æ—¥å¿—åŠŸèƒ½ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨å¼€å‘è°ƒè¯•è¿‡ç¨‹ä¸­è¾“å‡ºè°ƒè¯•ä¿¡æ¯ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79ly1fi4ax7awudj312s04qmyv.jpg" alt=""></p>
<p>æœ‰å¤§ç¥è§‰å¾—è¿™æ ·çš„è¾“å‡ºä¿¡æ¯ä¸å¤Ÿå¤šï¼Œä¸å¤Ÿç¾è§‚ï¼Œä¸å¤Ÿå¼ºå¤§ï¼Œäºæ˜¯å°±æœ‰äº† <a href="https://github.com/orhanobut/logger" target="_blank" rel="external">logger</a>ã€<a href="https://github.com/JakeWharton/hugo" target="_blank" rel="external">hugo</a>ã€<a href="https://github.com/JakeWharton/timber" target="_blank" rel="external">timber</a>ç­‰ log å·¥å…·ç±»ã€‚</p>
<p>è™½ç„¶æœ‰è¿™äº›å¼ºå¤§çš„å·¥å…·æ¥ä½¿ç”¨ï¼Œä½†æ˜¯ä½ ç¦»å¼€äº† IDE  è¿˜ä¼šçœ‹ log å—ï¼Ÿä¸‹é¢æˆ‘ä»¬æ¥ä»‹ç» <code>adb logcat</code>çš„ä½¿ç”¨ã€‚</p>
<h1 id="adb-logcat"><a href="#adb-logcat" class="headerlink" title="adb logcat"></a>adb logcat</h1><p><code>adb</code>å…¨åå«åš<code>Android Debug Bridge</code>ï¼Œä¹Ÿå°±æ˜¯ Android è°ƒè¯•æ¡¥ã€‚æ˜¯ Android SDK æä¾›çš„ä¸€ä¸ª DEBUG å·¥å…·ï¼Œåœ¨ <code>platform-tools</code>ç›®å½•ä¸‹ã€‚</p>
<p><code>logcat</code>æ˜¯Androidç³»ç»Ÿæä¾›çš„ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºè¾“å‡º log æ—¥å¿—ã€‚</p>
<p><code>adb</code>å’Œ<code>logcat</code>å°±ç»„æˆäº†è¿œç¨‹è°ƒè¯•è¾“å‡º log çš„å·¥å…·ã€‚ğŸ˜“</p>
<p>æŠŠ SDK çš„<code>platform-tools</code>é…ç½®åˆ°äº†ç¯å¢ƒå˜é‡å½“ä¸­ï¼Œåœ¨ä»»æ„ä½ç½®éƒ½å¯ä»¥è°ƒç”¨<code>adb</code>æŒ‡ä»¤ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ¯æ¬¡éƒ½è¿›å…¥åˆ°ç›®å½•ä¸‹è¿›è¡Œè°ƒç”¨â€¦</p>
<p>è°ƒç”¨<code>logcat</code>æŒ‡ä»¤æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯å‰é¢è¯´çš„ï¼Œç›´æ¥<code>adb logcat</code>ï¼Œå¦ä¸€ç§æ˜¯<code>adb shell</code>è¿›å…¥æ‰‹æœºçš„ shell é¢æ¿ï¼Œç„¶ååœ¨è°ƒç”¨<code>logcat</code>ã€‚ä¸‹é¢æˆ‘éƒ½ä¼šä½¿ç”¨<code>adb logcat</code>è¿™ç§æ–¹å¼è¿›è¡Œæ¼”ç¤ºã€‚</p>
<h1 id="è¯­æ³•æ ¼å¼"><a href="#è¯­æ³•æ ¼å¼" class="headerlink" title="è¯­æ³•æ ¼å¼"></a>è¯­æ³•æ ¼å¼</h1><p><code>logcat</code>çš„è¯­æ³•æ ¼å¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">logcat [options] [filterspecs]</div></pre></td></tr></table></figure></p>
<h1 id="å‘½ä»¤å‚æ•°"><a href="#å‘½ä»¤å‚æ•°" class="headerlink" title="å‘½ä»¤å‚æ•°"></a>å‘½ä»¤å‚æ•°</h1><table>
<thead>
<tr>
<th style="text-align:left">å‚æ•°</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-s</td>
<td style="text-align:left">è®¾ç½®è¿‡æ»¤å™¨</td>
</tr>
<tr>
<td style="text-align:left">-v format</td>
<td style="text-align:left">è®¾ç½®æ—¥å¿—æ‰“å°æ ¼å¼</td>
</tr>
<tr>
<td style="text-align:left">-f filename</td>
<td style="text-align:left">æ—¥å¿—è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶</td>
</tr>
<tr>
<td style="text-align:left">-r kbytes</td>
<td style="text-align:left">æ¯ kbytes è¾“å‡ºæ—¥å¿—ï¼Œä¸-fä¸€èµ·ä½¿ç”¨</td>
</tr>
<tr>
<td style="text-align:left">-n count</td>
<td style="text-align:left">è®¾ç½®æ—¥å¿—æœ€å¤§æ•°ç›®</td>
</tr>
<tr>
<td style="text-align:left">-b buffer</td>
<td style="text-align:left">åŠ è½½æ—¥å¿—ç¼“å†²åŒº</td>
</tr>
<tr>
<td style="text-align:left">-D</td>
<td style="text-align:left">åœ¨ä¸åŒçš„ç¼“å†²åŒºæ—¥å¿—ä¹‹é—´æ·»åŠ åˆ†å‰²çº¿</td>
</tr>
<tr>
<td style="text-align:left">-c</td>
<td style="text-align:left">æ¸…é™¤ç¼“å†²åŒºå¹¶é€€å‡º</td>
</tr>
<tr>
<td style="text-align:left">-d</td>
<td style="text-align:left">æ‰“å°ç¼“å†²åŒºçš„logï¼Œå¹¶é€€å‡º</td>
</tr>
<tr>
<td style="text-align:left">-g</td>
<td style="text-align:left">æ‰“å°ç¯å½¢ç¼“å†²åŒºå¤§å°</td>
</tr>
<tr>
<td style="text-align:left">-G size</td>
<td style="text-align:left">è®¾ç½®ç¯å½¢ç¼“å†²åŒºå¤§å°</td>
</tr>
<tr>
<td style="text-align:left">-t count</td>
<td style="text-align:left">æ‰“å°æœ€è¿‘ count è¡Œæ—¥å¿—ï¼ŒåŒ…å« -d å‘½ä»¤</td>
</tr>
<tr>
<td style="text-align:left">-t time</td>
<td style="text-align:left">æ‰“å°æœ€è¿‘ä» time å¼€å§‹çš„æ—¥å¿—ï¼ŒåŒ…å« -d å‘½ä»¤ï¼Œæ—¶é—´æ ¼å¼ MM-DD hh:mm:ss.mmm</td>
</tr>
<tr>
<td style="text-align:left">-T count</td>
<td style="text-align:left">æ‰“å°æœ€è¿‘ count è¡Œæ—¥å¿—ï¼Œä¸åŒ…å« -d å‘½ä»¤</td>
</tr>
<tr>
<td style="text-align:left">-T time</td>
<td style="text-align:left">æ‰“å°æœ€è¿‘ä» time å¼€å§‹çš„æ—¥å¿—ï¼Œä¸åŒ…å« -d å‘½ä»¤ï¼Œæ—¶é—´æ ¼å¼ MM-DD hh:mm:ss.mmm</td>
</tr>
<tr>
<td style="text-align:left">-L</td>
<td style="text-align:left">æ‰“å°ä¸Šæ¬¡å¯åŠ¨ä¹‹å‰çš„æ—¥å¿—</td>
</tr>
<tr>
<td style="text-align:left">-B</td>
<td style="text-align:left">è¾“å‡ºäºŒè¿›åˆ¶æ—¥å¿—</td>
</tr>
<tr>
<td style="text-align:left">-S</td>
<td style="text-align:left">è¾“å‡ºç»Ÿè®¡</td>
</tr>
<tr>
<td style="text-align:left">-P list.</td>
<td style="text-align:left">è®¾ç½® log é»‘ç™½åå•</td>
</tr>
<tr>
<td style="text-align:left">-p</td>
<td style="text-align:left">è·å– log é»‘ç™½åå•</td>
</tr>
</tbody>
</table>
<h1 id="s"><a href="#s" class="headerlink" title="-s"></a>-s</h1><p>è®¾ç½®é»˜è®¤è¿‡æ»¤å™¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -s &lt;tag&gt;[:priority]</div></pre></td></tr></table></figure></p>
<p><code>tag</code>ï¼šå¯¹åº” log çš„ tagã€‚å€¼<code>*</code>ä»£è¡¨å…¨éƒ¨ï¼Œå¦‚æœåªæœ‰<code>*</code>ï¼Œç­‰äº<code>*:D</code>ï¼Œå¦‚æœä»…æœ‰<code>&lt;tag&gt;</code>ï¼Œç­‰äº<code>&lt;tag&gt;:V</code>ã€‚</p>
<p><code>priority</code>ï¼šä¼˜å…ˆçº§ï¼Œä»ä½åˆ°é«˜åˆ†åˆ«æ˜¯Vï¼ŒDï¼ŒIï¼ŒWï¼ŒEï¼ŒFï¼ŒSã€‚Vï¼Œå…¨éƒ¨è¾“å‡ºã€‚Sï¼Œå…¨éƒ¨è¾“å‡ºã€‚</p>
<p>ä¾‹1ï¼Œåªè¾“å‡º tag ä¸º test çš„ logï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">adb logcat -s test</div><div class="line">#æˆ–è€…</div><div class="line">adb logcat -s test:V</div></pre></td></tr></table></figure></p>
<p>ä¾‹2ï¼Œåªè¾“å‡ºä¼˜å…ˆçº§å¤§äº W çš„æ—¥å¿—ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -s *:W</div></pre></td></tr></table></figure></p>
<p>ä¾‹3ï¼Œè¾“å‡º tag ä¸º test çš„ E çº§åˆ« å’Œ tag ä¸º test1 çš„ W çº§åˆ«æ—¥å¿—ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -s test:E test1:W</div></pre></td></tr></table></figure></p>
<h1 id="v"><a href="#v" class="headerlink" title="-v"></a>-v</h1><p>è®¾ç½®æ—¥å¿—æ‰“å°æ ¼å¼ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -v &lt;format&gt;</div></pre></td></tr></table></figure></p>
<p>format å…±æœ‰ briefã€colorã€longã€printableã€processã€rawã€tagã€threadã€threadtimeã€timeã€usec æ ¼å¼ï¼Œé»˜è®¤ threadtimeã€‚</p>
<p>å„ç§è¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">#Java ä»£ç </div><div class="line">#private final static String TAG_0 = &quot;sth0&quot;;</div><div class="line">#Log.v(TAG_0, &quot;0 Send a verbose log message&quot;);</div><div class="line"></div><div class="line">#å‘½ä»¤</div><div class="line"># adb logcat -v &lt;format&gt; -s sth0:W</div><div class="line"></div><div class="line">#brief</div><div class="line">W/sth0    ( 1065): 0 Send a warn log message</div><div class="line"></div><div class="line">#color å…¶å®åœ¨ Terminal é‡Œé¢æ˜¯æœ‰é¢œè‰²çš„</div><div class="line">08-02 09:38:42.094  1065  1065 W sth0    : 0 Send a warn log message</div><div class="line"></div><div class="line">#long</div><div class="line">[ 08-02 09:38:42.094  1065: 1065 W/sth0     ]</div><div class="line">0 Send a warn log message</div><div class="line"></div><div class="line">#printable</div><div class="line">08-02 09:38:42.094  1065  1065 W sth0    : 0 Send a warn log message</div><div class="line"></div><div class="line">#process</div><div class="line">W( 1065) 0 Send a warn log message  (sth0)</div><div class="line"></div><div class="line">#raw</div><div class="line">0 Send a warn log message</div><div class="line"></div><div class="line">#tag</div><div class="line">W/sth0    : 0 Send a warn log message</div><div class="line"></div><div class="line">#thread</div><div class="line">W( 1065: 1065) 0 Send a warn log message</div><div class="line"></div><div class="line">#threadtime</div><div class="line">08-02 09:38:42.094  1065  1065 W sth0    : 0 Send a warn log message</div><div class="line"></div><div class="line">#time</div><div class="line">08-02 09:38:42.094 W/sth0    ( 1065): 0 Send a warn log message</div><div class="line"></div><div class="line">#usec</div><div class="line">08-02 09:38:42.094771  1065  1065 W sth0    : 0 Send a warn log message</div></pre></td></tr></table></figure></p>
<h1 id="f"><a href="#f" class="headerlink" title="-f"></a>-f</h1><p>è¾“å‡ºlogåˆ°æŒ‡å®šæ–‡ä»¶ã€‚<code>&lt;filename&gt;</code>æ˜¯æ‰‹æœºå†…çš„æ–‡ä»¶ï¼Œå¹¶ä¸æ˜¯è°ƒè¯•ç”¨çš„ç”µè„‘ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -f &lt;filename&gt;</div></pre></td></tr></table></figure></p>
<h1 id="r"><a href="#r" class="headerlink" title="-r"></a>-r</h1><p>è®¾ç½®æ¯<code>&lt;kbytes&gt;</code>æ—¶è¾“å‡ºæ—¥å¿—ï¼Œéœ€è¦å’Œ<code>-f</code>ä¸€èµ·ä½¿ç”¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -f &lt;filenam&gt; -r &lt;kbytes&gt;</div></pre></td></tr></table></figure></p>
<h1 id="n"><a href="#n" class="headerlink" title="-n"></a>-n</h1><p>è®¾ç½®æ—¥å¿—æ¯æ¬¡æœ€å¤§è¾“å‡º<code>&lt;count&gt;</code>è¡Œï¼Œéœ€è¦å’Œ<code>-f</code>ä¸€èµ·ä½¿ç”¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -f &lt;filenam&gt; -n &lt;count&gt;</div></pre></td></tr></table></figure></p>
<h1 id="b"><a href="#b" class="headerlink" title="-b"></a>-b</h1><p>åŠ è½½æ—¥å¿—ç¼“å†²åŒºï¼Œ<code>&lt;buffer&gt;</code>çš„å€¼æœ‰<code>main</code>ï¼Œ<code>system</code>ï¼Œ<code>radio</code>ï¼Œ<code>events</code>ï¼Œ<code>crash</code>ï¼Œ<code>all</code>ã€‚é»˜è®¤<code>main</code>ï¼Œ<code>system</code>ï¼Œ<code>crash</code>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -b &lt;buffer&gt;</div></pre></td></tr></table></figure></p>
<p>ä¾‹ï¼ŒåŠ è½½<code>radio</code>ï¼Œ<code>events</code>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -b radio -b events</div></pre></td></tr></table></figure></p>
<h1 id="D"><a href="#D" class="headerlink" title="-D"></a>-D</h1><p>åœ¨ä¸åŒçš„ç¼“å†²åŒºæ—¥å¿—ä¹‹é—´æ·»åŠ åˆ†å‰²çº¿ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -D</div></pre></td></tr></table></figure></p>
<h1 id="c"><a href="#c" class="headerlink" title="-c"></a>-c</h1><p>æ¸…é™¤ç¼“å†²åŒºæ—¥å¿—ï¼Œå¹¶é€€å‡ºã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -c</div></pre></td></tr></table></figure></p>
<h1 id="d"><a href="#d" class="headerlink" title="-d"></a>-d</h1><p>æ‰“å°ç¼“å†²åŒºæ—¥å¿—ï¼Œå¹¶é€€å‡ºã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -d</div></pre></td></tr></table></figure></p>
<h1 id="g"><a href="#g" class="headerlink" title="-g"></a>-g</h1><p>æ‰“å°ç¼“å†²åŒºå¤§å°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -g</div></pre></td></tr></table></figure></p>
<h1 id="G"><a href="#G" class="headerlink" title="-G"></a>-G</h1><p>è®¾ç½®ç¼“å†²åŒºå¤§å°ã€‚<code>&lt;size&gt;</code>ï¼Œä»¥<code>K</code>ç»“å°¾ï¼Œå•ä½ kbï¼Œä»¥<code>M</code>ç»“å°¾ï¼Œå•ä½ MBã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -G &lt;size&gt;</div></pre></td></tr></table></figure></p>
<p>ä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -G 100K</div></pre></td></tr></table></figure></p>
<h1 id="t"><a href="#t" class="headerlink" title="-t"></a>-t</h1><p>åŒ…å« <code>-d</code> åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯æ‰“å°åé€€å‡ºã€‚<br>æ‰“å°æœ€è¿‘<code>&lt;size&gt;</code>è¡Œæ—¥å¿—ã€‚<br>æ‰“å°ä»<code>&#39;&lt;time&gt;&#39;</code>æ—¶é—´å¼€å§‹çš„æ—¥å¿—ã€‚æ—¶é—´æ ¼å¼<code>MM-DD hh:mm:ss.mmm</code>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">adb logcat -t &lt;size&gt;</div><div class="line">adb logcat -t &apos;&lt;time&gt;&apos;</div></pre></td></tr></table></figure></p>
<p>ä¾‹1ï¼Œæ‰“å°æœ€è¿‘1000è¡Œæ—¥å¿—ï¼Œå¹¶ä¸”è¿‡æ»¤å‡º tag ä¸º sth0 çš„æ—¥å¿—ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -t 1000 -s sth0:V</div></pre></td></tr></table></figure></p>
<p>ä¾‹2ï¼Œæ‰“å° 08-02 17:51:20.145  å¼€å§‹çš„æ—¥å¿—<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -t &apos;08-02 17:51:20.145&apos;</div></pre></td></tr></table></figure></p>
<h1 id="T"><a href="#T" class="headerlink" title="-T"></a>-T</h1><p>ä¸åŒ…å« <code>-d</code> åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯æ‰“å°åä¸é€€å‡ºï¼Œä¼šæŒç»­è¾“å‡ºã€‚<br>æ‰“å°æœ€è¿‘<code>&lt;size&gt;</code>è¡Œæ—¥å¿—ã€‚<br>æ‰“å°ä»<code>&#39;&lt;time&gt;&#39;</code>æ—¶é—´å¼€å§‹çš„æ—¥å¿—ã€‚æ—¶é—´æ ¼å¼<code>MM-DD hh:mm:ss.mmm</code>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">adb logcat -T &lt;size&gt;</div><div class="line">adb logcat -T &apos;&lt;time&gt;&apos;</div></pre></td></tr></table></figure></p>
<p>ä¾‹1ï¼Œæ‰“å°æœ€è¿‘1000è¡Œæ—¥å¿—ï¼Œå¹¶ä¸”è¿‡æ»¤å‡º tag ä¸º sth0 çš„æ—¥å¿—ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -T 1000 -s sth0:V</div></pre></td></tr></table></figure></p>
<p>ä¾‹2ï¼Œæ‰“å° 08-02 17:51:20.145  å¼€å§‹çš„æ—¥å¿—<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -T &apos;08-02 17:51:20.145&apos;</div></pre></td></tr></table></figure></p>
<h1 id="L"><a href="#L" class="headerlink" title="-L"></a>-L</h1><p>æ‰“å°æœ€åä¸€æ¬¡é‡å¯ä¹‹å‰çš„æ—¥å¿—ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -L</div></pre></td></tr></table></figure></p>
<h1 id="B"><a href="#B" class="headerlink" title="-B"></a>-B</h1><p>è¾“å‡ºæ—¥å¿—çš„äºŒè¿›åˆ¶æ ¼å¼ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -B</div></pre></td></tr></table></figure></p>
<h1 id="S"><a href="#S" class="headerlink" title="-S"></a>-S</h1><p>è¾“å‡ºç»Ÿè®¡ä¿¡æ¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -S</div></pre></td></tr></table></figure></p>
<h1 id="P"><a href="#P" class="headerlink" title="-P"></a>-P</h1><p>è®¾ç½®é»‘ç™½åå•ã€‚å¯ä»¥å¯¹ <code>UID</code>ï¼Œ<code>PID</code>è®¾ç½®ï¼Œä¹Ÿå¯ä»¥<code>UID/PID</code>ä¸€èµ·è®¾ç½®ã€‚è®¾ç½®é»‘åå•ï¼Œå‰ç¼€<code>~</code>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -P &apos;&lt;list&gt;...&apos;</div></pre></td></tr></table></figure></p>
<p>ä¾‹1ï¼Œå¯¹<code>UID</code> 520881è®¾ç½®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat - P &apos;520881&apos;</div></pre></td></tr></table></figure></p>
<p>ä¾‹2ï¼Œå¯¹<code>PID</code> 520881 è®¾ç½®é»‘åå•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -P &apos;~/520881&apos;</div></pre></td></tr></table></figure></p>
<p>ä¾‹3ï¼Œå¯¹<code>UID</code> 520881ï¼Œå¯¹<code>PID</code> 78883ï¼Œå¯¹ <code>UID/PID</code> 52189/8883 è®¾ç½®é»‘åå•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -P `~520881 ~/78883 ~52189/8883&apos;</div></pre></td></tr></table></figure></p>
<h1 id="p"><a href="#p" class="headerlink" title="-p"></a>-p</h1><p>æŸ¥çœ‹é»‘ç™½åå•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -p</div></pre></td></tr></table></figure></p>
<h1 id="è¿›é˜¶"><a href="#è¿›é˜¶" class="headerlink" title="è¿›é˜¶"></a>è¿›é˜¶</h1><p>åˆ©ç”¨ shell é‡å®šå‘è¾“å‡ºæ—¥å¿—åˆ°æŒ‡å®šæ–‡ä»¶ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#è¾“å‡ºsth0:Våˆ°æ¡Œé¢1.logæ–‡ä»¶</div><div class="line">adb logcat -s sth0:V &gt;~/Desktop/1.log</div></pre></td></tr></table></figure></p>
<p>åˆ©ç”¨ <code>grep</code> è¿‡æ»¤æ—¥å¿—ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># è¿‡æ»¤æ—¥å¿—åŒ…å« verbose çš„æ—¥å¿—</div><div class="line">adb logcat | grep verbose </div><div class="line"># è¿‡æ»¤æ—¥å¿—åŒ…å« verbose çš„æ—¥å¿—ï¼Œå¿½ç•¥å¤§å°å†™</div><div class="line">adb logcat | grep -i verbose</div><div class="line"># è¿‡æ»¤ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼ sth. çš„æ—¥å¿—</div><div class="line">adb logcat | grep -e sth.</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Nexus 5, Android 6.0.1, API 23&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;Log&lt;/code&gt;ç±»ï¼Œç›¸ä¿¡å¼€å‘ Android çš„åŒå­¦éƒ½ä¸é™Œç”Ÿï¼Œæ­£å¦‚å…¶åï¼Œ&lt;code&gt;Log&lt;/code&gt;ç±»æä¾›äº†æ‰“å°æ—¥å¿—åŠŸèƒ½ï¼Œæ–¹
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="log" scheme="http://www.kennethyo.me/tags/log/"/>
    
      <category term="logcat" scheme="http://www.kennethyo.me/tags/logcat/"/>
    
      <category term="adb" scheme="http://www.kennethyo.me/tags/adb/"/>
    
  </entry>
  
  <entry>
    <title>adb logcat æŒ‡åŒ—</title>
    <link href="http://www.kennethyo.me/2017/08/02/untitled-1501674058670/"/>
    <id>http://www.kennethyo.me/2017/08/02/untitled-1501674058670/</id>
    <published>2017-08-02T11:40:58.000Z</published>
    <updated>2017-08-02T11:45:21.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>Nexus 5, Android 6.0.1, API 23</p>
</blockquote>
<p><code>Log</code>ç±»ï¼Œç›¸ä¿¡å¼€å‘ Android çš„åŒå­¦éƒ½ä¸é™Œç”Ÿï¼Œæ­£å¦‚å…¶åï¼Œ<code>Log</code>ç±»æä¾›äº†æ‰“å°æ—¥å¿—åŠŸèƒ½ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨å¼€å‘è°ƒè¯•è¿‡ç¨‹ä¸­è¾“å‡ºè°ƒè¯•ä¿¡æ¯ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79ly1fi4ax7awudj312s04qmyv.jpg" alt=""></p>
<p>æœ‰å¤§ç¥è§‰å¾—è¿™æ ·çš„è¾“å‡ºä¿¡æ¯ä¸å¤Ÿå¤šï¼Œä¸å¤Ÿç¾è§‚ï¼Œä¸å¤Ÿå¼ºå¤§ï¼Œäºæ˜¯å°±æœ‰äº† <a href="https://github.com/orhanobut/logger" target="_blank" rel="external">logger</a>ã€<a href="https://github.com/JakeWharton/hugo" target="_blank" rel="external">hugo</a>ã€<a href="https://github.com/JakeWharton/timber" target="_blank" rel="external">timber</a>ç­‰ log å·¥å…·ç±»ã€‚</p>
<p>è™½ç„¶æœ‰è¿™äº›å¼ºå¤§çš„å·¥å…·æ¥ä½¿ç”¨ï¼Œä½†æ˜¯ä½ ç¦»å¼€äº† IDE  è¿˜ä¼šçœ‹ log å—ï¼Ÿä¸‹é¢æˆ‘ä»¬æ¥ä»‹ç» <code>adb logcat</code>çš„ä½¿ç”¨ã€‚</p>
<h1 id="adb-logcat"><a href="#adb-logcat" class="headerlink" title="adb logcat"></a>adb logcat</h1><p><code>adb</code>å…¨åå«åš<code>Android Debug Bridge</code>ï¼Œä¹Ÿå°±æ˜¯ Android è°ƒè¯•æ¡¥ã€‚æ˜¯ Android SDK æä¾›çš„ä¸€ä¸ª DEBUG å·¥å…·ï¼Œåœ¨ <code>platform-tools</code>ç›®å½•ä¸‹ã€‚</p>
<p><code>logcat</code>æ˜¯Androidç³»ç»Ÿæä¾›çš„ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºè¾“å‡º log æ—¥å¿—ã€‚</p>
<p><code>adb</code>å’Œ<code>logcat</code>å°±ç»„æˆäº†è¿œç¨‹è°ƒè¯•è¾“å‡º log çš„å·¥å…·ã€‚ğŸ˜“</p>
<p>æŠŠ SDK çš„<code>platform-tools</code>é…ç½®åˆ°äº†ç¯å¢ƒå˜é‡å½“ä¸­ï¼Œåœ¨ä»»æ„ä½ç½®éƒ½å¯ä»¥è°ƒç”¨<code>adb</code>æŒ‡ä»¤ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ¯æ¬¡éƒ½è¿›å…¥åˆ°ç›®å½•ä¸‹è¿›è¡Œè°ƒç”¨â€¦</p>
<p>è°ƒç”¨<code>logcat</code>æŒ‡ä»¤æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯å‰é¢è¯´çš„ï¼Œç›´æ¥<code>adb logcat</code>ï¼Œå¦ä¸€ç§æ˜¯<code>adb shell</code>è¿›å…¥æ‰‹æœºçš„ shell é¢æ¿ï¼Œç„¶ååœ¨è°ƒç”¨<code>logcat</code>ã€‚ä¸‹é¢æˆ‘éƒ½ä¼šä½¿ç”¨<code>adb logcat</code>è¿™ç§æ–¹å¼è¿›è¡Œæ¼”ç¤ºã€‚</p>
<h1 id="è¯­æ³•æ ¼å¼"><a href="#è¯­æ³•æ ¼å¼" class="headerlink" title="è¯­æ³•æ ¼å¼"></a>è¯­æ³•æ ¼å¼</h1><p><code>logcat</code>çš„è¯­æ³•æ ¼å¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">logcat [options] [filterspecs]</div></pre></td></tr></table></figure></p>
<h1 id="å‘½ä»¤å‚æ•°"><a href="#å‘½ä»¤å‚æ•°" class="headerlink" title="å‘½ä»¤å‚æ•°"></a>å‘½ä»¤å‚æ•°</h1><table>
<thead>
<tr>
<th style="text-align:left">å‚æ•°</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-s</td>
<td style="text-align:left">è®¾ç½®è¿‡æ»¤å™¨</td>
</tr>
<tr>
<td style="text-align:left">-v format</td>
<td style="text-align:left">è®¾ç½®æ—¥å¿—æ‰“å°æ ¼å¼</td>
</tr>
<tr>
<td style="text-align:left">-f filename</td>
<td style="text-align:left">æ—¥å¿—è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶</td>
</tr>
<tr>
<td style="text-align:left">-r kbytes</td>
<td style="text-align:left">æ¯ kbytes è¾“å‡ºæ—¥å¿—ï¼Œä¸-fä¸€èµ·ä½¿ç”¨</td>
</tr>
<tr>
<td style="text-align:left">-n count</td>
<td style="text-align:left">è®¾ç½®æ—¥å¿—æœ€å¤§æ•°ç›®</td>
</tr>
<tr>
<td style="text-align:left">-b buffer</td>
<td style="text-align:left">åŠ è½½æ—¥å¿—ç¼“å†²åŒº</td>
</tr>
<tr>
<td style="text-align:left">-D</td>
<td style="text-align:left">åœ¨ä¸åŒçš„ç¼“å†²åŒºæ—¥å¿—ä¹‹é—´æ·»åŠ åˆ†å‰²çº¿</td>
</tr>
<tr>
<td style="text-align:left">-c</td>
<td style="text-align:left">æ¸…é™¤ç¼“å†²åŒºå¹¶é€€å‡º</td>
</tr>
<tr>
<td style="text-align:left">-d</td>
<td style="text-align:left">æ‰“å°ç¼“å†²åŒºçš„logï¼Œå¹¶é€€å‡º</td>
</tr>
<tr>
<td style="text-align:left">-g</td>
<td style="text-align:left">æ‰“å°ç¯å½¢ç¼“å†²åŒºå¤§å°</td>
</tr>
<tr>
<td style="text-align:left">-G size</td>
<td style="text-align:left">è®¾ç½®ç¯å½¢ç¼“å†²åŒºå¤§å°</td>
</tr>
<tr>
<td style="text-align:left">-t count</td>
<td style="text-align:left">æ‰“å°æœ€è¿‘ count è¡Œæ—¥å¿—ï¼ŒåŒ…å« -d å‘½ä»¤</td>
</tr>
<tr>
<td style="text-align:left">-t time</td>
<td style="text-align:left">æ‰“å°æœ€è¿‘ä» time å¼€å§‹çš„æ—¥å¿—ï¼ŒåŒ…å« -d å‘½ä»¤ï¼Œæ—¶é—´æ ¼å¼ MM-DD hh:mm:ss.mmm</td>
</tr>
<tr>
<td style="text-align:left">-T count</td>
<td style="text-align:left">æ‰“å°æœ€è¿‘ count è¡Œæ—¥å¿—ï¼Œä¸åŒ…å« -d å‘½ä»¤</td>
</tr>
<tr>
<td style="text-align:left">-T time</td>
<td style="text-align:left">æ‰“å°æœ€è¿‘ä» time å¼€å§‹çš„æ—¥å¿—ï¼Œä¸åŒ…å« -d å‘½ä»¤ï¼Œæ—¶é—´æ ¼å¼ MM-DD hh:mm:ss.mmm</td>
</tr>
<tr>
<td style="text-align:left">-L</td>
<td style="text-align:left">æ‰“å°ä¸Šæ¬¡å¯åŠ¨ä¹‹å‰çš„æ—¥å¿—</td>
</tr>
<tr>
<td style="text-align:left">-B</td>
<td style="text-align:left">è¾“å‡ºäºŒè¿›åˆ¶æ—¥å¿—</td>
</tr>
<tr>
<td style="text-align:left">-S</td>
<td style="text-align:left">è¾“å‡ºç»Ÿè®¡</td>
</tr>
<tr>
<td style="text-align:left">-P list.</td>
<td style="text-align:left">è®¾ç½® log é»‘ç™½åå•</td>
</tr>
<tr>
<td style="text-align:left">-p</td>
<td style="text-align:left">è·å– log é»‘ç™½åå•</td>
</tr>
</tbody>
</table>
<h1 id="s"><a href="#s" class="headerlink" title="-s"></a>-s</h1><p>è®¾ç½®é»˜è®¤è¿‡æ»¤å™¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -s &lt;tag&gt;[:priority]</div></pre></td></tr></table></figure></p>
<p><code>tag</code>ï¼šå¯¹åº” log çš„ tagã€‚å€¼<code>*</code>ä»£è¡¨å…¨éƒ¨ï¼Œå¦‚æœåªæœ‰<code>*</code>ï¼Œç­‰äº<code>*:D</code>ï¼Œå¦‚æœä»…æœ‰<code>&lt;tag&gt;</code>ï¼Œç­‰äº<code>&lt;tag&gt;:V</code>ã€‚</p>
<p><code>priority</code>ï¼šä¼˜å…ˆçº§ï¼Œä»ä½åˆ°é«˜åˆ†åˆ«æ˜¯Vï¼ŒDï¼ŒIï¼ŒWï¼ŒEï¼ŒFï¼ŒSã€‚Vï¼Œå…¨éƒ¨è¾“å‡ºã€‚Sï¼Œå…¨éƒ¨è¾“å‡ºã€‚</p>
<p>ä¾‹1ï¼Œåªè¾“å‡º tag ä¸º test çš„ logï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">adb logcat -s test</div><div class="line">#æˆ–è€…</div><div class="line">adb logcat -s test:V</div></pre></td></tr></table></figure></p>
<p>ä¾‹2ï¼Œåªè¾“å‡ºä¼˜å…ˆçº§å¤§äº W çš„æ—¥å¿—ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -s *:W</div></pre></td></tr></table></figure></p>
<p>ä¾‹3ï¼Œè¾“å‡º tag ä¸º test çš„ E çº§åˆ« å’Œ tag ä¸º test1 çš„ W çº§åˆ«æ—¥å¿—ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -s test:E test1:W</div></pre></td></tr></table></figure></p>
<h1 id="v"><a href="#v" class="headerlink" title="-v"></a>-v</h1><p>è®¾ç½®æ—¥å¿—æ‰“å°æ ¼å¼ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -v &lt;format&gt;</div></pre></td></tr></table></figure></p>
<p>format å…±æœ‰ briefã€colorã€longã€printableã€processã€rawã€tagã€threadã€threadtimeã€timeã€usec æ ¼å¼ï¼Œé»˜è®¤ threadtimeã€‚</p>
<p>å„ç§è¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">#Java ä»£ç </div><div class="line">#private final static String TAG_0 = &quot;sth0&quot;;</div><div class="line">#Log.v(TAG_0, &quot;0 Send a verbose log message&quot;);</div><div class="line"></div><div class="line">#å‘½ä»¤</div><div class="line"># adb logcat -v &lt;format&gt; -s sth0:W</div><div class="line"></div><div class="line">#brief</div><div class="line">W/sth0    ( 1065): 0 Send a warn log message</div><div class="line"></div><div class="line">#color å…¶å®åœ¨ Terminal é‡Œé¢æ˜¯æœ‰é¢œè‰²çš„</div><div class="line">08-02 09:38:42.094  1065  1065 W sth0    : 0 Send a warn log message</div><div class="line"></div><div class="line">#long</div><div class="line">[ 08-02 09:38:42.094  1065: 1065 W/sth0     ]</div><div class="line">0 Send a warn log message</div><div class="line"></div><div class="line">#printable</div><div class="line">08-02 09:38:42.094  1065  1065 W sth0    : 0 Send a warn log message</div><div class="line"></div><div class="line">#process</div><div class="line">W( 1065) 0 Send a warn log message  (sth0)</div><div class="line"></div><div class="line">#raw</div><div class="line">0 Send a warn log message</div><div class="line"></div><div class="line">#tag</div><div class="line">W/sth0    : 0 Send a warn log message</div><div class="line"></div><div class="line">#thread</div><div class="line">W( 1065: 1065) 0 Send a warn log message</div><div class="line"></div><div class="line">#threadtime</div><div class="line">08-02 09:38:42.094  1065  1065 W sth0    : 0 Send a warn log message</div><div class="line"></div><div class="line">#time</div><div class="line">08-02 09:38:42.094 W/sth0    ( 1065): 0 Send a warn log message</div><div class="line"></div><div class="line">#usec</div><div class="line">08-02 09:38:42.094771  1065  1065 W sth0    : 0 Send a warn log message</div></pre></td></tr></table></figure></p>
<h1 id="f"><a href="#f" class="headerlink" title="-f"></a>-f</h1><p>è¾“å‡ºlogåˆ°æŒ‡å®šæ–‡ä»¶ã€‚<code>&lt;filename&gt;</code>æ˜¯æ‰‹æœºå†…çš„æ–‡ä»¶ï¼Œå¹¶ä¸æ˜¯è°ƒè¯•ç”¨çš„ç”µè„‘ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -f &lt;filename&gt;</div></pre></td></tr></table></figure></p>
<h1 id="r"><a href="#r" class="headerlink" title="-r"></a>-r</h1><p>è®¾ç½®æ¯<code>&lt;kbytes&gt;</code>æ—¶è¾“å‡ºæ—¥å¿—ï¼Œéœ€è¦å’Œ<code>-f</code>ä¸€èµ·ä½¿ç”¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -f &lt;filenam&gt; -r &lt;kbytes&gt;</div></pre></td></tr></table></figure></p>
<h1 id="n"><a href="#n" class="headerlink" title="-n"></a>-n</h1><p>è®¾ç½®æ—¥å¿—æ¯æ¬¡æœ€å¤§è¾“å‡º<code>&lt;count&gt;</code>è¡Œï¼Œéœ€è¦å’Œ<code>-f</code>ä¸€èµ·ä½¿ç”¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -f &lt;filenam&gt; -n &lt;count&gt;</div></pre></td></tr></table></figure></p>
<h1 id="b"><a href="#b" class="headerlink" title="-b"></a>-b</h1><p>åŠ è½½æ—¥å¿—ç¼“å†²åŒºï¼Œ<code>&lt;buffer&gt;</code>çš„å€¼æœ‰<code>main</code>ï¼Œ<code>system</code>ï¼Œ<code>radio</code>ï¼Œ<code>events</code>ï¼Œ<code>crash</code>ï¼Œ<code>all</code>ã€‚é»˜è®¤<code>main</code>ï¼Œ<code>system</code>ï¼Œ<code>crash</code>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -b &lt;buffer&gt;</div></pre></td></tr></table></figure></p>
<p>ä¾‹ï¼ŒåŠ è½½<code>radio</code>ï¼Œ<code>events</code>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -b radio -b events</div></pre></td></tr></table></figure></p>
<h1 id="D"><a href="#D" class="headerlink" title="-D"></a>-D</h1><p>åœ¨ä¸åŒçš„ç¼“å†²åŒºæ—¥å¿—ä¹‹é—´æ·»åŠ åˆ†å‰²çº¿ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -D</div></pre></td></tr></table></figure></p>
<h1 id="c"><a href="#c" class="headerlink" title="-c"></a>-c</h1><p>æ¸…é™¤ç¼“å†²åŒºæ—¥å¿—ï¼Œå¹¶é€€å‡ºã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -c</div></pre></td></tr></table></figure></p>
<h1 id="d"><a href="#d" class="headerlink" title="-d"></a>-d</h1><p>æ‰“å°ç¼“å†²åŒºæ—¥å¿—ï¼Œå¹¶é€€å‡ºã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -d</div></pre></td></tr></table></figure></p>
<h1 id="g"><a href="#g" class="headerlink" title="-g"></a>-g</h1><p>æ‰“å°ç¼“å†²åŒºå¤§å°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -g</div></pre></td></tr></table></figure></p>
<h1 id="G"><a href="#G" class="headerlink" title="-G"></a>-G</h1><p>è®¾ç½®ç¼“å†²åŒºå¤§å°ã€‚<code>&lt;size&gt;</code>ï¼Œä»¥<code>K</code>ç»“å°¾ï¼Œå•ä½ kbï¼Œä»¥<code>M</code>ç»“å°¾ï¼Œå•ä½ MBã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -G &lt;size&gt;</div></pre></td></tr></table></figure></p>
<p>ä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -G 100K</div></pre></td></tr></table></figure></p>
<h1 id="t"><a href="#t" class="headerlink" title="-t"></a>-t</h1><p>åŒ…å« <code>-d</code> åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯æ‰“å°åé€€å‡ºã€‚<br>æ‰“å°æœ€è¿‘<code>&lt;size&gt;</code>è¡Œæ—¥å¿—ã€‚<br>æ‰“å°ä»<code>&#39;&lt;time&gt;&#39;</code>æ—¶é—´å¼€å§‹çš„æ—¥å¿—ã€‚æ—¶é—´æ ¼å¼<code>MM-DD hh:mm:ss.mmm</code>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">adb logcat -t &lt;size&gt;</div><div class="line">adb logcat -t &apos;&lt;time&gt;&apos;</div></pre></td></tr></table></figure></p>
<p>ä¾‹1ï¼Œæ‰“å°æœ€è¿‘1000è¡Œæ—¥å¿—ï¼Œå¹¶ä¸”è¿‡æ»¤å‡º tag ä¸º sth0 çš„æ—¥å¿—ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -t 1000 -s sth0:V</div></pre></td></tr></table></figure></p>
<p>ä¾‹2ï¼Œæ‰“å° 08-02 17:51:20.145  å¼€å§‹çš„æ—¥å¿—<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -t &apos;08-02 17:51:20.145&apos;</div></pre></td></tr></table></figure></p>
<h1 id="T"><a href="#T" class="headerlink" title="-T"></a>-T</h1><p>ä¸åŒ…å« <code>-d</code> åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯æ‰“å°åä¸é€€å‡ºï¼Œä¼šæŒç»­è¾“å‡ºã€‚<br>æ‰“å°æœ€è¿‘<code>&lt;size&gt;</code>è¡Œæ—¥å¿—ã€‚<br>æ‰“å°ä»<code>&#39;&lt;time&gt;&#39;</code>æ—¶é—´å¼€å§‹çš„æ—¥å¿—ã€‚æ—¶é—´æ ¼å¼<code>MM-DD hh:mm:ss.mmm</code>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">adb logcat -T &lt;size&gt;</div><div class="line">adb logcat -T &apos;&lt;time&gt;&apos;</div></pre></td></tr></table></figure></p>
<p>ä¾‹1ï¼Œæ‰“å°æœ€è¿‘1000è¡Œæ—¥å¿—ï¼Œå¹¶ä¸”è¿‡æ»¤å‡º tag ä¸º sth0 çš„æ—¥å¿—ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -T 1000 -s sth0:V</div></pre></td></tr></table></figure></p>
<p>ä¾‹2ï¼Œæ‰“å° 08-02 17:51:20.145  å¼€å§‹çš„æ—¥å¿—<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -T &apos;08-02 17:51:20.145&apos;</div></pre></td></tr></table></figure></p>
<h1 id="L"><a href="#L" class="headerlink" title="-L"></a>-L</h1><p>æ‰“å°æœ€åä¸€æ¬¡é‡å¯ä¹‹å‰çš„æ—¥å¿—ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -L</div></pre></td></tr></table></figure></p>
<h1 id="B"><a href="#B" class="headerlink" title="-B"></a>-B</h1><p>è¾“å‡ºæ—¥å¿—çš„äºŒè¿›åˆ¶æ ¼å¼ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -B</div></pre></td></tr></table></figure></p>
<h1 id="S"><a href="#S" class="headerlink" title="-S"></a>-S</h1><p>è¾“å‡ºç»Ÿè®¡ä¿¡æ¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -S</div></pre></td></tr></table></figure></p>
<h1 id="P"><a href="#P" class="headerlink" title="-P"></a>-P</h1><p>è®¾ç½®é»‘ç™½åå•ã€‚å¯ä»¥å¯¹ <code>UID</code>ï¼Œ<code>PID</code>è®¾ç½®ï¼Œä¹Ÿå¯ä»¥<code>UID/PID</code>ä¸€èµ·è®¾ç½®ã€‚è®¾ç½®é»‘åå•ï¼Œå‰ç¼€<code>~</code>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -P &apos;&lt;list&gt;...&apos;</div></pre></td></tr></table></figure></p>
<p>ä¾‹1ï¼Œå¯¹<code>UID</code> 520881è®¾ç½®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat - P &apos;520881&apos;</div></pre></td></tr></table></figure></p>
<p>ä¾‹2ï¼Œå¯¹<code>PID</code> 520881 è®¾ç½®é»‘åå•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -P &apos;~/520881&apos;</div></pre></td></tr></table></figure></p>
<p>ä¾‹3ï¼Œå¯¹<code>UID</code> 520881ï¼Œå¯¹<code>PID</code> 78883ï¼Œå¯¹ <code>UID/PID</code> 52189/8883 è®¾ç½®é»‘åå•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -P `~520881 ~/78883 ~52189/8883&apos;</div></pre></td></tr></table></figure></p>
<h1 id="p"><a href="#p" class="headerlink" title="-p"></a>-p</h1><p>æŸ¥çœ‹é»‘ç™½åå•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb logcat -p</div></pre></td></tr></table></figure></p>
<h1 id="è¿›é˜¶"><a href="#è¿›é˜¶" class="headerlink" title="è¿›é˜¶"></a>è¿›é˜¶</h1><p>åˆ©ç”¨ shell é‡å®šå‘è¾“å‡ºæ—¥å¿—åˆ°æŒ‡å®šæ–‡ä»¶ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#è¾“å‡ºsth0:Våˆ°æ¡Œé¢1.logæ–‡ä»¶</div><div class="line">adb logcat -s sth0:V &gt;~/Desktop/1.log</div></pre></td></tr></table></figure></p>
<p>åˆ©ç”¨ <code>grep</code> è¿‡æ»¤æ—¥å¿—ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># è¿‡æ»¤æ—¥å¿—åŒ…å« verbose çš„æ—¥å¿—</div><div class="line">adb logcat | grep verbose </div><div class="line"># è¿‡æ»¤æ—¥å¿—åŒ…å« verbose çš„æ—¥å¿—ï¼Œå¿½ç•¥å¤§å°å†™</div><div class="line">adb logcat | grep -i verbose</div><div class="line"># è¿‡æ»¤ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼ sth. çš„æ—¥å¿—</div><div class="line">adb logcat | grep -e sth.</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Nexus 5, Android 6.0.1, API 23&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;Log&lt;/code&gt;ç±»ï¼Œç›¸ä¿¡å¼€å‘ Android çš„åŒå­¦éƒ½ä¸é™Œç”Ÿï¼Œæ­£å¦‚å…¶åï¼Œ&lt;code&gt;Log&lt;/code&gt;ç±»æä¾›äº†æ‰“å°æ—¥å¿—åŠŸèƒ½ï¼Œæ–¹
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="log" scheme="http://www.kennethyo.me/tags/log/"/>
    
      <category term="logcat" scheme="http://www.kennethyo.me/tags/logcat/"/>
    
      <category term="adb" scheme="http://www.kennethyo.me/tags/adb/"/>
    
  </entry>
  
  <entry>
    <title>Android çš„å¤åˆ¶å’Œç²˜è´´åŠŸèƒ½</title>
    <link href="http://www.kennethyo.me/2017/07/30/untitled-1501415073699/"/>
    <id>http://www.kennethyo.me/2017/07/30/untitled-1501415073699/</id>
    <published>2017-07-30T11:44:33.000Z</published>
    <updated>2017-07-30T11:51:39.000Z</updated>
    
    <content type="html"><![CDATA[<p>Android å¤åˆ¶å’Œç²˜è´´åŠŸèƒ½ï¼Œéœ€è¦è°ƒç”¨ç³»ç»ŸæœåŠ¡<code>ClipboardManager</code>æ¥å®ç°ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ClipboardManager mClipboardManager = (ClipboardManager) getSystemService(CLIPBOARD_SERVICE);</div></pre></td></tr></table></figure></p>
<p>å¤åˆ¶åŠŸèƒ½ï¼Œé¦–å…ˆè¦æ„é€ ä¸€ä¸ª<code>ClipData</code>å¯¹è±¡ï¼Œå¹¶ä¸”æŠŠè¦å¤åˆ¶çš„æ•°æ®å’Œ MIME type èµ‹å€¼ç»™<code>ClipData</code>ï¼Œç„¶ååœ¨æŠŠ<code>ClipData</code>ä¼ å…¥<code>mClipboardManager.setPrimaryClip()</code>æ–¹æ³•ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªå¤åˆ¶ã€‚</p>
<p>ç²˜è´´åŠŸèƒ½ï¼Œè°ƒç”¨<code>mClipboardManager.hasPrimaryClip()</code>æ¥åˆ¤æ–­ç²˜è´´æ¿æ˜¯å¦æœ‰æ•°æ®ï¼Œç„¶åé€šè¿‡<code>mClipboardManager.getPrimaryClipDescription().hasMimeType()</code>åˆ¤æ–­å½“å‰ç²˜è´´æ¿çš„æ•°æ® MIME typeæ˜¯ä¸æ˜¯APPæ”¯æŒçš„ï¼Œå¦‚æœæ˜¯APPæ”¯æŒçš„ï¼Œè·å–æ•°æ®<code>mClipboardManager.getPrimaryClip()</code>ã€‚</p>
<p>ä¸‹é¢å°±æ–‡æœ¬ï¼ŒURIï¼ŒIntentçš„å¤åˆ¶ç²˜è´´ï¼Œåˆ†åˆ«æä¾›ä¸€ä¸ªdemoã€‚</p>
<h1 id="æ–‡æœ¬"><a href="#æ–‡æœ¬" class="headerlink" title="æ–‡æœ¬"></a>æ–‡æœ¬</h1><p>å¤åˆ¶ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ˜¯æè¿°å¤åˆ¶çš„å†…å®¹ï¼Œä¹Ÿå¯ä»¥å’Œå†…å®¹ä¸€æ ·ã€‚</span></div><div class="line">ClipData clipData = ClipData.newPlainText(<span class="string">"copy from demo"</span>, mEtCopy.getText());</div><div class="line">mClipboardManager.setPrimaryClip(clipData);</div></pre></td></tr></table></figure></p>
<p>ç²˜è´´ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ç²˜è´´æ¿æœ‰æ•°æ®ï¼Œå¹¶ä¸”æ˜¯æ–‡æœ¬</span></div><div class="line"><span class="keyword">if</span> (mClipboardManager.hasPrimaryClip()</div><div class="line">        &amp;&amp; mClipboardManager.getPrimaryClipDescription().hasMimeType(ClipDescription.MIMETYPE_TEXT_PLAIN)) &#123;</div><div class="line">    ClipData.Item item = mClipboardManager.getPrimaryClip().getItemAt(<span class="number">0</span>);</div><div class="line">    CharSequence text = item.getText();</div><div class="line">    <span class="keyword">if</span> (text == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    mEtPaste.setText(text);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="URI-å¤åˆ¶"><a href="#URI-å¤åˆ¶" class="headerlink" title="URI å¤åˆ¶"></a>URI å¤åˆ¶</h1><p>å¤åˆ¶ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Uri uri = Uri.parse(uriStr);</div><div class="line">ClipData clipData = ClipData.newUri(getContentResolver(), <span class="string">"copy from demo"</span>, uri);</div><div class="line">mClipboardManager.setPrimaryClip(clipData);</div></pre></td></tr></table></figure></p>
<p>ç²˜è´´ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (mClipboardManager.hasPrimaryClip()</div><div class="line">        &amp;&amp; mClipboardManager.getPrimaryClipDescription().hasMimeType(ClipDescription.MIMETYPE_TEXT_URILIST)) &#123;</div><div class="line">    ClipData.Item item = mClipboardManager.getPrimaryClip().getItemAt(<span class="number">0</span>);</div><div class="line">    Uri uri = item.getUri();</div><div class="line">    <span class="keyword">if</span> (uri == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    mTvScheme.setText(uri.getScheme());</div><div class="line">    mTvUri.setText(uri.toString());</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="Intent-å¤åˆ¶"><a href="#Intent-å¤åˆ¶" class="headerlink" title="Intent å¤åˆ¶"></a>Intent å¤åˆ¶</h1><p>å¤åˆ¶ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Intent intent = <span class="keyword">new</span> Intent(<span class="keyword">this</span>, TextActivity.class);</div><div class="line">ClipData clipData = ClipData.newIntent(<span class="string">"copy from demo"</span>, intent);</div><div class="line">mClipboardManager.setPrimaryClip(clipData);</div></pre></td></tr></table></figure></p>
<p>ç²˜è´´ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (mClipboardManager.hasPrimaryClip()</div><div class="line">        &amp;&amp; mClipboardManager.getPrimaryClipDescription().hasMimeType(ClipDescription.MIMETYPE_TEXT_INTENT)) &#123;</div><div class="line">    ClipData.Item item = mClipboardManager.getPrimaryClip().getItemAt(<span class="number">0</span>);</div><div class="line">    Intent intent = item.getIntent();</div><div class="line">    <span class="keyword">if</span> (intent == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    startActivity(intent);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¤åˆ¶ç²˜è´´åŠŸèƒ½çš„APIå¹¶ä¸éš¾ç†è§£ï¼Œå¦‚æœæƒ³äº†è§£æ›´å¤šçš„åŠŸèƒ½ï¼Œå¯ä»¥çœ‹<a href="https://developer.android.google.cn/guide/topics/text/copy-paste.html" target="_blank" rel="external">å®˜æ–¹APIæŒ‡å—</a>ã€‚<br><a href="https://github.com/KennethYo/CopyAndPasteDemo" target="_blank" rel="external">Demoåœ°å€</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Android å¤åˆ¶å’Œç²˜è´´åŠŸèƒ½ï¼Œéœ€è¦è°ƒç”¨ç³»ç»ŸæœåŠ¡&lt;code&gt;ClipboardManager&lt;/code&gt;æ¥å®ç°ã€‚&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="copy" scheme="http://www.kennethyo.me/tags/copy/"/>
    
      <category term="paste" scheme="http://www.kennethyo.me/tags/paste/"/>
    
  </entry>
  
  <entry>
    <title>æŠŠç¼–è¯‘ä¿¡æ¯æ”¾åœ¨ Launch Icon ä¸Š</title>
    <link href="http://www.kennethyo.me/2017/04/05/untitled-1491391624769/"/>
    <id>http://www.kennethyo.me/2017/04/05/untitled-1491391624769/</id>
    <published>2017-04-05T11:27:04.000Z</published>
    <updated>2017-04-05T11:28:53.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ww3.sinaimg.cn/large/006tNc79ly1fec0ms62mnj3053052wew.jpg" alt="enter image description here|center"><br>é¦–å…ˆä¸Šä¸€å¼ æ•ˆæœå§ï¼è¿™æ˜¯æˆ‘ä»¬CIé›†æˆæµ‹è¯•åŒ…å iconã€‚åœ¨iconä¸Šåˆ†åˆ«æ˜¾ç¤ºäº†ç‰ˆæœ¬å·ã€build æ—¶é—´ã€git idã€‚</p>
<p>å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿçœ‹ä¸‹é¢ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦æœ‰ <code>ghostscript</code> å’Œ <code>imagemagick</code> ä¸¤ä¸ªç¯å¢ƒã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install ghostscript</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install imagemagick</div></pre></td></tr></table></figure>
<p>å…¶æ¬¡ï¼Œåœ¨ç¼–è¯‘ apk ä¹‹å‰ï¼Œæ‰§è¡Œä¸‹é¢çš„ shellï¼Œå°±ä¼šä¸»åŠ¨æ›¿æ¢ä¸ºæ–°iconã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env bash</div><div class="line">#å¼•å…¥ç¯å¢ƒå˜é‡</div><div class="line">export PATH=$PATH:/usr/local/bin</div><div class="line">#è¯»å–ç‰ˆæœ¬name</div><div class="line">source $WORKSPACE/gradle.properties</div><div class="line">shortVersion=$&#123;VERSION_NAME&#125;</div><div class="line">#ç¼–è¯‘æ—¶é—´</div><div class="line">createDate=`date +%m%d_%H:%M`</div><div class="line">#è·å–git id</div><div class="line">commit=`git rev-parse --short HEAD`</div><div class="line">bundleVersion=`git rev-list HEAD | wc -l | awk &apos;&#123;print $1&#125;&apos;`</div><div class="line">#è·å–iconè·¯å¾„æ•°ç»„</div><div class="line">resPath=&quot;$WORKSPACE/android-autoEasy/src/main/res&quot;</div><div class="line"></div><div class="line">mdpiPath=&quot;$&#123;resPath&#125;/drawable-mdpi/icon.png&quot;</div><div class="line">hdpiPath=&quot;$&#123;resPath&#125;/drawable-hdpi/icon.png&quot;</div><div class="line">xhdpiPath=&quot;$&#123;resPath&#125;/drawable-xhdpi/icon.png&quot;</div><div class="line">xxhdpiPath=&quot;$&#123;resPath&#125;/drawable-xxhdpi/icon.png&quot;</div><div class="line">iconPaths=($&#123;mdpiPath&#125; $&#123;hdpiPath&#125; $&#123;xhdpiPath&#125; $&#123;xxhdpiPath&#125;)</div><div class="line"></div><div class="line">echo</div><div class="line">echo &quot;*********************************************&quot;</div><div class="line">echo &quot;* $&#123;shortVersion&#125;_$&#123;bundleVersion&#125;_$&#123;commit&#125;&quot;</div><div class="line">echo &quot;*********************************************&quot;</div><div class="line">echo</div><div class="line">#æŠŠä¿¡æ¯å†™åˆ°iconä¸Š</div><div class="line">function processIcon() &#123;</div><div class="line">    pngPath=$1</div><div class="line"></div><div class="line">    echo</div><div class="line">    echo &quot;*********************************************&quot;</div><div class="line">    echo &quot;* start ---&gt; $&#123;pngPath&#125;&quot;</div><div class="line">    echo &quot;*********************************************&quot;</div><div class="line">    echo</div><div class="line"></div><div class="line">    echo &quot;from -&gt; $&#123;pngPath&#125;&quot;</div><div class="line"></div><div class="line">    if [[ ! -f $&#123;pngPath&#125; ]]; then</div><div class="line">    echo &quot;can&apos;t find $&#123;pngPath&#125; &quot;</div><div class="line">    return;</div><div class="line">    fi</div><div class="line"></div><div class="line">    target_path=$&#123;pngPath&#125;</div><div class="line"></div><div class="line">    echo &quot;to -&gt; $&#123;target_path&#125;&quot;</div><div class="line"></div><div class="line">    width=`identify -format %w $&#123;pngPath&#125;`</div><div class="line">    echo &quot;width = $width&quot;</div><div class="line"></div><div class="line">    string=$&quot;\n&quot;</div><div class="line">    `echo convert -background &apos;#0008&apos; -fill white -gravity center -size $&#123;width&#125;x$&#123;width&#125; \</div><div class="line">    caption:&quot;$&#123;shortVersion&#125;$&#123;string&#125;$&#123;createDate&#125;$&#123;string&#125;$&#123;commit&#125;&quot; \</div><div class="line">    $&#123;pngPath&#125; +swap -gravity south -composite $&#123;target_path&#125;`</div><div class="line"></div><div class="line">    echo &quot;name = $&#123;shortVersion&#125;$&#123;string&#125;$&#123;createDate&#125;$&#123;string&#125;$&#123;commit&#125;&quot;</div><div class="line"></div><div class="line">    echo</div><div class="line">    echo &quot;*********************************************&quot;</div><div class="line">    echo &quot;* end &lt;--- $&#123;pngPath&#125;&quot;</div><div class="line">    echo &quot;*********************************************&quot;</div><div class="line">    echo</div><div class="line">&#125;</div><div class="line"></div><div class="line">#åˆ¤æ–­æ˜¯å¦å·²ç»å®‰è£…äº†å¿…é¡»å·¥å…· imagemagick ghostscript</div><div class="line">echo `brew ls` |grep -q &quot;imagemagick&quot;</div><div class="line">if [ $? -eq 0 ]; then</div><div class="line">    echo &quot;imagemagick installed &quot;</div><div class="line"></div><div class="line">    echo `brew ls` |grep -q &quot;ghostscript&quot;</div><div class="line">    if [ $? -eq 0 ]; then</div><div class="line">        echo &quot;ghostscript installed &quot;</div><div class="line"></div><div class="line">        for paths in $&#123;iconPaths[@]&#125;</div><div class="line">        do</div><div class="line">            processIcon $&#123;paths&#125;</div><div class="line">        done</div><div class="line"></div><div class="line">    fi</div><div class="line">fi</div><div class="line">echo</div><div class="line">echo &quot;*********************************************&quot;</div><div class="line">echo &quot;* run script end&quot;</div><div class="line">echo &quot;*********************************************&quot;</div><div class="line">echo</div></pre></td></tr></table></figure></p>
<p>æœ€åï¼Œå°±æ˜¯ç¼–è¯‘ apk å•¦ï¼</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ww3.sinaimg.cn/large/006tNc79ly1fec0ms62mnj3053052wew.jpg&quot; alt=&quot;enter image description here|center&quot;&gt;&lt;br&gt;é¦–å…ˆä¸Šä¸€å¼ æ•ˆæœå§ï¼è¿™æ˜¯æˆ‘ä»¬C
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Jenkins" scheme="http://www.kennethyo.me/tags/Jenkins/"/>
    
  </entry>
  
  <entry>
    <title>Git-flow å­¦ä¹ æ€»ç»“</title>
    <link href="http://www.kennethyo.me/2017/03/06/untitled-1488794629968/"/>
    <id>http://www.kennethyo.me/2017/03/06/untitled-1488794629968/</id>
    <published>2017-03-06T10:03:49.000Z</published>
    <updated>2017-03-06T10:37:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>git ä½œä¸ºç°åœ¨æœ€ä¸ºä¸»æµçš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œä¼˜ç‚¹æœ‰å¾ˆå¤šï¼Œå…¶ä¸­æœ€ä¸ºæ˜¾è‘—çš„ä¸€ç‚¹å°±æ˜¯åˆ†æ”¯ç®¡ç†ã€‚</p>
<p>ä½œä¸ºä¸€æ¬¾ä¼˜ç§€çš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œæˆ‘åœ¨æ—¥å¸¸å¼€å‘ä¸­ä¹Ÿåœ¨ä½¿ç”¨ï¼Œå›ºå®šåˆ†æ”¯æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯ <code>master</code> å’Œ <code>develop</code> ï¼Œæ—¥å¸¸å¼€å‘å’Œæµ‹è¯•éƒ½æ˜¯é’ˆå¯¹ <code>develop</code>è¿›è¡Œï¼Œè¿™é€ æˆä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œæ¯å½“ä¸Šçº¿ç‰ˆæœ¬å‘ç°bugçš„æ—¶å€™ï¼Œ<code>develop</code> åˆ†æ”¯å·²ç»æœ‰ä¸‹ä¸ªç‰ˆæœ¬æ­£åœ¨å¼€å‘çš„ä»£ç ï¼Œä» tag åˆ›å»ºå‡ºæ¥çš„åˆ†æ”¯åˆå¹¶åˆ°<br><code>master</code> åï¼Œéš¾ä»¥åˆå¹¶åˆ° <code>develop</code> ã€‚</p>
<p>åŸºäºä¸Šé¢çš„é—®é¢˜ï¼Œä¸Šç½‘æœç´¢äº† git çš„å·¥ä½œæµï¼Œå…¶ä¸­è®²çš„æœ€å¤šçš„å°±æ˜¯ <code>git flow</code> ï¼Œä¸‹é¢å°±å°† <code>git flow</code> çš„å­¦ä¹ ç»“æœæ€»ç»“å¦‚ä¸‹ã€‚</p>
<h1 id="å‘å›¾é•‡æ¥¼"><a href="#å‘å›¾é•‡æ¥¼" class="headerlink" title="å‘å›¾é•‡æ¥¼"></a>å‘å›¾é•‡æ¥¼</h1><p><img src="https://ww4.sinaimg.cn/large/006tKfTcly1fdd9shg2uoj30yg1cpn9p.jpg" alt="enter image description here|center"></p>
<h1 id="Branch"><a href="#Branch" class="headerlink" title="Branch"></a>Branch</h1><p>ä¸»åˆ†æ”¯ï¼š<br><code>master</code>  å‘å¸ƒåˆ°çº¿ä¸Šçš„ä»£ç åº”è¯¥å’Œè¿™ä¸ªåˆ†æ”¯ä¸€è‡´ã€‚<br><code>develop</code> æ—¥å¸¸å¼€å‘åˆ†æ”¯ï¼Œå…¶ä»–åˆ†æ”¯åŸºæœ¬å›´ç»•è¿™ä¸ªåˆ†æ”¯ã€‚</p>
<p>ä¸´æ—¶æ€§åˆ†æ”¯ï¼š<br><code>feature/*</code> æ–°åŠŸèƒ½ç ”å‘åˆ†æ”¯ï¼Œä» <code>develop</code> åˆ›å»ºï¼Œç ”å‘å®Œæˆï¼Œåˆå¹¶åˆ° <code>develop</code>ã€‚<br><code>release/*</code> é¢„å‘å¸ƒåˆ†æ”¯ï¼Œä» <code>develop</code> åˆ›å»ºï¼Œè¿›è¡Œæµ‹è¯•ï¼Œå¹¶ä¿®å¤ bugsã€‚æœ€ç»ˆä¼šåˆå¹¶åˆ° <code>develop</code> å’Œ <code>master</code>åˆ†æ”¯ã€‚<br><code>hotfix/*</code>  ç´§æ€¥ä¿®å¤åˆ†æ”¯ï¼Œä» <code>master</code> åˆ›å»ºï¼Œæœ€ç»ˆä¼šåˆå¹¶åˆ° <code>develop</code> å’Œ <code>master</code>åˆ†æ”¯ã€‚</p>
<h1 id="Tag"><a href="#Tag" class="headerlink" title="Tag"></a>Tag</h1><p>tag æ°¸è¿œåªåœ¨ <code>master</code> åˆ†æ”¯åˆ›å»ºã€‚</p>
<p><code>release/*</code> åˆ†æ”¯åˆå¹¶åˆ° <code>master</code> ä¹‹åï¼Œæ¨é€ <code>master</code> åˆ°è¿œç«¯ï¼Œç„¶ååˆ›å»º <code>tag</code> , æ¨é€ <code>tag</code>åˆ°è¿œç«¯ã€‚<br><code>hotfix/*</code> åˆ†æ”¯åˆå¹¶åˆ° <code>master</code> ä¹‹åï¼Œæ¨é€ <code>master</code> åˆ°è¿œç«¯ï¼Œç„¶ååˆ›å»º <code>tag</code> , æ¨é€ <code>tag</code>åˆ°è¿œç«¯ã€‚</p>
<h1 id="æ“ä½œæµ"><a href="#æ“ä½œæµ" class="headerlink" title="æ“ä½œæµ"></a>æ“ä½œæµ</h1><p>æˆ‘ä»¬æ ¹æ®ä¸Šé¢çš„ç†è®ºï¼Œè¿›è¡Œä¸€æ¬¡å®Œæ•´æ“ä½œã€‚</p>
<h2 id="åˆ›å»º-develop-åˆ†æ”¯"><a href="#åˆ›å»º-develop-åˆ†æ”¯" class="headerlink" title="åˆ›å»º develop åˆ†æ”¯"></a>åˆ›å»º develop åˆ†æ”¯</h2><p>æ–°ä»“åº“é»˜è®¤æ˜¯ <code>master</code> åˆ†æ”¯ï¼Œ<code>master</code> åˆ†æ”¯åªä½œä¸ºå‘å¸ƒç‰ˆæœ¬ï¼Œæ—¥å¸¸å¼€å‘éƒ½è¦åŸºäºå¼€å‘åˆ†æ”¯ <code>develop</code>ã€‚ä» <code>master</code> åˆ†æ”¯åˆ›å»º <code>develop</code> åˆ†æ”¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git checkout -b develop master</div></pre></td></tr></table></figure></p>
<p>æ¨é€ <code>develop</code>åˆ†æ”¯ï¼Œåˆ°è¿œç«¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git push origin develop</div></pre></td></tr></table></figure></p>
<h2 id="v0-1-0-å¼€å§‹å¼€å‘"><a href="#v0-1-0-å¼€å§‹å¼€å‘" class="headerlink" title="v0.1.0 å¼€å§‹å¼€å‘"></a>v0.1.0 å¼€å§‹å¼€å‘</h2><p>ç°åœ¨æ¥å¼€å‘ç¬¬ä¸€ä¸ªç‰ˆæœ¬ <code>v0.1.0</code>ï¼Œé¦–å…ˆä» <code>develop</code> åˆ›å»ºåˆ†æ”¯ <code>feature/v0.1.0</code>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git checkout -b feature/v0.1.0 develop</div></pre></td></tr></table></figure></p>
<p>æ¨é€åˆ°è¿œç«¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git push origin feature/v0.1.0</div></pre></td></tr></table></figure></p>
<p>å„ç§ <code>v0.1.0</code>ç‰ˆæœ¬åŠŸèƒ½ä»£ç çš„æäº¤â€¦<br>â€¦â€¦.</p>
<h2 id="v0-1-0-å®Œæˆå¼€å‘"><a href="#v0-1-0-å®Œæˆå¼€å‘" class="headerlink" title="v0.1.0 å®Œæˆå¼€å‘"></a>v0.1.0 å®Œæˆå¼€å‘</h2><p>å¼€å‘å®Œæˆåï¼Œå°† <code>feature/v0.1.0</code> åˆå¹¶åˆ° <code>develop</code>  åˆ†æ”¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git checkout develop</div><div class="line">git merge --no-ff feature/v0.1.0</div></pre></td></tr></table></figure></p>
<p><code>--no-ff</code> å‚æ•°çš„æ„æ€æ˜¯ä¸è¿›è¡Œå¿«é€Ÿåˆå¹¶ï¼Œ<code>merge</code>å‘½ä»¤é»˜è®¤ä¼šè¿›è¡Œâ€œå¿«è¿›å¼åˆå¹¶ï¼ˆfast-farward mergeï¼‰â€ï¼Œç›´æ¥å°† <code>develop</code> æŒ‡å‘ <code>feature/v0.1.0</code>ï¼Œè¿™é‡Œä½¿ç”¨<a href="http://www.ruanyifeng.com/" target="_blank" rel="external">é˜®ä¸€å³°</a>åœ¨<a href="http://www.ruanyifeng.com/blog/2012/07/git.html" target="_blank" rel="external">Gitåˆ†æ”¯ç®¡ç†ç­–ç•¥</a>ä¸­çš„å›¾ç‰‡ã€‚<br><img src="https://ww2.sinaimg.cn/large/006tKfTcly1fdcxolq5hvj30dw0gu759.jpg" alt="Alt text|center|300x0"><br>åŠ ä¸Š<code>--no-ff</code> å‚æ•°åï¼Œåˆå¹¶çš„æ—¶å€™ä¼šç”Ÿæˆä¸€ä¸ªæ–°èŠ‚ç‚¹ã€‚å¯ä»¥ä¿è¯ç‰ˆæœ¬æ¼”è¿›çš„æ¸…æ™°ã€‚<br><img src="https://ww4.sinaimg.cn/large/006tKfTcly1fdcxrpvc6lj306y0k63yz.jpg" alt="enter image description here|center|0x300"><br>æ¨é€åˆ°è¿œç«¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git push origin develop</div></pre></td></tr></table></figure></p>
<p>åˆ é™¤ <code>feature/v0.1.0</code>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git branch -b feature/v0.1.0</div></pre></td></tr></table></figure></p>
<h2 id="é¢„å‘å¸ƒ"><a href="#é¢„å‘å¸ƒ" class="headerlink" title="é¢„å‘å¸ƒ"></a>é¢„å‘å¸ƒ</h2><p>å¼€å‘å®Œæˆä¹‹åï¼Œè¦è¿›è¡Œæµ‹è¯•ï¼Œfix bugsã€‚åˆ›å»ºé¢„å‘å¸ƒåˆ†æ”¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git checkout -b release/v0.1.0 develop</div><div class="line">git push origin release/v0.1.0</div></pre></td></tr></table></figure></p>
<p>å„ç§æµ‹è¯•ï¼Œå„ç§è¹‚èºï¼Œå„ç§ fix bugs â€¦â€¦</p>
<h2 id="å‘å¸ƒç‰ˆæœ¬"><a href="#å‘å¸ƒç‰ˆæœ¬" class="headerlink" title="å‘å¸ƒç‰ˆæœ¬"></a>å‘å¸ƒç‰ˆæœ¬</h2><p>ç»è¿‡æµ‹è¯•å’Œä¿®å¤ï¼Œç»ˆäºè¦ä¸Šçº¿äº†ï¼Œåˆå¹¶ <code>release/v0.1.0</code> åˆ° <code>master</code> å’Œ <code>develop</code>ï¼š<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#åˆå¹¶åˆ°master</span></div><div class="line">git checkout master</div><div class="line">git merge --no-ff release/v0.<span class="number">1.0</span></div><div class="line">git push origin master</div><div class="line"><span class="comment">#æ‰“ä¸Štag</span></div><div class="line">git tag -a v0.<span class="number">1.0</span> -m <span class="string">"publish v0.1.0"</span></div><div class="line">git push origin v0.<span class="number">1.0</span></div><div class="line"><span class="comment">#åˆå¹¶åˆ°develop</span></div><div class="line">git checkout develop</div><div class="line">git merge --no-ff release/v0.<span class="number">1.0</span></div><div class="line">git push origin develop</div><div class="line"><span class="comment">#åˆ é™¤ release/v0.1.0</span></div><div class="line">git branch -d release/v0.<span class="number">1.0</span></div></pre></td></tr></table></figure></p>
<h2 id="å‡º-bug-äº†"><a href="#å‡º-bug-äº†" class="headerlink" title="å‡º bug äº†"></a>å‡º bug äº†</h2><p>ä»£ç ä¸Šçº¿ä¹‹åï¼Œå‡º bug æ˜¯è°éƒ½ä¸æ„¿æ„çœ‹åˆ°çš„ï¼Œä½†æ˜¯éš¾å…ä¼šå‡ºçš„å˜›ã€‚ä¸‹é¢æˆ‘ä»¬è¿›è¡Œä¿®å¤ï¼Œä¸‹é¢æˆ‘ä»¬ä» <code>master</code> åˆ›å»º <code>hotfix/v0.1.0</code> åˆ†æ”¯ï¼Œè¿›è¡Œä¿®å¤å·¥ä½œï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git checkout -b hotfix/v0.1.0 master</div><div class="line">git push origin hotfix/v0.1.0</div></pre></td></tr></table></figure></p>
<p>ä¿®å¤å®Œæˆä¹‹ååˆå¹¶åˆ° <code>master</code> å’Œ <code>develop</code> åˆ†æ”¯ï¼š<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#åˆå¹¶åˆ°master</span></div><div class="line">git checkout master</div><div class="line">git merge --no-ff hotfix/v0.<span class="number">1.0</span></div><div class="line">git push origin master</div><div class="line"><span class="comment">#æ‰“ä¸Štag</span></div><div class="line">git tag -a v0.<span class="number">1.1</span> -m <span class="string">"publish v0.1.1"</span></div><div class="line">git push origin v0.<span class="number">1.1</span></div><div class="line"><span class="comment">#åˆå¹¶åˆ°develop</span></div><div class="line">git checkout develop</div><div class="line">git merge --no-ff hotfix/v0.<span class="number">1.0</span></div><div class="line">git push origin develop</div><div class="line"><span class="comment">#åˆ é™¤ hotfix/v0.1.0</span></div><div class="line">git branch -d hotfix/v0.<span class="number">1.0</span></div></pre></td></tr></table></figure></p>
<h1 id="åˆ©ä¸å¼Š"><a href="#åˆ©ä¸å¼Š" class="headerlink" title="åˆ©ä¸å¼Š"></a>åˆ©ä¸å¼Š</h1><p>å„ä¸ªåˆ†æ”¯ï¼Œå„å¸å…¶èŒï¼Œæ¸…æ™°å¯æ§ã€‚</p>
<p>ç»å¸¸åˆ‡æ¢åˆ†æ”¯ï¼Œå®¹æ˜“è¿›è¡Œè¯¯æ“ä½œï¼ˆåœ¨ä¸å¯¹åº”çš„åˆ†æ”¯ä¸Šè¿›è¡Œæäº¤ï¼Œç»†å¿ƒèƒ½å¤Ÿè§£å†³ï¼‰ã€‚</p>
<h1 id="Git-flow-å·¥å…·"><a href="#Git-flow-å·¥å…·" class="headerlink" title="Git-flow å·¥å…·"></a>Git-flow å·¥å…·</h1><p>ç”± <code>git flow</code> æå‡ºè€… <a href="http://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="external">Vincent Driessen</a>å¼€å‘çš„ <code>git flow</code>å·¥å…·ã€‚</p>
<h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><h3 id="Homebrew"><a href="#Homebrew" class="headerlink" title="Homebrew"></a><a href="http://github.com/mxcl/homebrew" target="_blank" rel="external">Homebrew</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install git-flow</div></pre></td></tr></table></figure>
<h3 id="MacPorts"><a href="#MacPorts" class="headerlink" title="MacPorts"></a><a href="https://www.macports.org/" target="_blank" rel="external">MacPorts</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">port install git-flow</div></pre></td></tr></table></figure>
<h3 id="wget"><a href="#wget" class="headerlink" title="wget"></a><a href="https://zh.wikipedia.org/wiki/Wget" target="_blank" rel="external">wget</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget --no-check-certificate -q -O - https://github.com/nvie/gitflow/raw/develop/contrib/gitflow-installer.sh | sudo bash</div></pre></td></tr></table></figure>
<h3 id="cURL"><a href="#cURL" class="headerlink" title="cURL"></a><a href="https://zh.wikipedia.org/zh-cn/CURL" target="_blank" rel="external">cURL</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">curl -L -O https://raw.github.com/nvie/gitflow/develop/contrib/gitflow-installer.sh</div><div class="line">sudo bash gitflow-installer.sh</div></pre></td></tr></table></figure>
<h2 id="æ“ä½œæµ-1"><a href="#æ“ä½œæµ-1" class="headerlink" title="æ“ä½œæµ"></a>æ“ä½œæµ</h2><p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆå§‹åŒ– <code>git flow</code>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git flow init</div></pre></td></tr></table></figure></p>
<p>ä¼šå‡ºç°å¦‚ä¸‹çš„ä¸€ç³»åˆ—é—®é¢˜ï¼Œéƒ½æ˜¯è®¾ç½®å„ä¸ªåˆ†æ”¯å‰ç¼€ï¼Œç›´æ¥å›è½¦é»˜è®¤å€¼ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Which branch should be used for bringing forth production releases?</div><div class="line">   - master</div><div class="line">Branch name for production releases: [master]</div><div class="line">Branch name for &quot;next release&quot; development: [develop]</div><div class="line"></div><div class="line">How to name your supporting branch prefixes?</div><div class="line">Feature branches? [feature/]</div><div class="line">Release branches? [release/]</div><div class="line">Hotfix branches? [hotfix/]</div><div class="line">Support branches? [support/]</div><div class="line">Version tag prefix? []</div></pre></td></tr></table></figure></p>
<p>åˆå§‹åŒ–å®Œæˆä¹‹åï¼Œå½“å‰åˆ†æ”¯ä¼šå˜æˆ <code>develop</code> åˆ†æ”¯ã€‚</p>
<h3 id="v0-1-0-å¼€å§‹å¼€å‘-1"><a href="#v0-1-0-å¼€å§‹å¼€å‘-1" class="headerlink" title="v0.1.0 å¼€å§‹å¼€å‘"></a>v0.1.0 å¼€å§‹å¼€å‘</h3><p>è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œä¼šä» <code>develop</code> åˆ†æ”¯åˆ›å»ºå‡º <code>feature/v0.1.0</code> åˆ†æ”¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git flow feature start v0.1.0</div></pre></td></tr></table></figure></p>
<p>æ¨é€åˆ†æ”¯åˆ°è¿œç«¯ï¼š<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git flow feature publish v0.<span class="number">1.0</span></div><div class="line"><span class="comment">#æˆ–è€…</span></div><div class="line">git push origin feature/v0.<span class="number">1.0</span></div></pre></td></tr></table></figure></p>
<h3 id="v0-1-0-å®Œæˆå¼€å‘-1"><a href="#v0-1-0-å®Œæˆå¼€å‘-1" class="headerlink" title="v0.1.0 å®Œæˆå¼€å‘"></a>v0.1.0 å®Œæˆå¼€å‘</h3><p>è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œä¼šæŠŠ <code>feature/v0.1.0</code> åˆ†æ”¯åˆå¹¶åˆ° <code>develop</code> åˆ†æ”¯ï¼Œå¹¶åˆ é™¤ <code>feature/v0.1.0</code>åˆ†æ”¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git flow feature finish v0.1.0</div></pre></td></tr></table></figure></p>
<h3 id="é¢„å‘å¸ƒ-1"><a href="#é¢„å‘å¸ƒ-1" class="headerlink" title="é¢„å‘å¸ƒ"></a>é¢„å‘å¸ƒ</h3><p>è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œä¼šä» <code>develop</code> åˆ†æ”¯åˆ›å»ºå‡º <code>release/v0.1.0</code> åˆ†æ”¯ï¼š<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">git flow release start v0.<span class="number">1.0</span></div><div class="line"><span class="comment">#æ¨é€åˆ°è¿œç«¯</span></div><div class="line">git flow release publish v0.<span class="number">1.0</span></div><div class="line"><span class="comment">#æˆ–è€…</span></div><div class="line">git push origin release/v0.<span class="number">1.0</span></div></pre></td></tr></table></figure></p>
<h3 id="å‘å¸ƒç‰ˆæœ¬-1"><a href="#å‘å¸ƒç‰ˆæœ¬-1" class="headerlink" title="å‘å¸ƒç‰ˆæœ¬"></a>å‘å¸ƒç‰ˆæœ¬</h3><p>è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œä¼šæŠŠ <code>release/v0.1.0</code> åˆ†æ”¯åˆå¹¶åˆ° <code>develop</code> åˆ†æ”¯å’Œ <code>master</code> åˆ†æ”¯ï¼Œå¹¶åˆ é™¤ <code>release/v0.1.0</code>åˆ†æ”¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git flow release finish v0.1.0</div></pre></td></tr></table></figure></p>
<h3 id="å‡º-bug-äº†-1"><a href="#å‡º-bug-äº†-1" class="headerlink" title="å‡º bug äº†"></a>å‡º bug äº†</h3><p>è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œä¼šä» <code>master</code> åˆ›å»º <code>hotfix/v0.1.1</code> åˆ†æ”¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git flow hotfix start v0.1.1</div></pre></td></tr></table></figure></p>
<p>ä¿®å¤å®Œæˆï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œä¼šåˆåˆ†åˆ«åˆå¹¶åˆ° <code>master</code> å’Œ <code>develop</code>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git flow hotfix finish v0.1.1</div></pre></td></tr></table></figure></p>
<h1 id="æŠ„è¢­æ–‡çŒ®"><a href="#æŠ„è¢­æ–‡çŒ®" class="headerlink" title="æŠ„è¢­æ–‡çŒ®"></a>æŠ„è¢­æ–‡çŒ®</h1><p>1ï¼Œ<a href="http://www.ruanyifeng.com/blog/2015/12/git-workflow.html" target="_blank" rel="external">Git å·¥ä½œæµç¨‹</a><br>2ï¼Œ<a href="http://www.ruanyifeng.com/blog/2012/07/git.html" target="_blank" rel="external">Gitåˆ†æ”¯ç®¡ç†ç­–ç•¥</a><br>3ï¼Œ<a href="http://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="external">A successful Git branching model</a><br>4ï¼Œ<a href="https://github.com/nvie/gitflow" target="_blank" rel="external">gitflow</a><br>5ï¼Œ<a href="http://stormzhang.com/git/2014/01/29/git-flow/" target="_blank" rel="external">ä½¿ç”¨GIT FLOWç®¡ç†å¼€å‘æµç¨‹</a><br>6ï¼Œ<a href="https://www.git-tower.com/learn/git/ebook/cn/command-line/advanced-topics/git-flow" target="_blank" rel="external">git-flow çš„å·¥ä½œæµç¨‹</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;git ä½œä¸ºç°åœ¨æœ€ä¸ºä¸»æµçš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œä¼˜ç‚¹æœ‰å¾ˆå¤šï¼Œå…¶ä¸­æœ€ä¸ºæ˜¾è‘—çš„ä¸€ç‚¹å°±æ˜¯åˆ†æ”¯ç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¸€æ¬¾ä¼˜ç§€çš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œæˆ‘åœ¨æ—¥å¸¸å¼€å‘ä¸­ä¹Ÿåœ¨ä½¿ç”¨ï¼Œå›ºå®šåˆ†æ”¯æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯ &lt;code&gt;master&lt;/code&gt; å’Œ &lt;code&gt;develop&lt;/code&gt; ï¼Œæ—¥å¸¸å¼€å‘å’Œ
    
    </summary>
    
      <category term="Git" scheme="http://www.kennethyo.me/categories/Git/"/>
    
    
      <category term="git" scheme="http://www.kennethyo.me/tags/git/"/>
    
      <category term="git-flow" scheme="http://www.kennethyo.me/tags/git-flow/"/>
    
  </entry>
  
  <entry>
    <title>Travis å’Œ CircleCI é…ç½®æ–‡ä»¶</title>
    <link href="http://www.kennethyo.me/2016/11/08/untitled-1478588050831/"/>
    <id>http://www.kennethyo.me/2016/11/08/untitled-1478588050831/</id>
    <published>2016-11-08T07:09:56.000Z</published>
    <updated>2016-11-08T07:11:49.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä»¥ä¸‹éƒ½ç”¨ <a href="https://github.com/KennethYo/BrakeLight" target="_blank" rel="external"><code>BrakeLight</code></a> é¡¹ç›®ä¸¾ä¾‹ã€‚</p>
</blockquote>
<p>#<a href="https://circleci.com/" target="_blank" rel="external">Circleci</a><br>åœ¨é¡¹ç›®ç›®å½•ä¸­åˆ›å»º <code>circle.yml</code> æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">machine:</span></div><div class="line">  <span class="symbol">java:</span></div><div class="line">      <span class="symbol">version:</span> oraclejdk8</div><div class="line"></div><div class="line"><span class="symbol">dependencies:</span></div><div class="line">  <span class="symbol">pre:</span></div><div class="line">    - <span class="keyword">if</span> [ ! -d <span class="string">"/usr/local/android-sdk-linux/platforms/android-24"</span> ]; <span class="keyword">then</span> echo y <span class="params">| android update sdk --no-ui --all --filter "android-24"; fi</span></div><div class="line"><span class="params">    - <span class="keyword">if</span> [ ! -d "/usr/local/android-sdk-linux/build-tools/24.0.2" ]; <span class="keyword">then</span> echo y |</span> android update sdk --no-ui --all --filter <span class="string">"build-tools-24.0.2"</span>; fi</div><div class="line">    - <span class="keyword">if</span> [ ! -d <span class="string">"/usr/local/android_sdk/extras/android/m2repository/com/android/support/support-core-utils/24.2.1"</span> ]; <span class="keyword">then</span> echo y <span class="params">| android update sdk --no-ui --all --filter "extra-android-m2repository"; fi</span></div><div class="line"><span class="params"></span></div><div class="line"><span class="params">test:</span></div><div class="line"><span class="params">  override:</span></div><div class="line"><span class="params">    - ./gradlew assembleRelease</span></div></pre></td></tr></table></figure></p>
<p>#<a href="https://travis-ci.org" target="_blank" rel="external">Travis</a><br>åœ¨é¡¹ç›®ç›®å½•ä¸­åˆ›å»º <code>.travis.yml</code> æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">sudo:</span> <span class="literal">false</span></div><div class="line"></div><div class="line"><span class="symbol">language:</span> android</div><div class="line"></div><div class="line"><span class="symbol">jdk:</span></div><div class="line">  - oraclejdk8</div><div class="line"></div><div class="line"><span class="symbol">android:</span></div><div class="line">  <span class="symbol">components:</span></div><div class="line">    - platform-tools</div><div class="line">    - tools</div><div class="line">    - build-tools-<span class="number">24.0</span>.<span class="number">2</span></div><div class="line">    - android-<span class="number">24</span></div><div class="line">    - extra-android-m2repository</div><div class="line">    - extra-android-support</div></pre></td></tr></table></figure></p>
<p>#å…¶å®è¿˜æœ‰<a href="https://app.shippable.com" target="_blank" rel="external">Shippable</a><br>å›½å†…è®¿é—®é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼ŒAndroid æ”¯æŒçš„ä¸å¥½ï¼Œæ”¾å¼ƒäº†ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä»¥ä¸‹éƒ½ç”¨ &lt;a href=&quot;https://github.com/KennethYo/BrakeLight&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;code&gt;BrakeLight&lt;/code&gt;&lt;/a&gt; é¡¹ç›®ä¸¾ä¾‹ã€‚&lt;/p&gt;

    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="CI" scheme="http://www.kennethyo.me/tags/CI/"/>
    
  </entry>
  
  <entry>
    <title>è‡ªå»ºç§æœ‰ Maven ä»“åº“</title>
    <link href="http://www.kennethyo.me/2016/09/01/untitled-1472722428873/"/>
    <id>http://www.kennethyo.me/2016/09/01/untitled-1472722428873/</id>
    <published>2016-09-01T09:33:48.000Z</published>
    <updated>2017-03-06T11:05:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>é¡¹ç›®ç»„ä»2015å¹´ä¸ŠåŠå¹´å…¨é¢åˆ‡æ¢åˆ° AndroidStudio è¿›è¡Œå¼€å‘ï¼Œéšç€è¿™1å¹´å¤šä¸šåŠ¡é€»è¾‘å’Œä»£ç é€»è¾‘çš„å¢é•¿ï¼Œå¯¼è‡´é¡¹ç›®  LibraryModule ç”±æœ€åˆçš„3ä¸ªå¢é•¿åˆ°å¦‚ä»Šçš„8ä¸ªã€‚</p>
<p>ä»£ç é‡çš„å¢åŠ å¿…ç„¶å¯¼è‡´ç¼–è¯‘çš„å˜æ…¢ï¼ŒAndroidStudio åœ¨ç¼–è¯‘é¡¹ç›®æ—¶ä¼šå…ˆç¼–è¯‘ LibraryModule ç”Ÿæˆ aar åŒ…ï¼Œä¹‹åè¿™äº› aar åŒ…ä¼šå’Œ APPModule è¿›è¡Œé›†æˆç¼–è¯‘ï¼Œæœ€ç»ˆç”Ÿæˆ APKã€‚è¿™ä¸ªç¼–è¯‘è¿‡ç¨‹ï¼Œç¬¬ä¸€æ¬¡åœ¨5.0åŠä»¥ä¸Šæ‰‹æœºå®‰è£…ï¼Œç»å¸¸ä¼šå‡ºç°6åˆ†é’Ÿä»¥ä¸Šçš„ç¼–è¯‘æ—¶é—´ï¼Œ5.0ä»¥ä¸‹æ‰‹æœºä¹Ÿæœ‰3åˆ†é’Ÿå·¦å³çš„ç¼–è¯‘æ—¶é—´ï¼Œè¿™äº›æ—¶é—´ä¸¥é‡å½±å“äº†å·¥ä½œæ•ˆç‡ï¼</p>
<p>è€ƒè™‘åˆ° LibraryModule æ˜¯é•¿æœŸä¸ä¼šä¿®æ”¹çš„ä»£ç ï¼Œå¦‚æœå‘å¸ƒæˆ aar åŠ å…¥åˆ°é¡¹ç›®é‡Œï¼Œå°±å¯ä»¥èŠ‚çœä¸‹æ¯æ¬¡ Module ç¼–è¯‘çš„æ—¶é—´ã€‚</p>
<p>å¦‚æœèƒ½å¤Ÿåƒ compile ç¬¬ä¸‰æ–¹ Library é‚£æ ·å¼•ç”¨æˆ‘ä»¬çš„ Library ï¼Œå²‚ä¸æ˜¯åˆé™ä½ Module çš„è€¦åˆï¼Œåˆå•ç‹¬å¯¹ Library å¢åŠ äº†ç‰ˆæœ¬æ§åˆ¶ã€‚ç¬¬ä¸‰æ–¹ Library  åŸºæœ¬éƒ½æ˜¯æŠŠ aar å‘å¸ƒåˆ°ä¸­å¤® Maven å¯¹å¤–æä¾›å¼•ç”¨ï¼Œè€Œæˆ‘ä»¬çš„ Library ä½œä¸ºå…¬å¸çš„å•†ä¸šé¡¹ç›®ï¼Œæ˜¯ä¸å¯èƒ½å‘å¸ƒåˆ°ä¸­å¤® Maven å¯¹å¤–æä¾›å¼•ç”¨çš„ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬éœ€è¦æœ‰è‡ªå·±çš„ Maven æœåŠ¡ã€‚</p>
<p>ç§æœ‰ Maven è¿˜ä¼šäº§ç”Ÿå¦ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯ä»£ç†ä¸­å¤® Maven ä»“åº“ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ–°åŠ å…¥äº†ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œå¯¼è‡´æ¯ä¸ªäººçš„ IDE éƒ½éœ€è¦ä»ä¸­å¤® Maven pull åº“ï¼Œè€Œä¸­å›½ GFW çš„å­˜åœ¨ï¼Œå¯¼è‡´ä¸­å¤® Maven æå…¶ä¸ç¨³å®šï¼Œç»å¸¸ time out ï¼Œæœ‰äº†ä»£ç† Mavenï¼Œåªè¦ä»£ç† maven pull ä¸€æ¬¡åº“ï¼Œæ¯ä¸ªäººå°±ä¸å¿…ä»ä¸­å¤® Maven pullåº“äº†ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬æ˜¯ç”¨ Docker ä½œä¸ºå®¹å™¨ï¼Œåœ¨é‡Œé¢æ­å»ºçš„ Sonatype Nexus ç§æœ‰ Maven ä»“åº“ã€‚ä½¿ç”¨ Docker çš„å¥½å¤„æ˜¯å¯ä»¥æŠŠç¯å¢ƒç‹¬ç«‹å‡ºæ¥ä¸ä¼šå’ŒæœåŠ¡å™¨å…¶ä»–æœåŠ¡äº§ç”Ÿå†²çªï¼Œå¸è½½ä¹Ÿç®€å•ã€‚</p>
<h1 id="å®‰è£…-Docker-å¹¶è¿è¡Œ-Nexus"><a href="#å®‰è£…-Docker-å¹¶è¿è¡Œ-Nexus" class="headerlink" title="å®‰è£… Docker å¹¶è¿è¡Œ Nexus"></a>å®‰è£… Docker å¹¶è¿è¡Œ Nexus</h1><p>1ï¼Œä¸‹è½½ å¹¶å®‰è£… Dockerï¼Œ<a href="https://www.docker.com/products/docker#/mac" target="_blank" rel="external">ä¼ é€é—¨</a></p>
<p>2ï¼Œåœ¨ Terminal ä¸­è¾“å…¥<code>docker -v</code>ï¼Œå¦‚æœæ˜¾ç¤ºç‰ˆæœ¬å·ï¼Œè¯´æ˜å®‰è£…åç¯å¢ƒæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå¦‚ä¸‹æ˜¯æˆ‘æ˜¾ç¤ºçš„ç‰ˆæœ¬å·ï¼š<br><code>Docker version 1.12.0, build 8eab29e</code></p>
<p>3ï¼Œåœ¨ Terminal è¾“å…¥<code>docker pull sonatype/nexus</code>è¿›è¡Œä¸‹è½½ nexus é•œåƒã€‚<br>ä¸‹è½½è¿‡ç¨‹ä¸­ï¼Œä¼šæ˜¾ç¤ºä¸‹è½½è¿›åº¦ã€‚å¦‚æœæ¯”è¾ƒæ…¢æˆ–è€…è¶…æ—¶ï¼Œè¯·åœ¨ Docker é‡Œè®¾ç½® mirrorã€‚å¦‚ä¸‹å›¾ï¼Œæˆ‘é…ç½®äº†çµé›€åŠ é€Ÿå’Œé˜¿é‡Œäº‘åŠ é€Ÿã€‚</p>
<p><img src="http://ww1.sinaimg.cn/large/72f96cbajw1f7e4dnn8xcj20l40u60w6.jpg" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"><br>çµé›€åŠ é€Ÿï¼š<a href="http://houchaohann.m.alauda.cn" target="_blank" rel="external">http://houchaohann.m.alauda.cn</a><br>é˜¿é‡Œäº‘åŠ é€Ÿï¼š<a href="https://3wky8dz8.mirror.aliyuncs.com" target="_blank" rel="external">https://3wky8dz8.mirror.aliyuncs.com</a> </p>
<p>ä¸‹è½½æˆåŠŸåæ˜¾ç¤ºå¦‚ä¸‹å›¾ï¼š<br><img src="http://ww4.sinaimg.cn/large/72f96cbajw1f7e4gjbjvbj20g306kjs1.jpg" alt=""></p>
<p>4ï¼Œåœ¨ Terminal ä¸­è¾“å…¥<code>docker run -d -p 8081:8081 --name  yiche sonatype/nexus:oss</code>æ¥åˆ›å»ºä¸€ä¸ªåå« yiche çš„å®¹å™¨ï¼Œå ç”¨ç«¯å£8081ã€‚</p>
<p><img src="http://ww3.sinaimg.cn/large/72f96cbajw1f7e4kafrkcj20lw01bdg3.jpg" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>5ï¼Œåœ¨ Terminal ä¸­è¾“å…¥<code>docker ps -a</code>æŸ¥çœ‹å®¹å™¨</p>
<p><img src="http://ww1.sinaimg.cn/large/72f96cbajw1f7e4quvlv0j20q401sglu.jpg" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>6ï¼Œæµè§ˆå™¨é‡Œè¾“å…¥<a href="http://localhost:8081/" target="_blank" rel="external">http://localhost:8081/</a>ï¼Œå¦‚æœæ˜¾ç¤ºå¦‚ä¸‹ç•Œé¢ï¼Œè¯æ˜ Nexus æ­å»ºæˆåŠŸã€‚</p>
<p><img src="http://ww4.sinaimg.cn/large/72f96cbajw1f7e4x3tmhej21kw0zkk21.jpg" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>7ï¼Œä¸€äº›å¸¸ç”¨æŒ‡ä»¤ï¼š<br><code>docker start yiche</code>å¼€å§‹è¿è¡Œyiche å®¹å™¨<br><code>docker restart yiche</code>cè¿ é‡æ–°è¡Œyicheå®¹å™¨<br><code>docker stop yiche</code>åœæ­¢è¿è¡Œyicheå®¹å™¨<br><code>docker rm yiche</code>åˆ é™¤yicheå®¹å™¨</p>
<h1 id="Nexus-ä½¿ç”¨"><a href="#Nexus-ä½¿ç”¨" class="headerlink" title="Nexus ä½¿ç”¨"></a>Nexus ä½¿ç”¨</h1><p>ç‚¹å‡»å³ä¸Šè§’<code>login</code>ç™»å½•ï¼Œé»˜è®¤è´¦æˆ·<code>admin</code>ï¼Œé»˜è®¤å¯†ç <code>admin123</code> ã€‚</p>
<p>ç‚¹å‡»å·¦ä¾§æ ç›®çš„<code>Repositories</code>ï¼Œæ˜¾ç¤ºNexus é»˜è®¤å·²ç»æœ‰çš„ä»“åº“ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://ww1.sinaimg.cn/large/72f96cbajw1f7e5tldqexj21kw0zkwrs.jpg" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<h2 id="åˆ›å»ºä¸€ä¸ªç§æœ‰ä»“åº“"><a href="#åˆ›å»ºä¸€ä¸ªç§æœ‰ä»“åº“" class="headerlink" title="åˆ›å»ºä¸€ä¸ªç§æœ‰ä»“åº“"></a>åˆ›å»ºä¸€ä¸ªç§æœ‰ä»“åº“</h2><p>1ï¼Œç‚¹å‡»<code>add</code>ï¼Œé€‰æ‹©<code>Hosted Repository</code></p>
<p>2ï¼Œåœ¨ä¸‹æ–¹è¾“å…¥<code>Repository ID</code>å’Œ<code>Repository Name</code>ï¼Œè¿™é‡Œæˆ‘åˆ†åˆ«è¾“å…¥çš„æ˜¯<code>demo</code>å’Œ<code>Demo</code>ï¼Œè¿™é‡Œå¯ä»¥æ¢æˆä½ è‡ªå·±çš„ã€‚</p>
<p>3ï¼Œéƒ¨ç½²ç­–ç•¥<code>Deployment Policy</code>é€‰æ‹©ä¸º<code>Allow Redeploy</code>å…è®¸é‡æ–°éƒ¨ç½²ã€‚</p>
<p>4ï¼Œç‚¹å‡»<code>save</code>ä¿å­˜ï¼Œåœ¨ä¸Šæ–¹åˆ—è¡¨ä¸­å°±ä¼šæ˜¾ç¤ºå®Œæˆçš„ä»“åº“ä¿¡æ¯ï¼Œæœ€åä¸€åˆ—<code>Repository Path</code>å°±æ˜¯ä»“åº“çš„åœ°å€ã€‚</p>
<p>å¦‚ä¸‹å›¾ï¼š<br><img src="http://ww1.sinaimg.cn/large/72f96cbajw1f7e625xn92j21kw0zkdsb.jpg" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>æ³¨ï¼šå¦‚æœåœ¨<code>Repository Policy</code>é€‰æ‹©<code>snapshot</code>ï¼Œä»“åº“å°±æ˜¯å¿«ç…§ç‰ˆä»“åº“ã€‚</p>
<h2 id="ä»£ç†ä»“åº“"><a href="#ä»£ç†ä»“åº“" class="headerlink" title="ä»£ç†ä»“åº“"></a>ä»£ç†ä»“åº“</h2><p>è¿™é‡Œæˆ‘æ˜¯ä»£ç†çš„ jcenterï¼Œå› ä¸ºè¿™æ˜¯ Android  Studio çš„é»˜è®¤ä»“åº“ã€‚</p>
<p>1ï¼Œç‚¹å‡»<code>add</code>ï¼Œé€‰æ‹©<code>Proxy Repository</code></p>
<p>2ï¼Œåœ¨ä¸‹æ–¹è¾“å…¥<code>Repository ID</code>å’Œ<code>Repository Name</code>ï¼Œè¿™é‡Œæˆ‘åˆ†åˆ«è¾“å…¥çš„æ˜¯<code>jcenter</code>å’Œ<code>Jcenter</code>ï¼Œå› ä¸ºä»£ç†çš„å°±æ˜¯ jcenter å“ˆã€‚</p>
<p>3ï¼Œåœ¨<code>Remote Storage Location</code>è¾“å…¥ä»£ç†ä»“åº“çš„ä»“åº“åœ°å€<code>http://jcenter.bintray.com/</code>ã€‚</p>
<p>4ï¼Œç‚¹å‡»<code>save</code>ä¿å­˜ï¼Œåœ¨ä¸Šæ–¹åˆ—è¡¨ä¸­å°±ä¼šæ˜¾ç¤ºå®Œæˆçš„ä»“åº“ä¿¡æ¯ï¼Œæœ€åä¸€åˆ—<code>Repository Path</code>å°±æ˜¯ä»“åº“çš„åœ°å€ã€‚</p>
<p>å¦‚ä¸‹å›¾ï¼š<br><img src="http://ww3.sinaimg.cn/large/72f96cbajw1f7e6iqpczrj21kw0zktlr.jpg" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>å…¶å®åœ¨æˆ‘ä»¬é¡¹ç›®é‡Œå¹¶æ²¡æœ‰æ–°åˆ›å»ºä¸€ä¸ªä»“åº“ï¼Œè€Œæ˜¯ç›´æ¥ç”¨çš„é»˜è®¤<code>Release</code>å’Œ<code>Snapshot</code>ã€‚</p>
<p><img src="http://ww2.sinaimg.cn/large/72f96cbajw1f7e6n006u5j21ji02sgn0.jpg" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<h1 id="Android-Studio-ä¸­ä¸Šä¼ -Library-Module-åˆ°ç§æœ‰-maven"><a href="#Android-Studio-ä¸­ä¸Šä¼ -Library-Module-åˆ°ç§æœ‰-maven" class="headerlink" title="Android Studio ä¸­ä¸Šä¼  Library Module åˆ°ç§æœ‰ maven"></a>Android Studio ä¸­ä¸Šä¼  Library Module åˆ°ç§æœ‰ maven</h1><h2 id="ä¸Šä¼ åˆ°-Maven"><a href="#ä¸Šä¼ åˆ°-Maven" class="headerlink" title="ä¸Šä¼ åˆ° Maven"></a>ä¸Šä¼ åˆ° Maven</h2><p>å› ä¸ºï¼ŒModuleæ¯”è¾ƒå¤šï¼Œæˆ‘åœ¨é¡¹ç›®æ ¹ç›®å½•é‡Œå†™äº†ä¸€ä¸ª gradle æ–‡ä»¶<code>gradle_mvn_push.gradle</code>æ¥ä¸Šä¼ ã€‚ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">apply <span class="string">plugin:</span> <span class="string">'maven'</span></div><div class="line"><span class="comment">//release åœ°å€</span></div><div class="line"><span class="keyword">def</span> RELEASE_REPOSITORY_URL = <span class="string">"http://192.168.4.53:32770/content/repositories/releases/"</span></div><div class="line"><span class="comment">//snapshots åœ°å€</span></div><div class="line"><span class="keyword">def</span> SNAPSHOT_REPOSITORY_URL = <span class="string">"http://192.168.4.53:32770/content/repositories/snapshots/"</span></div><div class="line"><span class="comment">//åˆ¤æ–­ VERSION_NAME å¦‚æœä»¥`-SHAPSHOT`ç»“å°¾,åˆ™ä¸Šä¼ åœ°å€ä¸º snapshot åœ°å€</span></div><div class="line"><span class="keyword">def</span> REPOSITORY_URL = VERSION_NAME.endsWith(<span class="string">"-SNAPSHOT"</span>) ? SNAPSHOT_REPOSITORY_URL : RELEASE_REPOSITORY_URL;</div><div class="line"></div><div class="line">logger.info(<span class="string">"groupId = %s\t\nartifactId = %s\t\nversion = %s\t\nrepository = %s\t\n"</span>, GROUP, POM_ARTIFACT_ID, VERSION_NAME, REPOSITORY_URL)</div><div class="line"></div><div class="line">afterEvaluate &#123; project -&gt;</div><div class="line">    uploadArchives &#123;</div><div class="line">        repositories.mavenDeployer &#123;</div><div class="line">            pom.groupId = GROUP</div><div class="line">            pom.artifactId = POM_ARTIFACT_ID</div><div class="line">            pom.version = VERSION_NAME</div><div class="line">            repository(<span class="string">url:</span> REPOSITORY_URL) &#123;</div><div class="line">                authentication(<span class="string">userName:</span> NEXUS_USERNAME, <span class="string">password:</span> NEXUS_PASSWORD)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    task androidSourcesJar(<span class="string">type:</span> Jar) &#123;</div><div class="line">        classifier = <span class="string">'sources'</span></div><div class="line">        from android.sourceSets.main.java.sourceFiles</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    artifacts &#123;</div><div class="line">        archives androidSourcesJar</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç„¶ååœ¨ä½ è¦ä¸Šä¼  module çš„<code>build.gradle</code> æ–‡ä»¶å¼•å…¥ã€‚<br>å¦‚ä¸‹å›¾æ˜¯æˆ‘ä»¬æ¢è‚¤ Module çš„ <code>build.gradle</code>ï¼š<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">apply <span class="string">plugin:</span> <span class="string">'com.android.library'</span></div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion Integer.valueOf(COMPILE_SDK_VERSION)</div><div class="line">    buildToolsVersion BUILD_TOOLS_VERSION</div><div class="line"></div><div class="line">    defaultConfig &#123;</div><div class="line">        minSdkVersion MIN_SDK_VERSION</div><div class="line">        targetSdkVersion TARGET_SDK_VERSION</div><div class="line">        versionCode <span class="number">1</span></div><div class="line">        versionName <span class="string">"1.0"</span></div><div class="line">    &#125;</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled <span class="literal">false</span></div><div class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">dependencies &#123;</div><div class="line">    compile fileTree(<span class="string">dir:</span> <span class="string">'libs'</span>, <span class="string">include:</span> [<span class="string">'*.jar'</span>])</div><div class="line">    compile SUPPORT_APPCOMPAT_V7</div><div class="line">    compile SUPPORT_CARDVIEW_V7</div><div class="line">&#125;</div><div class="line"></div><div class="line">ext.GROUP=<span class="string">"com.yiche"</span></div><div class="line">ext.VERSION_NAME=<span class="string">"1.1.0-SNAPSHOT"</span></div><div class="line">ext.POM_ARTIFACT_ID=<span class="string">"changeskin"</span></div><div class="line"></div><div class="line">apply <span class="string">from:</span> <span class="string">"$&#123;project.rootDir&#125;/gradle_mvn_push.gradle"</span></div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œè¯·å…³æ³¨ä¸‹é¢çš„ä»£ç ï¼Œ<code>GROUP</code>ï¼Œ<code>VERSION_NAME</code>ï¼Œ<code>POM_ARTIFACT_ID</code>å’Œæœ€åä¸€è¡Œå¼•å…¥æˆ‘ä»¬å‰é¢å†™çš„<code>gradle_mvn_push.gradle</code>ã€‚</p>
<p><code>GROUP</code>ä¸€èˆ¬ä»£è¡¨äº†ä½ çš„ç»„ç»‡åç§°ï¼Œä¾‹å¦‚æˆ‘çš„<code>com.yiche</code><br><code>POM_ARTIFACT_ID</code>Library çš„ç®€ç§°ã€‚<br><code>VERSION_NAME</code>ç‰ˆæœ¬å·ï¼Œå¦‚æœæœ‰<code>-SNAPSHOT</code>è¡¨ç¤ºæ˜¯å¿«ç…§ç‰ˆã€‚</p>
<p>ä¸Šé¢è¿™ä¸‰ä¸ªä¹Ÿå°±ç»„æˆäº†æˆ‘ä»¬å¹³å¸¸çœ‹è§çš„å¼•ä¾èµ– <code>com.yiche:changeskin:1.1.0-SNAPSHOT</code></p>
<h2 id="å¼•ç”¨ç§æœ‰-Maven"><a href="#å¼•ç”¨ç§æœ‰-Maven" class="headerlink" title="å¼•ç”¨ç§æœ‰ Maven"></a>å¼•ç”¨ç§æœ‰ Maven</h2><p>ä¸‹é¢å°±ç›´æ¥ä¸Šä¸€æ®µä»£ç å§ï¼Œè¿™æ˜¯é¡¹ç›®æ ¹ç›®å½•çš„<code>build.gradle</code>é‡Œé¢ä¿®æ”¹äº† maven ä»“åº“çš„åœ°å€ã€‚</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Top-level build file where you can add configuration options common to all sub-projects/modules.</span></div><div class="line">buildscript &#123;</div><div class="line">    repositories &#123;</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    dependencies &#123;</div><div class="line">        classpath <span class="string">'com.android.tools.build:gradle:2.1.3'</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">allprojects &#123;</div><div class="line"></div><div class="line">    repositories &#123;</div><div class="line"><span class="comment">//        jcenter()</span></div><div class="line">        <span class="comment">// ç§æœ‰ release åœ°å€</span></div><div class="line">        maven&#123;</div><div class="line">            url <span class="string">"http://192.168.4.53:32770/content/repositories/releases/"</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">// ç§æœ‰ snapshot åœ°å€</span></div><div class="line">        maven&#123;</div><div class="line">            url <span class="string">"http://192.168.4.53:32770/content/repositories/snapshots/"</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">//jcenter ä»£ç†</span></div><div class="line">        maven&#123;</div><div class="line">            url <span class="string">"http://192.168.4.53:32770/content/repositories/jcenter/"</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">// maven ä»£ç†</span></div><div class="line">        maven&#123;</div><div class="line">            url <span class="string">"http://192.168.4.53:32770/content/repositories/central/"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">task clean(<span class="string">type:</span> Delete) &#123;</div><div class="line">    delete rootProject.buildDir</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¥½çš„ï¼Œåˆ°è¿™é‡Œå°±ç®—ç»“æŸäº†ï¼Œåé¢è¿™éƒ¨åˆ†å†™çš„æ¯”è¾ƒå°‘ï¼Œæœ‰é—®é¢˜ç•™è¨€å•¦ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é¡¹ç›®ç»„ä»2015å¹´ä¸ŠåŠå¹´å…¨é¢åˆ‡æ¢åˆ° AndroidStudio è¿›è¡Œå¼€å‘ï¼Œéšç€è¿™1å¹´å¤šä¸šåŠ¡é€»è¾‘å’Œä»£ç é€»è¾‘çš„å¢é•¿ï¼Œå¯¼è‡´é¡¹ç›®  LibraryModule ç”±æœ€åˆçš„3ä¸ªå¢é•¿åˆ°å¦‚ä»Šçš„8ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç é‡çš„å¢åŠ å¿…ç„¶å¯¼è‡´ç¼–è¯‘çš„å˜æ…¢ï¼ŒAndroidStudio åœ¨ç¼–è¯‘é¡¹ç›®æ—¶ä¼šå…ˆ
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Nexus" scheme="http://www.kennethyo.me/tags/Nexus/"/>
    
      <category term="maven" scheme="http://www.kennethyo.me/tags/maven/"/>
    
      <category term="jcenter" scheme="http://www.kennethyo.me/tags/jcenter/"/>
    
      <category term="Docker" scheme="http://www.kennethyo.me/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>TextUtilsæ–¹æ³•ä»‹ç»</title>
    <link href="http://www.kennethyo.me/2016/07/06/2016-07-06/"/>
    <id>http://www.kennethyo.me/2016/07/06/2016-07-06/</id>
    <published>2016-07-06T07:50:37.000Z</published>
    <updated>2016-09-01T06:36:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>æŠŠä¸€ä¸ª<code>List&lt;String&gt;</code>è¾“å‡ºæˆ<code>a,b,c</code>è¿™ç§å½¢å¼ï¼Œæˆ‘ä»¬é¡¹ç›®é‡Œé¢æä¾›äº†ä¸€ä¸ªè¿™æ ·çš„å·¥å…·ç±»ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">public static String getString(List&lt;String&gt; list) &#123;</div><div class="line">        if (CollectionsWrapper.isEmpty(list)) return null;</div><div class="line"></div><div class="line">        StringBuilder sb = new StringBuilder();</div><div class="line">        int size = list.size();</div><div class="line">        for (int i = 0; i &lt; size; i++) &#123;</div><div class="line">            sb.append(list.get(i));</div><div class="line"></div><div class="line">            if (i != size - 1) &#123;</div><div class="line">                sb.append(&quot;,&quot;);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return sb.toString();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æ–¹æ³•è‚¯å®šæ˜¯å¤šç§å¤šæ ·çš„ï¼Œä½†æ˜¯<code>Android SDK</code>åœ¨<code>TextUtils</code>é‡Œé¢å°±æœ‰æä¾›äº†ä¸€ä¸ªæ–¹æ³•<code>join</code>ï¼Œå¯ä»¥è¾¾åˆ°æ•ˆæœã€‚</p>
<p>å¹³å¸¸æˆ‘å¼€å‘ç”¨<code>TextUtils</code>ä¸­æœ€å¤šçš„æ–¹æ³•åˆ†åˆ«æ˜¯<code>isEmpty</code>å’Œ<code>equals</code>ã€‚å…¶ä»–æ–¹æ³•äº†è§£å¹¶ä¸å¤šï¼Œæˆ–è€…ä¸äº†è§£ï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹ä»‹ç»ä¸€ä¸‹<code>TextUtils</code>ä¸­çš„æ–¹æ³•ï¼ˆæ³¨ï¼šæ–¹æ³•é‡è½½åªä»‹ç»ä¸€ç§ï¼Œéšè—å’Œç§æœ‰æ–¹æ³•æ²¡æœ‰ä»‹ç»ï¼‰ï¼š</p>
<h1 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h1><p>Demo åœ°å€ï¼š<a href="https://github.com/KennethYo/TextUtilsDemo" target="_blank" rel="external">ä¼ é€é—¨</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">private String mWords1 = &quot;è¿™å¥è¯å¾ˆé•¿å¾ˆé•¿ï¼ŒçœŸçš„å¾ˆé•¿å¾ˆé•¿ï¼Œé•¿çš„ä¸å¾—äº†ï¼Œé•¿çš„ä¸è¦ä¸è¦çš„ï¼Œé•¿...é•¿é•¿...chang...chang................&quot;;</div><div class="line">private String mWords2 = &quot;Andy, Bob, Charles, David, Andy, Bob, Charles, David, Andy, Bob, Charles, David, Andy, Bob, Charles, David, Andy, Bob, Charles, David&quot;;</div><div class="line">//æŠŠâ€œå¾ˆé•¿â€è®¾ç½®ä¸ºçº¢è‰²èƒŒæ™¯</div><div class="line">mSpanny1 = new Spanny(mWords1).findAndSpan(&quot;å¾ˆé•¿&quot;, new Spanny.GetSpan() &#123;</div><div class="line">            @Override</div><div class="line">            public Object getSpan() &#123;</div><div class="line">                return new BackgroundColorSpan(Color.RED);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">//æŠŠâ€œBobâ€è®¾ç½®ä¸ºçº¢è‰²èƒŒæ™¯</div><div class="line">mSpanny2 = new Spanny(mWords2).findAndSpan(&quot;Bob&quot;, new Spanny.GetSpan() &#123;</div><div class="line">            @Override</div><div class="line">            public Object getSpan() &#123;</div><div class="line">                return new BackgroundColorSpan(Color.GREEN);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div></pre></td></tr></table></figure>
<h1 id="commaEllipsize"><a href="#commaEllipsize" class="headerlink" title="commaEllipsize"></a>commaEllipsize</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">public static CharSequence commaEllipsize(CharSequence text,</div><div class="line">                                              TextPaint p, float avail,</div><div class="line">                                              String oneMore,</div><div class="line">                                              String more)</div></pre></td></tr></table></figure>
<p>ä¾‹å¦‚<code>Andy, Bob, Charles, David</code>è¿™æ ·çš„å¥å­ï¼Œä¿®æ”¹ä¸ºèƒ½å¤Ÿåœ¨ä¸€è¡Œ<code>avail</code>å®½åº¦æ˜¾ç¤ºã€‚å‘å›ç»“æœä¾‹å¦‚<br><code>Andy, Bob, 1 more</code>æˆ–<code>Andy, Bob, 2 more</code>ã€‚<br>æ³¨æ„ï¼šmore ä¸­çš„æ•°å­—è¦æœ‰<code>%d</code>æ¥formatï¼Œæ¥æ˜¾ç¤ºä¸åŒçš„æ•°å­—ã€‚<code>text</code>ä¸­å¿…é¡»ç”¨è‹±æ–‡é€—å·åˆ†éš”ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CharSequence output = TextUtils.commaEllipsize(mWords2, mTextView.getPaint(), mScreenWidth, &quot;1 more&quot;, &quot;%d more&quot;);</div></pre></td></tr></table></figure>
<h1 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static CharSequence concat(CharSequence... text)</div></pre></td></tr></table></figure>
<p>text ä¸ºå¯å˜å‚æ•°ï¼Œå¯ä»¥å°†ä¼ å…¥çš„<code>CharSequence</code>ç»„æˆä¸€ä¸ª<code>CharSequence</code>ï¼Œå¹¶ä¿ç•™åŸæœ‰çš„<code>Span</code>ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">CharSequence charSequence = TextUtils.concat(mSpanny1, mSpanny2);</div><div class="line">                mOutputView.setText(charSequence);</div></pre></td></tr></table></figure>
<h1 id="copySpansFrom"><a href="#copySpansFrom" class="headerlink" title="copySpansFrom"></a>copySpansFrom</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public static void copySpansFrom(Spanned source, int start, int end,</div><div class="line">                                     Class kind,</div><div class="line">                                     Spannable dest, int destoff)</div></pre></td></tr></table></figure>
<p>ä»<code>source</code>ä¸­<code>start</code>åˆ°<code>end</code> ä¸­çš„<code>span</code>å¤åˆ¶åˆ°<code>dest</code>ä¸­ï¼Œ<code>destoff</code>æ˜¯åç§»é‡ã€‚è¿™ä¸ªæ–¹æ³•åœ¨<code>concat</code>ä¸­æœ‰ç”¨åˆ°ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">String words = mWords1 + mWords2;</div><div class="line">mTextView.setText(words);</div><div class="line">mTextView.append(&quot;\n\n&quot;);</div><div class="line">mTextView.append(mSpanny2);</div><div class="line"></div><div class="line">SpannableString ss = new SpannableString(words);</div><div class="line">TextUtils.copySpansFrom(mSpanny2, 0, mSpanny2.length(), Object.class, ss, mWords1.length());</div><div class="line"></div><div class="line">mOutputView.setText(ss);</div></pre></td></tr></table></figure>
<h1 id="dumpSpans"><a href="#dumpSpans" class="headerlink" title="dumpSpans"></a>dumpSpans</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static void dumpSpans(CharSequence cs, Printer printer, String prefix)</div></pre></td></tr></table></figure>
<p>æ‰“å°<code>cs</code>ä¸­çš„<code>Span</code>ï¼Œ<code>prefix</code>ä¼šåœ¨æ‰“å°æ¯ä¸ª<code>Span</code>å¼€å§‹å‡ºç°ã€‚<code>printer</code>ï¼Œå¯ä»¥ç”¨<code>LogPrinter</code>ï¼Œè¿™æ ·å°±å¯ä»¥æ‰“å°åœ¨ log é‡Œã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TextUtils.dumpSpans(mSpanny1, new LogPrinter(Log.INFO, &quot;kenneth&quot;), &quot;yo&quot;);</div></pre></td></tr></table></figure>
<p>Logæ—¥å¿—</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">07-01 14:53:20.229 9835-9835/me.kenneth.textutildemo I/kenneth: yoå¾ˆé•¿: 4189d0d0 android.text.style.BackgroundColorSpan (3-5) fl=#33</div><div class="line">07-01 14:53:20.229 9835-9835/me.kenneth.textutildemo I/kenneth: yoå¾ˆé•¿: 4189d3a8 android.text.style.BackgroundColorSpan (5-7) fl=#33</div><div class="line">07-01 14:53:20.229 9835-9835/me.kenneth.textutildemo I/kenneth: yoå¾ˆé•¿: 4189d5b8 android.text.style.BackgroundColorSpan (10-12) fl=#33</div><div class="line">07-01 14:53:20.230 9835-9835/me.kenneth.textutildemo I/kenneth: yoå¾ˆé•¿: 4189d728 android.text.style.BackgroundColorSpan (12-14) fl=#33</div></pre></td></tr></table></figure>
<h1 id="ellipsize"><a href="#ellipsize" class="headerlink" title="ellipsize"></a>ellipsize</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">public static CharSequence ellipsize(CharSequence text,</div><div class="line">                                         TextPaint paint,</div><div class="line">                                         float avail, TruncateAt where,</div><div class="line">                                         boolean preserveLength,</div><div class="line">                                         EllipsizeCallback callback)</div></pre></td></tr></table></figure>
<p>ç›¸å½“äº <code>TextView</code> çš„ xml ä¸­<code>ellipsize</code>ï¼Œè¿™é‡Œå¯ä»¥å›è°ƒçœç•¥èŒƒå›´çš„ <code>index</code>ï¼ŒåŒæ—¶ä¹Ÿå¯ç”¨é€šè¿‡<code>preserveLength</code>ï¼Œè®¾ç½®è¿”å›çš„ <code>CharSequence</code> çš„é•¿åº¦ä¸ºåŸå§‹é•¿åº¦è¿˜æ˜¯çœç•¥åçš„é•¿åº¦ï¼Œè¿™é‡Œåˆ©ç”¨çš„â€é›¶å®½ä¸æ¢è¡Œç©ºæ ¼ç¬¦â€æ¥å ä½ï¼Œ<code>where</code>å‚æ•°å¯ä»¥ç”¨<code>TextUtils.TruncateAt.START</code>ï¼Œ<code>TextUtils.TruncateAt.END</code>ï¼Œ<code>TextUtils.TruncateAt.MIDDLE</code>å’Œ<code>TextUtils.TruncateAt.MARQUEE</code>ï¼Œåˆ†åˆ«æ˜¯å¼€å§‹ï¼Œç»“å°¾ï¼Œä¸­é—´å’Œè·‘é©¬ç¯ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">CharSequence ellipsize = TextUtils.ellipsize(mWords2, mTextView.getPaint(), mScreenWidth, TextUtils.TruncateAt.START, true, new TextUtils.EllipsizeCallback() &#123;</div><div class="line">                    @Override</div><div class="line">                    public void ellipsized(int i, int i1) &#123;</div><div class="line">                        Log.i(TAG, &quot;è¢«çœç•¥èŒƒå›´ &quot; + i + &quot; &quot; + i1);</div><div class="line">                    &#125;</div><div class="line">                &#125;);</div></pre></td></tr></table></figure>
<h1 id="equals"><a href="#equals" class="headerlink" title="equals"></a>equals</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static boolean equals(CharSequence a, CharSequence b)</div></pre></td></tr></table></figure>
<p>æ¯”è¾ƒå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹æºç ï¼Œå¦‚æœæ˜¯ç›¸åŒæ–‡æœ¬å†…å®¹ï¼Œä½†æ˜¯<code>span</code>ä¸åŒï¼Œä¹Ÿå¯ä»¥æ¯”è¾ƒä¸ºç›¸åŒã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TextUtils.equals(mWords1, mSpanny1)</div></pre></td></tr></table></figure>
<h1 id="expandTemplate"><a href="#expandTemplate" class="headerlink" title="expandTemplate"></a>expandTemplate</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">public static CharSequence expandTemplate(CharSequence template,</div><div class="line">                                              CharSequence... values)</div></pre></td></tr></table></figure>
<p>æ›¿æ¢<code>template</code>å½“ä¸­çš„<code>^1`` ^2</code> ç­‰ä¸º<code>values</code>ä¸­ç›¸åº”çš„å€¼ï¼Œæ³¨æ„ï¼šä¸èƒ½è¶…è¿‡9ä¸ªï¼Œ9ä¸ªä»¥ä¸Šä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">String template = &quot;This is a ^1 of the ^2 broadcast ^3.&quot;;</div><div class="line">                mTextView.setText(template);</div><div class="line"></div><div class="line">                CharSequence expandTemplate = TextUtils.expandTemplate(template, &quot;test&quot;, &quot;emergency&quot;, &quot;system&quot;);</div></pre></td></tr></table></figure>
<h1 id="getCapsMode"><a href="#getCapsMode" class="headerlink" title="getCapsMode"></a>getCapsMode</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static int getCapsMode(CharSequence cs, int off, int reqModes)</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•ä¸çŸ¥é“æ€ä¹ˆç”¨ï¼Œæ±‚ç•™è¨€èµæ•™ã€‚</p>
<h1 id="getChars"><a href="#getChars" class="headerlink" title="getChars"></a>getChars</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">public static void getChars(CharSequence s, int start, int end,</div><div class="line">                                char[] dest, int destoff)</div></pre></td></tr></table></figure>
<p>åˆ†åˆ«å„è‡ªè°ƒç”¨ <code>CharSequence</code>çš„ <code>getChars</code>å®ç°ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">char[] buffer = new char[5];</div><div class="line">                TextUtils.getChars(mWords1, 2, 4, buffer, 0);</div></pre></td></tr></table></figure>
<h1 id="getLayoutDirectionFromLocale"><a href="#getLayoutDirectionFromLocale" class="headerlink" title="getLayoutDirectionFromLocale"></a>getLayoutDirectionFromLocale</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static int getLayoutDirectionFromLocale(Locale locale)</div></pre></td></tr></table></figure>
<p>æ ¹æ®ä¼ å…¥çš„ <code>local</code>è·å–å½“å‰çš„é˜…è¯»ä¹ æƒ¯ï¼ˆä¾‹å¦‚ï¼Œæ±‰è¯­ä¹ æƒ¯æ˜¯å·¦åˆ°å³ï¼Œå¸Œä¼¯æ¥è¯­æ˜¯å³åˆ°å·¦ï¼‰ï¼Œå…·ä½“å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼Œ<a href="http://droidyue.com/blog/2014/07/07/support-rtl-in-android/index.html" target="_blank" rel="external">http://droidyue.com/blog/2014/07/07/support-rtl-in-android/index.html</a></p>
<h1 id="getOffsetAfter"><a href="#getOffsetAfter" class="headerlink" title="getOffsetAfter"></a>getOffsetAfter</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static int getOffsetAfter(CharSequence text, int offset)</div></pre></td></tr></table></figure>
<p>è·å–æ–‡æœ¬ä¹‹åçš„åç§»é‡ ç»“åˆæ–¹æ³•é‡Œçš„å†…å®¹çœ‹æ¯”è¾ƒå®¹æ˜“,æ–¹æ³•é‡Œé¢çš„<code>Unicode</code>éƒ½æ˜¯æˆ‘ä»¬æ‰€è°“çš„éæ³•å­—ç¬¦ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mTextView.setText(mWords1);</div><div class="line">mTextView.append(&quot;\n\n&quot;);</div><div class="line">mWords1 = mWords1.replace(&quot;å¾ˆ&quot;, &quot;\uD800&quot;);</div><div class="line">mWords1 = mWords1.replace(&quot;é•¿&quot;, &quot;\uDFFF&quot;);</div><div class="line">mTextView.append(mWords1);</div><div class="line">int offsetAfter = TextUtils.getOffsetAfter(mWords1, 5);</div><div class="line">                mOutputView.setText(String.valueOf(offsetAfter));</div><div class="line">                mOutputView.append(&quot;\n\n&quot;);</div><div class="line">                mOutputView.append(mWords1.substring(offsetAfter));</div></pre></td></tr></table></figure>
<h1 id="getOffsetBefore"><a href="#getOffsetBefore" class="headerlink" title="getOffsetBefore"></a>getOffsetBefore</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static int getOffsetBefore(CharSequence text, int offset)</div></pre></td></tr></table></figure>
<p>è·å–æ–‡æœ¬ä¹‹å‰çš„åç§»é‡ ç»“åˆæ–¹æ³•é‡Œçš„å†…å®¹çœ‹æ¯”è¾ƒå®¹æ˜“,æ–¹æ³•é‡Œé¢çš„<code>Unicode</code>éƒ½æ˜¯æˆ‘ä»¬æ‰€è°“çš„éæ³•å­—ç¬¦ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mTextView.setText(mWords1);</div><div class="line">mTextView.append(&quot;\n\n&quot;);</div><div class="line">mWords1 = mWords1.replace(&quot;å¥&quot;, &quot;\uD800&quot;);</div><div class="line">mWords1 = mWords1.replace(&quot;è¯&quot;, &quot;\uDFFF&quot;);</div><div class="line">mTextView.setText(mWords1);</div><div class="line">int offsetBefore = TextUtils.getOffsetBefore(mWords1, 5);</div><div class="line">                mOutputView.setText(String.valueOf(offsetBefore));</div><div class="line">mOutputView.append(&quot;\n\n&quot;);</div><div class="line">                mOutputView.append(mWords1.substring(offsetBefore));</div></pre></td></tr></table></figure>
<h1 id="getReverse"><a href="#getReverse" class="headerlink" title="getReverse"></a>getReverse</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">public static CharSequence getReverse(CharSequence source,</div><div class="line">                                          int start, int end)</div></pre></td></tr></table></figure>
<p>ç¿»è½¬<code>start</code>åˆ°<code>end</code>çš„å­—ç¬¦ä¸²ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CharSequence reverse = TextUtils.getReverse(mWords1, 0, mWords1.length());</div></pre></td></tr></table></figure>
<h1 id="getTrimmedLength"><a href="#getTrimmedLength" class="headerlink" title="getTrimmedLength"></a>getTrimmedLength</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static int getTrimmedLength(CharSequence s)</div></pre></td></tr></table></figure>
<p>trim åçš„å­—ç¬¦ä¸²é•¿åº¦ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mWords1 = &quot; &quot; + mWords1 + &quot; &quot;;</div><div class="line">mTextView.setText(mWords1);</div><div class="line">mTextView.append(&quot;\n\n&quot;);</div><div class="line">                mTextView.append(String.valueOf(mWords1.length()));</div><div class="line">int trimmedLength = TextUtils.getTrimmedLength(mWords1);</div><div class="line">                mOutputView.setText(String.valueOf(trimmedLength));</div></pre></td></tr></table></figure>
<h1 id="htmlEncode"><a href="#htmlEncode" class="headerlink" title="htmlEncode"></a>htmlEncode</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static String htmlEncode(String s)</div></pre></td></tr></table></figure>
<p>encode html ï¼Œæ³¨æ„æ˜¯ html ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">String code = &quot;&lt;h1&gt;html&lt;/h1&gt; &quot; + mWords1;</div><div class="line">                mTextView.setText(code);</div><div class="line">                mOutputView.setText(TextUtils.htmlEncode(code));</div></pre></td></tr></table></figure>
<h1 id="indexOf"><a href="#indexOf" class="headerlink" title="indexOf"></a>indexOf</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">public static int indexOf(CharSequence s, CharSequence needle,</div><div class="line">                              int start, int end)</div></pre></td></tr></table></figure>
<p>è·å–<code>needle</code>å­—ç¬¦çš„ indexã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">int indexOf = TextUtils.indexOf(mWords1, &quot;ä¸è¦çš„&quot;, 0, mWords1.length());</div><div class="line">                mOutputView.setText(String.valueOf(indexOf));</div><div class="line">                mOutputView.append(mWords1.substring(indexOf));</div></pre></td></tr></table></figure>
<h1 id="isDigitsOnly"><a href="#isDigitsOnly" class="headerlink" title="isDigitsOnly"></a>isDigitsOnly</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static boolean isDigitsOnly(CharSequence str)</div></pre></td></tr></table></figure>
<p>åˆ¤æ–­æ˜¯å¦ä»…æœ‰æ•°å­—ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">mTextView.setText(mWords1);</div><div class="line">String digits = &quot;1234&quot;;</div><div class="line">mTextView.append(&quot;\n\n&quot;);</div><div class="line">mTextView.append(digits);</div><div class="line">String digits1 = &quot;123w123&quot;;</div><div class="line">mTextView.append(&quot;\n\n&quot;);</div><div class="line">mTextView.append(digits1);</div><div class="line">boolean digitsOnly = TextUtils.isDigitsOnly(mWords1);</div><div class="line">boolean digitsOnly1 = TextUtils.isDigitsOnly(digits);</div><div class="line">boolean digitsOnly2 = TextUtils.isDigitsOnly(digits1);</div><div class="line">                mOutputView.setText(String.valueOf(digitsOnly));</div><div class="line">mOutputView.append(&quot;\n\n&quot;);</div><div class="line">                mOutputView.append(String.valueOf(digitsOnly1));</div><div class="line">mOutputView.append(&quot;\n\n&quot;);</div><div class="line">                mOutputView.append(String.valueOf(digitsOnly2));</div></pre></td></tr></table></figure>
<h1 id="isEmpty"><a href="#isEmpty" class="headerlink" title="isEmpty"></a>isEmpty</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static boolean isEmpty(CharSequence str)</div></pre></td></tr></table></figure>
<p>åˆ¤ç©ºï¼Œè¿™ä¸ªå¤ªå¸¸ç”¨äº†ã€‚</p>
<h1 id="isGraphic"><a href="#isGraphic" class="headerlink" title="isGraphic"></a>isGraphic</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static boolean isGraphic(CharSequence str)</div></pre></td></tr></table></figure>
<p>åˆ¤æ–­æ˜¯å¦æœ‰å¯ä»¥æ˜¾ç¤ºå‡ºæ¥çš„å­—ç¬¦ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">String graphic = &quot;\n \t \b&quot;;</div><div class="line">mTextView.setText(graphic);</div><div class="line">            mOutputView.setText(String.valueOf(TextUtils.isGraphic(graphic)));</div></pre></td></tr></table></figure>
<h1 id="join"><a href="#join" class="headerlink" title="join"></a>join</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static String join(CharSequence delimiter, Iterable tokens)</div></pre></td></tr></table></figure>
<p>è¿æ¥æ•°ç»„ï¼Œä¾‹å¦‚ï¼ša b c d è¾“å‡º a-b-c-dï¼Œè¿™ä¸ªæ–¹æ³•çš„é‡è½½æ”¯æŒäº†å¾ˆå¤šç±»å‹ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">List&lt;String&gt; list = new ArrayList&lt;&gt;();</div><div class="line">list.add(&quot;a&quot;);</div><div class="line">list.add(&quot;b&quot;);</div><div class="line">list.add(&quot;c&quot;);</div><div class="line">list.add(&quot;d&quot;);</div><div class="line">mTextView.setText(list.toString());</div><div class="line">mOutputView.setText(TextUtils.join(&quot;-&quot;, list));</div></pre></td></tr></table></figure>
<h1 id="lastIndexOf"><a href="#lastIndexOf" class="headerlink" title="lastIndexOf"></a>lastIndexOf</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static int lastIndexOf(CharSequence s, char ch)</div></pre></td></tr></table></figure>
<p>å­—ç¬¦<code>ch</code>æœ€åä¸€æ¬¡å‡ºç°çš„<code>index</code>ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mTextView.setText(mWords1);</div><div class="line">int c = TextUtils.lastIndexOf(mWords1, &apos;c&apos;);               mOutputView.setText(String.valueOf(c));</div><div class="line">mOutputView.append(&quot;\n\n&quot;);                mOutputView.append(mWords1.substring(c));</div></pre></td></tr></table></figure>
<h1 id="regionMatches"><a href="#regionMatches" class="headerlink" title="regionMatches"></a>regionMatches</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public static boolean regionMatches(CharSequence one, int toffset,</div><div class="line">                                        CharSequence two, int ooffset,</div><div class="line">                                        int len) &#123;</div></pre></td></tr></table></figure>
<p>æ¯”å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸² <code>offset</code>åˆ° <code>len</code> çš„é•¿åº¦çš„å­—ç¬¦ä¸²æ˜¯å¦ç›¸åŒã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mOutputView.setText(TextUtils.replace(mWords1,new String[]&#123;&quot;å¾ˆé•¿&quot;,&quot;çš„&quot;,&quot;.&quot;&#125;,new String[]&#123;&quot;very long&quot;,&quot;of&quot;,&quot;ã€‚&quot;&#125;));</div></pre></td></tr></table></figure>
<h1 id="replace"><a href="#replace" class="headerlink" title="replace"></a>replace</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public static CharSequence replace(CharSequence template,</div><div class="line">                                       String[] sources,</div><div class="line">                                       CharSequence[] destinations)</div></pre></td></tr></table></figure>
<p>æ›¿æ¢åŠŸèƒ½ï¼Œæ³¨æ„ï¼šåªä¼šæ›¿æ¢ç¬¬ä¸€ä¸ªå‡ºç°çš„ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mOutputView.setText(TextUtils.replace(mWords1,new String[]&#123;&quot;å¾ˆé•¿&quot;,&quot;çš„&quot;,&quot;.&quot;&#125;,new String[]&#123;&quot;very long&quot;,&quot;of&quot;,&quot;ã€‚&quot;&#125;));</div></pre></td></tr></table></figure>
<h1 id="split"><a href="#split" class="headerlink" title="split"></a>split</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static String[] split(String text, String expression)</div></pre></td></tr></table></figure>
<p>åˆ†å‰²å­—ç¬¦ä¸²ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mOutputView.setText(TextUtils.join(&quot;--&quot;,TextUtils.split(mWords2,&quot;,&quot;)));</div></pre></td></tr></table></figure>
<h1 id="stringOrSpannedString"><a href="#stringOrSpannedString" class="headerlink" title="stringOrSpannedString"></a>stringOrSpannedString</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static CharSequence stringOrSpannedString(CharSequence source)</div></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯ <code>String</code> è¿”å› <code>String</code> ï¼Œ<code>spannedString</code> æˆ– <code>spanned</code> è¿”å› <code>spannedString</code>ã€‚</p>
<p>ä¾‹å­:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mOutputView.setText(TextUtils.stringOrSpannedString(mSpanny1));</div></pre></td></tr></table></figure>
<h1 id="substring"><a href="#substring" class="headerlink" title="substring"></a>substring</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public static String substring(CharSequence source, int start, int end)</div></pre></td></tr></table></figure>
<p>åˆ†å‰²å­—ç¬¦ä¸²ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mOutputView.setText(TextUtils.substring(mSpanny1,2,16));</div></pre></td></tr></table></figure>
<h1 id="writeToParcel"><a href="#writeToParcel" class="headerlink" title="writeToParcel"></a>writeToParcel</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">public static void writeToParcel(CharSequence cs, Parcel p,</div><div class="line">            int parcelableFlags)</div></pre></td></tr></table></figure>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mTextView.setText(&quot;ä¸€èˆ¬ç”¨ä½œåºåˆ—åŒ– CharSequence å­ç±»&quot;);</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æŠŠä¸€ä¸ª&lt;code&gt;List&amp;lt;String&amp;gt;&lt;/code&gt;è¾“å‡ºæˆ&lt;code&gt;a,b,c&lt;/code&gt;è¿™ç§å½¢å¼ï¼Œæˆ‘ä»¬é¡¹ç›®é‡Œé¢æä¾›äº†ä¸€ä¸ªè¿™æ ·çš„å·¥å…·ç±»ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://www.kennethyo.me/tags/Android/"/>
    
      <category term="Utils" scheme="http://www.kennethyo.me/tags/Utils/"/>
    
      <category term="TextView" scheme="http://www.kennethyo.me/tags/TextView/"/>
    
      <category term="EditText" scheme="http://www.kennethyo.me/tags/EditText/"/>
    
      <category term="TextUtils" scheme="http://www.kennethyo.me/tags/TextUtils/"/>
    
  </entry>
  
  <entry>
    <title>Mac ä¸‹åç¼–è¯‘ apk</title>
    <link href="http://www.kennethyo.me/2016/06/21/2016-06-21/"/>
    <id>http://www.kennethyo.me/2016/06/21/2016-06-21/</id>
    <published>2016-06-21T03:34:24.000Z</published>
    <updated>2016-09-01T06:36:58.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1ï¼Œç¯å¢ƒå‡†å¤‡"><a href="#1ï¼Œç¯å¢ƒå‡†å¤‡" class="headerlink" title="1ï¼Œç¯å¢ƒå‡†å¤‡"></a>1ï¼Œç¯å¢ƒå‡†å¤‡</h1><p><code>brew install apktool</code><br><code>brew install dex2jar</code><br><code>jd-gui</code></p>
<h1 id="2ï¼Œåç¼–è¯‘-ä»£ç "><a href="#2ï¼Œåç¼–è¯‘-ä»£ç " class="headerlink" title="2ï¼Œåç¼–è¯‘ ä»£ç "></a>2ï¼Œåç¼–è¯‘ ä»£ç </h1><p>è§£å‹ apk æ‹¿åˆ° dex æ–‡ä»¶<br>æ‰§è¡Œ <code>d2j-dex2jar classes.dex</code> è·å–åˆ° jar æ–‡ä»¶ï¼Œæ‹–è¿› jd-gui å°±å¯ä»¥äº†</p>
<h1 id="3ï¼Œåç¼–è¯‘èµ„æºæ–‡ä»¶"><a href="#3ï¼Œåç¼–è¯‘èµ„æºæ–‡ä»¶" class="headerlink" title="3ï¼Œåç¼–è¯‘èµ„æºæ–‡ä»¶"></a>3ï¼Œåç¼–è¯‘èµ„æºæ–‡ä»¶</h1><p>æ‰§è¡Œ <code>apktool  d *.apk</code><br>-f  å¦‚æœç›®æ ‡æ–‡ä»¶å­˜åœ¨ï¼Œåˆ é™¤å­˜åœ¨<br>-o æŒ‡å®šç›®æ ‡æ–‡ä»¶å¤¹åå­—<br>-s ä¸åç¼–è¯‘ dex æ–‡ä»¶<br>-r ä¸åç¼–è¯‘èµ„æºæ–‡ä»¶</p>
<h1 id="4ï¼Œé‡æ–°æ‰“åŒ…"><a href="#4ï¼Œé‡æ–°æ‰“åŒ…" class="headerlink" title="4ï¼Œé‡æ–°æ‰“åŒ…"></a>4ï¼Œé‡æ–°æ‰“åŒ…</h1><p><code>apktool b *.apk -o new.apk</code></p>
<h1 id="5ï¼Œç­¾å-éœ€è¦-java-ç¯å¢ƒå˜é‡"><a href="#5ï¼Œç­¾å-éœ€è¦-java-ç¯å¢ƒå˜é‡" class="headerlink" title="5ï¼Œç­¾å(éœ€è¦ java ç¯å¢ƒå˜é‡)"></a>5ï¼Œç­¾å(éœ€è¦ java ç¯å¢ƒå˜é‡)</h1><p><code>jarsigner  -verbose   -sigalg SHA1withRSA -digestalg SHA1 -keystore ç­¾åæ–‡ä»¶ -storepass ç­¾åå¯†ç  å¾…ç­¾å apk ç­¾åçš„åˆ«å</code></p>
<h1 id="6ï¼Œå¯¹é½æ“ä½œï¼ˆç¨‹åºè¿è¡Œçš„æ›´å¿«ï¼‰"><a href="#6ï¼Œå¯¹é½æ“ä½œï¼ˆç¨‹åºè¿è¡Œçš„æ›´å¿«ï¼‰" class="headerlink" title="6ï¼Œå¯¹é½æ“ä½œï¼ˆç¨‹åºè¿è¡Œçš„æ›´å¿«ï¼‰"></a>6ï¼Œå¯¹é½æ“ä½œï¼ˆç¨‹åºè¿è¡Œçš„æ›´å¿«ï¼‰</h1><p><code>zipalign 4 *.apk *_aligned.apk</code></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;1ï¼Œç¯å¢ƒå‡†å¤‡&quot;&gt;&lt;a href=&quot;#1ï¼Œç¯å¢ƒå‡†å¤‡&quot; class=&quot;headerlink&quot; title=&quot;1ï¼Œç¯å¢ƒå‡†å¤‡&quot;&gt;&lt;/a&gt;1ï¼Œç¯å¢ƒå‡†å¤‡&lt;/h1&gt;&lt;p&gt;&lt;code&gt;brew install apktool&lt;/code&gt;&lt;br&gt;&lt;code&gt;brew instal
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://www.kennethyo.me/tags/Android/"/>
    
      <category term="åç¼–è¯‘" scheme="http://www.kennethyo.me/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/"/>
    
      <category term="brew" scheme="http://www.kennethyo.me/tags/brew/"/>
    
  </entry>
  
  <entry>
    <title>CURLå¸¸ç”¨æŒ‡ä»¤</title>
    <link href="http://www.kennethyo.me/2016/06/17/2016-06-17/"/>
    <id>http://www.kennethyo.me/2016/06/17/2016-06-17/</id>
    <published>2016-06-17T03:48:12.000Z</published>
    <updated>2016-09-01T06:37:11.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç "><a href="#ä¸€ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç " class="headerlink" title="ä¸€ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç "></a>ä¸€ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç </h1><p><code>curl www.bitauto.com</code><br>ä¿å­˜ç½‘é¡µ<br><code>curl -o demo.txt www.bitauto.com</code></p>
<h1 id="äºŒï¼Œè‡ªåŠ¨è·³è½¬"><a href="#äºŒï¼Œè‡ªåŠ¨è·³è½¬" class="headerlink" title="äºŒï¼Œè‡ªåŠ¨è·³è½¬"></a>äºŒï¼Œè‡ªåŠ¨è·³è½¬</h1><p><code>curl -L www.bitauto.com</code></p>
<h1 id="ä¸‰ï¼Œæ˜¾ç¤ºå¤´ä¿¡æ¯"><a href="#ä¸‰ï¼Œæ˜¾ç¤ºå¤´ä¿¡æ¯" class="headerlink" title="ä¸‰ï¼Œæ˜¾ç¤ºå¤´ä¿¡æ¯"></a>ä¸‰ï¼Œæ˜¾ç¤ºå¤´ä¿¡æ¯</h1><p><code>curl -i www.bitauto.com</code></p>
<h1 id="å››ï¼Œæ˜¾ç¤ºé€šä¿¡è¿‡ç¨‹"><a href="#å››ï¼Œæ˜¾ç¤ºé€šä¿¡è¿‡ç¨‹" class="headerlink" title="å››ï¼Œæ˜¾ç¤ºé€šä¿¡è¿‡ç¨‹"></a>å››ï¼Œæ˜¾ç¤ºé€šä¿¡è¿‡ç¨‹</h1><p><code>curl -v www.bitauto.com</code><br>æ›´å¤šè¯¦ç»†ä¿¡æ¯<br><code>curl --trace demo.txt www.bitauto.com</code><br><code>curl --trace--ascii demo.txt www.bitauto.com</code></p>
<h1 id="äº”ï¼Œå‘é€è¡¨å•ä¿¡æ¯"><a href="#äº”ï¼Œå‘é€è¡¨å•ä¿¡æ¯" class="headerlink" title="äº”ï¼Œå‘é€è¡¨å•ä¿¡æ¯"></a>äº”ï¼Œå‘é€è¡¨å•ä¿¡æ¯</h1><p>GET<br><code>curl www.bitauto.com/?data=xxx</code><br>POST<br><code>curl -X POST --data &quot;data=xxx&quot; www.bitauto.com</code><br><code>curl -X POST --data-urlencode &quot;data=hello world&quot; www.bitauto.com</code><br>DELETE<br><code>curl -X DELETE www.bitauto.com</code></p>
<h1 id="å…­ï¼Œä¸Šä¼ æ–‡ä»¶"><a href="#å…­ï¼Œä¸Šä¼ æ–‡ä»¶" class="headerlink" title="å…­ï¼Œä¸Šä¼ æ–‡ä»¶"></a>å…­ï¼Œä¸Šä¼ æ–‡ä»¶</h1><p><code>curl --form uplaod=@demo.txt --form press=OK www.bitauto.com</code></p>
<h1 id="ä¸ƒï¼ŒReferer-å­—æ®µ"><a href="#ä¸ƒï¼ŒReferer-å­—æ®µ" class="headerlink" title="ä¸ƒï¼ŒReferer å­—æ®µ"></a>ä¸ƒï¼ŒReferer å­—æ®µ</h1><p><code>curl --referer www.bitauto.com www.bitauto.com</code></p>
<h1 id="ä¹ï¼ŒUser-Agent-å­—æ®µ"><a href="#ä¹ï¼ŒUser-Agent-å­—æ®µ" class="headerlink" title="ä¹ï¼ŒUser Agent å­—æ®µ"></a>ä¹ï¼ŒUser Agent å­—æ®µ</h1><p><code>curl --user-agent &quot;user-agent&quot; www.bitauto.com</code></p>
<h1 id="åï¼ŒCookie"><a href="#åï¼ŒCookie" class="headerlink" title="åï¼ŒCookie"></a>åï¼ŒCookie</h1><p><code>curl --cookie  &quot;name=demo&quot; www.bitauto.com</code><br>ä¿å­˜ cookie åˆ°æ–‡ä»¶å¤¹<br><code>curl -c filename www.bitauto.com</code><br>ä½¿ç”¨æ–‡ä»¶çš„ cookie<br><code>curl -b filename www.bitauto.com</code></p>
<h1 id="åä¸€ï¼Œå¢åŠ å¤´ä¿¡æ¯"><a href="#åä¸€ï¼Œå¢åŠ å¤´ä¿¡æ¯" class="headerlink" title="åä¸€ï¼Œå¢åŠ å¤´ä¿¡æ¯"></a>åä¸€ï¼Œå¢åŠ å¤´ä¿¡æ¯</h1><p><code>curl --header &quot;Content-Type:application/json&quot; www.bitauto.com</code></p>
<h1 id="åäºŒï¼ŒHTTP-è®¤è¯"><a href="#åäºŒï¼ŒHTTP-è®¤è¯" class="headerlink" title="åäºŒï¼ŒHTTP è®¤è¯"></a>åäºŒï¼ŒHTTP è®¤è¯</h1><p><code>curl --user name:password www.bitauto.com</code></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ä¸€ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç &quot;&gt;&lt;a href=&quot;#ä¸€ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç &quot; class=&quot;headerlink&quot; title=&quot;ä¸€ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç &quot;&gt;&lt;/a&gt;ä¸€ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç &lt;/h1&gt;&lt;p&gt;&lt;code&gt;curl www.bitauto.com&lt;/code&gt;&lt;br&gt;ä¿å­˜ç½‘é¡µ&lt;
    
    </summary>
    
      <category term="Web" scheme="http://www.kennethyo.me/categories/Web/"/>
    
    
      <category term="Web" scheme="http://www.kennethyo.me/tags/Web/"/>
    
      <category term="CURL" scheme="http://www.kennethyo.me/tags/CURL/"/>
    
  </entry>
  
  <entry>
    <title>[åŸ]React-Native Android å­¦ä¹ ç¬”è®°â€”â€”2ï¼Œè‡ªå®šä¹‰ logger</title>
    <link href="http://www.kennethyo.me/2016/03/23/2016-03-23/"/>
    <id>http://www.kennethyo.me/2016/03/23/2016-03-23/</id>
    <published>2016-03-23T08:35:48.000Z</published>
    <updated>2016-09-01T06:37:33.000Z</updated>
    
    <content type="html"><![CDATA[<p>é€šè¿‡ä¸Šä¸€ç¯‡<a href="http://blog.csdn.net/kennethyo/article/details/50923909" target="_blank" rel="external">ã€Š React-Native Android å­¦ä¹ ç¬”è®°â€”â€”1ï¼Œé…ç½®ç¯å¢ƒã€‹</a>ä¸‹è½½äº†AwesomeProjecté¡¹ç›®å¹¶è¿è¡Œäº† demoã€‚å¦‚ä¸‹å›¾ï¼š<br><img src="http://img.blog.csdn.net/20160322185844293" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"><br>åº”è¯¥å’Œä½ è¿è¡Œèµ·æ¥çš„ç›¸åŒï¼Œä½†æ˜¯é™¤äº†<code>Welcome to React Native</code>çš„é¢œè‰²ã€‚</p>
<h2 id="ä¸€ï¼Œindex-android-js-æ–‡ä»¶"><a href="#ä¸€ï¼Œindex-android-js-æ–‡ä»¶" class="headerlink" title="ä¸€ï¼Œindex.android.js æ–‡ä»¶"></a>ä¸€ï¼Œindex.android.js æ–‡ä»¶</h2><p>demo é»˜è®¤å±•ç¤ºåœ¨æˆ‘ä»¬é¢å‰çš„è¿™ä¸ªé¡µé¢å…¶å®æ˜¯æˆ‘ä»¬ä¸‹è½½<code>AwesomeProject</code>é¡¹ç›®ä¸‹çš„<code>index.android.js</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Sample React Native App</span></div><div class="line"><span class="comment"> * https://github.com/facebook/react-native</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">import</span> React, &#123;</div><div class="line">  AppRegistry,</div><div class="line">  Component,</div><div class="line">  StyleSheet,</div><div class="line">  Text,</div><div class="line">  View,</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AwesomeProject</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;View style=&#123;styles.container&#125;&gt;</div><div class="line">        &lt;Text style=&#123;styles.welcome&#125;&gt;</div><div class="line">          Welcome to React Native!</div><div class="line">        &lt;<span class="regexp">/Text&gt;</span></div><div class="line"><span class="regexp">        &lt;Text style=&#123;styles.instructions&#125;&gt;</span></div><div class="line"><span class="regexp">          To get started, edit index.android.js</span></div><div class="line"><span class="regexp">        &lt;/</span>Text&gt;</div><div class="line">        &lt;Text style=&#123;styles.instructions&#125;&gt;</div><div class="line">          Shake or press menu button <span class="keyword">for</span> dev menu</div><div class="line">        &lt;<span class="regexp">/Text&gt;</span></div><div class="line"><span class="regexp">      &lt;/</span>View&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</div><div class="line">  container: &#123;</div><div class="line">    flex: <span class="number">1</span>,</div><div class="line">    justifyContent: <span class="string">'center'</span>,</div><div class="line">    alignItems: <span class="string">'center'</span>,</div><div class="line">    backgroundColor: <span class="string">'#F5FCFF'</span>,</div><div class="line">  &#125;,</div><div class="line">  welcome: &#123;</div><div class="line">    fontSize: <span class="number">20</span>,</div><div class="line">    textAlign: <span class="string">'center'</span>,</div><div class="line">    margin: <span class="number">10</span>,</div><div class="line">    color:<span class="string">'red'</span></div><div class="line">  &#125;,</div><div class="line">  instructions: &#123;</div><div class="line">    textAlign: <span class="string">'center'</span>,</div><div class="line">    color: <span class="string">'#333333'</span>,</div><div class="line">    marginBottom: <span class="number">5</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">AppRegistry.registerComponent(<span class="string">'AwesomeProject'</span>, () =&gt; AwesomeProject);</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°æˆ‘åœ¨ welcome çš„ style ä¸­è®¾ç½®äº†<code>color:&#39;red&#39;</code>ï¼Œè®©æˆ‘çš„<code>Welcome to React Native</code>å˜æˆçº¢è‰²å­—ä½“çš„ã€‚å¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">welcome: &#123;</div><div class="line">  fontSize: <span class="number">20</span>,</div><div class="line">  textAlign: <span class="string">'center'</span>,</div><div class="line">  margin: <span class="number">10</span>,</div><div class="line">  color:<span class="string">'red'</span></div><div class="line">&#125;,</div></pre></td></tr></table></figure></p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥ç†Ÿæ‚‰ä¸€ä¸‹<code>index.android.js</code>è¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„ js ä»£ç éƒ½æ˜¯å¹²ä»€ä¹ˆçš„ã€‚</p>
<p><code>&#39;use strict&#39;</code>æ˜¯å¯åŠ¨å½“å‰æ–‡ä»¶çš„ js ä»£ç çš„ä¸¥æ ¼æ¨¡å¼ï¼Œå¯ä»¥ä½¿å½“å‰çš„ js æ›´ä¸¥æ ¼çš„æ¡ä»¶ä¸‹è¿è¡Œã€‚æƒ³äº†è§£çš„å¯ä»¥å­¦ä¹ è¿™ç¯‡æ–‡ç« <a href="http://www.ruanyifeng.com/blog/2013/01/javascript_strict_mode.html" target="_blank" rel="external">ã€ŠJavascript ä¸¥æ ¼æ¨¡å¼è¯¦è§£ã€‹</a>ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123;</div><div class="line">  AppRegistry,</div><div class="line">  Component,</div><div class="line">  StyleSheet,</div><div class="line">  Text,</div><div class="line">  View,</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</div></pre></td></tr></table></figure></p>
<p>è¿™æ®µä»£ç ç±»ä¼¼ java çš„ importï¼ŒæŠŠéœ€è¦å¼•ç”¨çš„ module å¼•å…¥ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AwesomeProject</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;View style=&#123;styles.container&#125;&gt;</div><div class="line">        &lt;Text style=&#123;styles.welcome&#125;&gt;</div><div class="line">          Welcome to React Native!</div><div class="line">        &lt;<span class="regexp">/Text&gt;</span></div><div class="line"><span class="regexp">        &lt;Text style=&#123;styles.instructions&#125;&gt;</span></div><div class="line"><span class="regexp">          To get started, edit index.android.js</span></div><div class="line"><span class="regexp">        &lt;/</span>Text&gt;</div><div class="line">        &lt;Text style=&#123;styles.instructions&#125;&gt;</div><div class="line">          Shake or press menu button <span class="keyword">for</span> dev menu</div><div class="line">        &lt;<span class="regexp">/Text&gt;</span></div><div class="line"><span class="regexp">      &lt;/</span>View&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™æ®µä»£ç æ˜¯æ¸²æŸ“å½“å‰æ³¨å†Œç•Œé¢çš„å¸ƒå±€ï¼Œ<code>render</code>æ–¹æ³•ä¸‹çš„return å°±æ˜¯è¿”å›çš„å½“å‰å¸ƒå±€ã€‚æ ‡ç­¾å†…çš„ style å¯¹åº”ä¸‹é¢è¿™æ®µä»£ç ï¼Œå’Œ css å¾ˆåƒï¼Œç­‰äº Android layout æ–‡ä»¶ä¸‹ view çš„æ ‡ç­¾è®¾ç½®å±æ€§ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</div><div class="line">  container: &#123;</div><div class="line">    flex: <span class="number">1</span>,</div><div class="line">    justifyContent: <span class="string">'center'</span>,</div><div class="line">    alignItems: <span class="string">'center'</span>,</div><div class="line">    backgroundColor: <span class="string">'#F5FCFF'</span>,</div><div class="line">  &#125;,</div><div class="line">  welcome: &#123;</div><div class="line">    fontSize: <span class="number">20</span>,</div><div class="line">    textAlign: <span class="string">'center'</span>,</div><div class="line">    margin: <span class="number">10</span>,</div><div class="line">    color:<span class="string">'red'</span></div><div class="line">  &#125;,</div><div class="line">  instructions: &#123;</div><div class="line">    textAlign: <span class="string">'center'</span>,</div><div class="line">    color: <span class="string">'#333333'</span>,</div><div class="line">    marginBottom: <span class="number">5</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>æ ‡ç­¾çš„å…·ä½“è§„èŒƒå¯ä»¥çœ‹è¿™é‡Œ<a href="http://facebook.github.io/react-native/docs/text.html#content" target="_blank" rel="external">Text</a>ï¼Œ<a href="http://facebook.github.io/react-native/docs/view.html#content" target="_blank" rel="external">View</a>ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">AppRegistry.registerComponent(<span class="string">'AwesomeProject'</span>, () =&gt; AwesomeProject);</div></pre></td></tr></table></figure></p>
<p>ä¸Šé¢è¿™æ®µä»£ç æŠŠæˆ‘ä»¬ js æ–‡ä»¶ä¸­çš„ class <code>AwesomeProject</code>å’Œæˆ‘ä»¬ Android é¡¹ç›®ä¸­ <code>Activity</code>ä¸­<code>getMainComponentName() { return &quot;AwesomeProject&quot;; }</code>çš„ Activityå…³è”èµ·æ¥ã€‚</p>
<h2 id="äºŒï¼Œæ˜¾ç¤ºä¸€ä¸ª-Toast"><a href="#äºŒï¼Œæ˜¾ç¤ºä¸€ä¸ª-Toast" class="headerlink" title="äºŒï¼Œæ˜¾ç¤ºä¸€ä¸ª Toast"></a>äºŒï¼Œæ˜¾ç¤ºä¸€ä¸ª Toast</h2><p>React-Native å·²ç»æŠŠæˆ‘ä»¬å¸¸ç”¨çš„æ¨¡å—éƒ½å·²ç»å°è£…å¥½äº†ï¼Œä¾‹å¦‚ Toast åœ¨<code>../AwesomeProject/node_modules/react-native/Libraries/Components/ToastAndroid/ToastAndroid.android.js</code>ä¸­ã€‚<br>æˆ‘ä»¬æ¥çœ‹ ToastAndroid çš„æºç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Copyright (c) 2015-present, Facebook, Inc.</span></div><div class="line"><span class="comment"> * All rights reserved.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * This source code is licensed under the BSD-style license found in the</span></div><div class="line"><span class="comment"> * LICENSE file in the root directory of this source tree. An additional grant</span></div><div class="line"><span class="comment"> * of patent rights can be found in the PATENTS file in the same directory.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @providesModule ToastAndroid</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> RCTToastAndroid = <span class="built_in">require</span>(<span class="string">'NativeModules'</span>).ToastAndroid;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * This exposes the native ToastAndroid module as a JS module. This has a function 'show'</span></div><div class="line"><span class="comment"> * which takes the following parameters:</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * 1. String message: A string with the text to toast</span></div><div class="line"><span class="comment"> * 2. int duration: The duration of the toast. May be ToastAndroid.SHORT or ToastAndroid.LONG</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> ToastAndroid = &#123;</div><div class="line"></div><div class="line">  SHORT: RCTToastAndroid.SHORT,</div><div class="line">  LONG: RCTToastAndroid.LONG,</div><div class="line"></div><div class="line">  show: <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></div><div class="line"><span class="function"><span class="params">    message: string,</span></span></div><div class="line"><span class="function"><span class="params">    duration: number</span></span></div><div class="line"><span class="function"><span class="params">  </span>): <span class="title">void</span> </span>&#123;</div><div class="line">    RCTToastAndroid.show(message, duration);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = ToastAndroid;</div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨å¼•åŒ…å½“ä¸­åŠ å…¥ToastAndroidã€‚å¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123;</div><div class="line">  AppRegistry,</div><div class="line">  Component,</div><div class="line">  StyleSheet,</div><div class="line">  Text,</div><div class="line">  ToastAndroid,</div><div class="line">  View,</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</div></pre></td></tr></table></figure></p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥ç”¨ ToastAndroid å¼¹å‡ºä¸€ä¸ª Toastã€‚åœ¨å¼•åŒ…ååŠ å…¥ä»£ç <code>ToastAndroid.show(&#39;Awesome&#39;, ToastAndroid.SHORT);</code>ï¼Œä¸‹é¢æ¥æ‘‡æ‘†æ‰‹æœºè°ƒå‡ºå¼€å‘èœå•ï¼Œç‚¹å‡»<code>Reload JS</code>ã€‚å°±ä¼šå¼¹å‡ºToastã€‚<br>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹<code>ToastAndroid.android.js</code>è¿™ä¸ª moduleã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> RCTToastAndroid = <span class="built_in">require</span>(<span class="string">'NativeModules'</span>).ToastAndroid;</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œæ˜¯<code>require</code>æ˜¯åŠ è½½<code>NativeModules</code>æ¨¡å—ï¼Œå¹¶æŠŠ <code>ToastAndroid</code> èµ‹å€¼ç»™ <code>RCTToastAndroid</code>ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ToastAndroid = &#123;</div><div class="line"></div><div class="line">  SHORT: RCTToastAndroid.SHORT,</div><div class="line">  LONG: RCTToastAndroid.LONG,</div><div class="line"></div><div class="line">  show: <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></div><div class="line"><span class="function"><span class="params">    message: string,</span></span></div><div class="line"><span class="function"><span class="params">    duration: number</span></span></div><div class="line"><span class="function"><span class="params">  </span>): <span class="title">void</span> </span>&#123;</div><div class="line">    RCTToastAndroid.show(message, duration);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>è¿™æ®µä»£ç ï¼Œåˆ›å»ºä¸€ä¸ªå¯¹è±¡èµ‹å€¼ç»™<code>ToastAndroid</code>ï¼Œå¯¹è±¡å†…åˆ†åˆ«è®¾ç½®äº†<code>Toast</code>çš„ <code>SHORT</code>ï¼Œ<code>LONG</code>å’Œ<code>show</code>æ–¹æ³•ã€‚<br><code>module.exports = ToastAndroid;</code>è¿™é‡ŒæŠŠ<code>ToastAndroid</code>ä½œä¸ºå½“å‰è¿™ä¸ª Module å¯¼å‡ºï¼Œæä¾›ç»™å¤–éƒ¨ä½¿ç”¨ã€‚<br>é‚£ä¹ˆ JS æ˜¯å¦‚ä½• Android ä»£ç å…³è”èµ·æ¥çš„å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹Native çš„ä»£ç ã€‚åœ¨ Android Studio ä¸­æœç´¢ç±» <code>ToastModule</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToastModule</span> <span class="keyword">extends</span> <span class="title">ReactContextBaseJavaModule</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DURATION_SHORT_KEY = <span class="string">"SHORT"</span>;</div><div class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DURATION_LONG_KEY = <span class="string">"LONG"</span>;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">ToastModule</span><span class="params">(ReactApplicationContext reactContext)</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>(reactContext);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">"ToastAndroid"</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">getConstants</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">final</span> Map&lt;String, Object&gt; constants = MapBuilder.newHashMap();</div><div class="line">    constants.put(DURATION_SHORT_KEY, Toast.LENGTH_SHORT);</div><div class="line">    constants.put(DURATION_LONG_KEY, Toast.LENGTH_LONG);</div><div class="line">    <span class="keyword">return</span> constants;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="meta">@ReactMethod</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(String message, <span class="keyword">int</span> duration)</span> </span>&#123;</div><div class="line">    Toast.makeText(getReactApplicationContext(), message, duration).show();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œ<code>getName()</code>æ–¹æ³•çš„è¿”å›å€¼å¯¹åº” JS ä¸­çš„<code>var RCTToastAndroid = require(&#39;NativeModules&#39;).ToastAndroid;</code>ç»“å°¾å¤„çš„<code>ToastAndroid</code>ï¼Œæ­£å¦‚ js é‡Œçš„è¯·æ±‚æ‰‹æœºæœ¬åœ°çš„ modules ï¼Œå¯¹åº”åˆ°ç±»é‡Œçš„<code>getName()</code>è¿”å›å€¼ã€‚<br><code>getConstants()</code>æ–¹æ³•è´Ÿè´£æŠŠç±»ä¸­çš„å¸¸é‡æ˜ å°„åˆ° JS ä¸­å»ã€‚<br><code>show(String message, int duration)</code>æ–¹æ³•æ­£æ˜¯æˆ‘ä»¬è¦æä¾›ç»™ JS çš„æ–¹æ³•ï¼Œæ–¹æ³•çš„æ³¨é‡Šä»£è¡¨è¿™ä¸ªæ–¹æ³•æä¾›ç»™ JS è°ƒç”¨ã€‚</p>
<h2 id="ä¸‰ï¼Œè‡ªå®šä¹‰-Logger"><a href="#ä¸‰ï¼Œè‡ªå®šä¹‰-Logger" class="headerlink" title="ä¸‰ï¼Œè‡ªå®šä¹‰ Logger"></a>ä¸‰ï¼Œè‡ªå®šä¹‰ Logger</h2><p>è¿™é‡Œæˆ‘ä»¬æ¥è‡ªå®šä¹‰ä¸€ä¸ª LoggerModule æ¥ç»ƒç»ƒæ‰‹ã€‚è¿™é‡Œæˆ‘å…ˆæŠŠä»£ç è´´å‡ºæ¥äº†ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoggerModule</span> <span class="keyword">extends</span> <span class="title">ReactContextBaseJavaModule</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String MODULE_NAME = <span class="string">"Logger"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG_KEY = <span class="string">"TAG"</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG_VALUE = <span class="string">"LoggerModule"</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LoggerModule</span><span class="params">(ReactApplicationContext reactContext)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(reactContext);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Nullable</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">getConstants</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> Map&lt;String, Object&gt; constants = MapBuilder.newHashMap();</div><div class="line">        constants.put(TAG_KEY, TAG_VALUE);</div><div class="line">        <span class="keyword">return</span> constants;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> MODULE_NAME;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@ReactMethod</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">i</span><span class="params">(String tag, String msg)</span> </span>&#123;</div><div class="line">        Log.i(tag, msg);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@ReactMethod</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">d</span><span class="params">(String tag, String msg)</span> </span>&#123;</div><div class="line">        Log.d(tag, msg);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@ReactMethod</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">w</span><span class="params">(String tag, String msg)</span> </span>&#123;</div><div class="line">        Log.w(tag, msg);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@ReactMethod</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">e</span><span class="params">(String tag, String msg)</span> </span>&#123;</div><div class="line">        Log.e(tag, msg);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œæˆ‘æŠŠå¸¸é‡<code>TAG</code>è¿”å›ç»™ JS è°ƒç”¨ï¼ŒModule å‘½åä¸º<code>Logger</code>ï¼Œå¹¶ä¸”æŠŠ infoï¼Œdebugï¼Œwarnï¼Œerror ç­‰ Log æ–¹æ³•åŠ ä¸Š<code>@ReactMethod</code>æ³¨é‡Šï¼Œæä¾›ç»™ JSè°ƒç”¨ã€‚<br>è¿™é‡Œè¿˜æ²¡æœ‰ç»“æŸï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®ç°ä¸€ä¸ªç±»ï¼Œå»æ³¨å†Œæˆ‘ä»¬è‡ªå·±å†™çš„ <code>LoggerModule</code>ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppReactPackage</span> <span class="keyword">implements</span> <span class="title">ReactPackage</span> </span>&#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;NativeModule&gt; <span class="title">createNativeModules</span><span class="params">(ReactApplicationContext reactContext)</span> </span>&#123;</div><div class="line">        List&lt;NativeModule&gt; modules = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        modules.add(<span class="keyword">new</span> LoggerModule(reactContext));</div><div class="line">        <span class="keyword">return</span> modules;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> List&lt;Class&lt;? extends JavaScriptModule&gt;&gt; createJSModules() &#123;</div><div class="line">        <span class="keyword">return</span> Collections.emptyList();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> List&lt;ViewManager&gt; <span class="title">createViewManagers</span><span class="params">(ReactApplicationContext reactContext)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> Collections.emptyList();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç„¶åï¼ŒæŠŠè¿™ä¸ª AppReactPackage æ³¨å†Œåˆ° Activityã€‚å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">ReactActivity</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * Returns the name of the main component registered from JavaScript.</span></div><div class="line"><span class="comment">     * This is used to schedule rendering of the component.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> String <span class="title">getMainComponentName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"AwesomeProject"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * Returns whether dev mode should be enabled.</span></div><div class="line"><span class="comment">     * This enables e.g. the dev menu.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">getUseDeveloperSupport</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> BuildConfig.DEBUG;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * A list of packages used by the app. If the app uses additional views</span></div><div class="line"><span class="comment">     * or modules besides the default ones, add more packages here.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> List&lt;ReactPackage&gt; <span class="title">getPackages</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> Arrays.&lt;ReactPackage&gt;asList(</div><div class="line">                <span class="keyword">new</span> MainReactPackage(),</div><div class="line">                <span class="keyword">new</span> AppReactPackage()</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>java ä»£ç åˆ°è¿™é‡Œå°±ç»“æŸäº†ã€‚<br>ä¸‹é¢ï¼Œæˆ‘ä»¬åœ¨<code>index.android.js</code>çš„åŒçº§ç›®å½•åˆ›å»ºä¸€ä¸ª js æ–‡ä»¶<code>log.js</code>ã€‚é‡Œé¢å†…å®¹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">var</span> RCTLogger = <span class="built_in">require</span>(<span class="string">'NativeModules'</span>).Logger;<span class="comment">//åŠ è½½æœ¬åœ° modulesï¼ŒModule#getName()</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> LogAndroid = &#123;</div><div class="line">  <span class="comment">//æ·»åŠ å®šä¹‰çš„å¸¸é‡ Module#getConstants()</span></div><div class="line">  TAG: RCTLogger.TAG,</div><div class="line">  <span class="comment">//æ·»åŠ çš„æ–¹æ³• Module#d()</span></div><div class="line">  d: <span class="function"><span class="keyword">function</span>(<span class="params">tag: string,msg: string</span>):<span class="title">void</span></span>&#123;</div><div class="line">    RCTLogger.d(tag,msg);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  i: <span class="function"><span class="keyword">function</span>(<span class="params">tag: string,msg: string</span>):<span class="title">void</span></span>&#123;</div><div class="line">    RCTLogger.i(tag,msg);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  w: <span class="function"><span class="keyword">function</span>(<span class="params">tag: string,msg: string</span>):<span class="title">void</span></span>&#123;</div><div class="line">    RCTLogger.w(tag,msg);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  e: <span class="function"><span class="keyword">function</span>(<span class="params">tag: string,msg: string</span>):<span class="title">void</span></span>&#123;</div><div class="line">    RCTLogger.e(tag,msg);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = LogAndroid;<span class="comment">//module å¯¼å‡º</span></div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œä¸ç”¨å¤šè¯´äº†ï¼Œæ— éå°±æ˜¯åˆ›å»ºä¸€ä¸ª LogAndroid å¯¹è±¡è·å– <code>LoggerModule</code>java ç±»ä¸­çš„å¸¸é‡ï¼Œæ–¹æ³•ç­‰ï¼Œå¹¶ä¸”å¯¼å‡ºã€‚<br>ä¸‹é¢æˆ‘è´´å‡ºå®Œæ•´çš„<code>index.android.js</code>ï¼Œé‡Œé¢æ˜¾ç¤ºå¦‚ä½•å¼•ç”¨ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Sample React Native App</span></div><div class="line"><span class="comment"> * https://github.com/facebook/react-native</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">import</span> React, &#123;</div><div class="line">  AppRegistry,</div><div class="line">  Component,</div><div class="line">  StyleSheet,</div><div class="line">  Text,</div><div class="line">  ToastAndroid,</div><div class="line">  View,</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</div><div class="line"><span class="keyword">var</span> LogAndroid = <span class="built_in">require</span>(<span class="string">'./log'</span>);</div><div class="line"></div><div class="line">LogAndroid.i(LogAndroid.TAG,<span class="string">"Awesome"</span>);</div><div class="line">LogAndroid.d(LogAndroid.TAG,<span class="string">"Awesome"</span>);</div><div class="line">LogAndroid.w(LogAndroid.TAG,<span class="string">"Awesome"</span>);</div><div class="line">LogAndroid.e(LogAndroid.TAG,<span class="string">"Awesome"</span>);</div><div class="line"></div><div class="line">ToastAndroid.show(<span class="string">'Awesome'</span>, ToastAndroid.SHORT);</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AwesomeProject</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;View style=&#123;styles.container&#125;&gt;</div><div class="line">        &lt;Text style=&#123;styles.welcome&#125;&gt;</div><div class="line">          Welcome to React Native!</div><div class="line">        &lt;<span class="regexp">/Text&gt;</span></div><div class="line"><span class="regexp">        &lt;Text style=&#123;styles.instructions&#125;&gt;</span></div><div class="line"><span class="regexp">          To get started, edit index.android.js</span></div><div class="line"><span class="regexp">        &lt;/</span>Text&gt;</div><div class="line">        &lt;Text style=&#123;styles.instructions&#125;&gt;</div><div class="line">          Shake or press menu button <span class="keyword">for</span> dev menu</div><div class="line">        &lt;<span class="regexp">/Text&gt;</span></div><div class="line"><span class="regexp">      &lt;/</span>View&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</div><div class="line">  container: &#123;</div><div class="line">    flex: <span class="number">1</span>,</div><div class="line">    justifyContent: <span class="string">'center'</span>,</div><div class="line">    alignItems: <span class="string">'center'</span>,</div><div class="line">    backgroundColor: <span class="string">'#F5FCFF'</span>,</div><div class="line">  &#125;,</div><div class="line">  welcome: &#123;</div><div class="line">    fontSize: <span class="number">20</span>,</div><div class="line">    textAlign: <span class="string">'center'</span>,</div><div class="line">    margin: <span class="number">10</span>,</div><div class="line">    color:<span class="string">'red'</span></div><div class="line">  &#125;,</div><div class="line">  instructions: &#123;</div><div class="line">    textAlign: <span class="string">'center'</span>,</div><div class="line">    color: <span class="string">'#333333'</span>,</div><div class="line">    marginBottom: <span class="number">5</span>,</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line">AppRegistry.registerComponent(<span class="string">'AwesomeProject'</span>, () =&gt; AwesomeProject);</div></pre></td></tr></table></figure></p>
<p>é‡æ–°ç¼–è¯‘å¹¶è¿è¡Œä½ çš„ appï¼Œçœ‹çœ‹ logcat æ‰“å°å‡ºäº†æ—¥å¿—å—ï¼Ÿ</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é€šè¿‡ä¸Šä¸€ç¯‡&lt;a href=&quot;http://blog.csdn.net/kennethyo/article/details/50923909&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ã€Š React-Native Android å­¦ä¹ ç¬”è®°â€”â€”1ï¼Œé…ç½®ç¯å¢ƒ
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://www.kennethyo.me/tags/Android/"/>
    
      <category term="React-Native" scheme="http://www.kennethyo.me/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>[åŸ]React-Native Android å­¦ä¹ ç¬”è®°â€”â€”1ï¼Œé…ç½®ç¯å¢ƒ</title>
    <link href="http://www.kennethyo.me/2016/03/18/2016-03-18/"/>
    <id>http://www.kennethyo.me/2016/03/18/2016-03-18/</id>
    <published>2016-03-18T07:30:43.000Z</published>
    <updated>2016-09-01T06:37:49.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ï¼Œè®¾å¤‡ä¸ç¯å¢ƒ"><a href="#ä¸€ï¼Œè®¾å¤‡ä¸ç¯å¢ƒ" class="headerlink" title="ä¸€ï¼Œè®¾å¤‡ä¸ç¯å¢ƒ"></a>ä¸€ï¼Œè®¾å¤‡ä¸ç¯å¢ƒ</h2><h3 id="1ï¼Œä¸€å°-mac"><a href="#1ï¼Œä¸€å°-mac" class="headerlink" title="1ï¼Œä¸€å° mac"></a>1ï¼Œä¸€å° mac</h3><h3 id="2ï¼Œå®‰è£…è½¯ä»¶åŒ…ç®¡ç†å™¨-Homebrew-ä¸­æ–‡"><a href="#2ï¼Œå®‰è£…è½¯ä»¶åŒ…ç®¡ç†å™¨-Homebrew-ä¸­æ–‡" class="headerlink" title="2ï¼Œå®‰è£…è½¯ä»¶åŒ…ç®¡ç†å™¨ Homebrew(ä¸­æ–‡)"></a>2ï¼Œå®‰è£…è½¯ä»¶åŒ…ç®¡ç†å™¨ <a href="http://brew.sh/index_zh-cn.html" target="_blank" rel="external">Homebrew(ä¸­æ–‡)</a></h3><p>ç»ˆç«¯é‡Œè¾“å…¥<code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code>è¿›è¡Œå®‰è£…ã€‚</p>
<h3 id="3ï¼Œå®‰è£…-wget-æˆ–è€…-curl"><a href="#3ï¼Œå®‰è£…-wget-æˆ–è€…-curl" class="headerlink" title="3ï¼Œå®‰è£… wget æˆ–è€… curl"></a>3ï¼Œå®‰è£… <a href="https://zh.wikipedia.org/wiki/Wget" target="_blank" rel="external">wget</a> æˆ–è€… <a href="https://zh.wikipedia.org/wiki/CURL" target="_blank" rel="external">curl</a></h3><p>wgetï¼Œç»ˆç«¯é‡Œè¾“å…¥<code>brew install wget</code>è¿›è¡Œå®‰è£…ã€‚<br>curlï¼Œç»ˆç«¯é‡Œè¾“å…¥<code>brew install curl</code>è¿›è¡Œå®‰è£…ã€‚</p>
<h3 id="4ï¼Œå®‰è£…-nvm-nodeç‰ˆæœ¬ç®¡ç†å™¨"><a href="#4ï¼Œå®‰è£…-nvm-nodeç‰ˆæœ¬ç®¡ç†å™¨" class="headerlink" title="4ï¼Œå®‰è£… nvm (nodeç‰ˆæœ¬ç®¡ç†å™¨)"></a>4ï¼Œå®‰è£… <a href="https://github.com/creationix/nvm#installation" target="_blank" rel="external">nvm</a> (nodeç‰ˆæœ¬ç®¡ç†å™¨)</h3><p>å¦‚æœå®‰è£…äº† wgetï¼Œç»ˆç«¯è¾“å…¥<code>wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash</code>è¿›è¡Œå®‰è£… nvmã€‚</p>
<p>å¦‚æœå®‰è£…äº† curlï¼Œç»ˆç«¯è¾“å…¥<code>curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bashÃ‚</code>è¿›è¡Œå®‰è£… nvmã€‚</p>
<h3 id="5ï¼ŒAndroid-SDK"><a href="#5ï¼ŒAndroid-SDK" class="headerlink" title="5ï¼ŒAndroid SDK"></a>5ï¼ŒAndroid SDK</h3><p>è¿™ä¸ªä¸ç”¨å¤šè¯´äº†ï¼Œç›¸ä¿¡å¤§å®¶éƒ½ä¼šçš„ã€‚é¡ºä¾¿æŠŠ Android SDK é…ç½®åˆ°ç¯å¢ƒå˜é‡ã€‚</p>
<p>å¦‚æœä½ æ²¡æœ‰ Android SDKï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç»ˆç«¯è¾“å…¥<code>brew install android-sdk</code>ã€‚</p>
<h2 id="äºŒï¼Œå®‰è£…å’Œåˆå§‹react-native-demo"><a href="#äºŒï¼Œå®‰è£…å’Œåˆå§‹react-native-demo" class="headerlink" title="äºŒï¼Œå®‰è£…å’Œåˆå§‹react-native demo"></a>äºŒï¼Œå®‰è£…å’Œåˆå§‹react-native demo</h2><p>ç»ˆç«¯è¾“å…¥<code>npm install -g react-native-cli</code>å®‰è£… react-nativeã€‚</p>
<p>å¦‚æœæ˜¾ç¤º<code>EACCES: permission denied</code>ï¼Œç”¨è¶…çº§æƒé™å†æ¬¡æ‰§è¡Œä¸€ä¸‹ä¸Šé¢çš„æŒ‡ä»¤ã€‚åæ­£æˆ‘æ˜¯æ²¡é‡åˆ°ã€‚</p>
<p>è¿›å…¥åˆ°ä½ è¦åˆ›å»º demo çš„ç›®å½•ï¼Œç»ˆç«¯è¾“å…¥<code>cd ä½ å¾—æ–‡ä»¶è·¯å¾„</code>.<br>ç»ˆç«¯è¾“å…¥<code>react-native init AwesomeProject</code>ï¼Œåˆå§‹ AwesomeProject ã€‚</p>
<p>ç»ˆç«¯è¾“å…¥<code>cd AwesomeProject</code>ã€‚</p>
<p>ç»ˆç«¯è¾“å…¥<code>react-native run-android</code>å¯ä»¥ç›´æ¥è¿è¡Œ node æœåŠ¡å¹¶ç¼–è¯‘è¿è¡Œ Android é¡¹ç›®ï¼Œç›´è‡³å®‰è£…åˆ°æ‰‹æœºã€‚</p>
<p>å¦‚æœç•Œé¢æŠ¥é”™æç¤ºå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">Unable to download JS bundle</div><div class="line">com.facebook.react.devsupport.DebugServerException: Could not connect to development server.</div><div class="line"></div><div class="line">URL: http://localhost:8081/index.android.bundle?platform=android&amp;dev=true&amp;hot=false</div><div class="line"></div><div class="line">Try the following to fix the issue:</div><div class="line">â€¢ Ensure that the packager server is running</div><div class="line">â€¢ Ensure that your device/emulator is connected to your machine and has USB debugging enabled - run &apos;adb devices&apos; to see a list of connected devices</div><div class="line">â€¢ If you&apos;re on a physical device connected to the same machine, run &apos;adb reverse tcp:8081 tcp:8081&apos; to forward requests from your device</div><div class="line">â€¢ If your device is on the same Wi-Fi network, set &apos;Debug server host &amp; port for device&apos; in &apos;Dev settings&apos; to your machine&apos;s IP address and the port of the local dev server - e.g. 10.0.1.1:8081</div><div class="line">at com.facebook.react.devsupport.DevServerHelper$1.onFailure(DevServerHelper.java:203)</div><div class="line">at com.squareup.okhttp.Call$AsyncCall.execute(Call.java:175)</div><div class="line">at com.squareup.okhttp.internal.NamedRunnable.run(NamedRunnable.java:33)</div><div class="line">at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1113)</div><div class="line">at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:588)</div><div class="line">at java.lang.Thread.run(Thread.java:818)</div></pre></td></tr></table></figure></p>
<p>ä¸€èˆ¬åœ¨ç»ˆç«¯è¾“å…¥<code>adb reverse tcp:8081 tcp:8081</code>å³å¯è§£å†³ï¼Œå…¶ä»–è¯·è¯¦ç»†çœ‹ logã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä¸€ï¼Œè®¾å¤‡ä¸ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ä¸€ï¼Œè®¾å¤‡ä¸ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ï¼Œè®¾å¤‡ä¸ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ä¸€ï¼Œè®¾å¤‡ä¸ç¯å¢ƒ&lt;/h2&gt;&lt;h3 id=&quot;1ï¼Œä¸€å°-mac&quot;&gt;&lt;a href=&quot;#1ï¼Œä¸€å°-mac&quot; class=&quot;headerli
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://www.kennethyo.me/tags/Android/"/>
    
      <category term="React-Native" scheme="http://www.kennethyo.me/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>[åŸ]Android è‡ªå®šä¹‰å­—ä½“ï¼Œå­—æ›¿æ¢ä¸ºå›¾ç‰‡</title>
    <link href="http://www.kennethyo.me/2015/12/03/2015-12-03/"/>
    <id>http://www.kennethyo.me/2015/12/03/2015-12-03/</id>
    <published>2015-12-03T05:54:59.000Z</published>
    <updated>2016-09-01T06:38:06.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸ä¹…å‰å¼€å‘çš„ç‰ˆæœ¬ä¸­æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼Œæ ¹æ®æœåŠ¡å™¨è¿”å›çš„åˆ†æ•°ï¼Œæ˜¾ç¤ºåˆ†æ•°ï¼Œå„ä½å¯èƒ½è§‰å¾—è¿™æœ‰ä»€ä¹ˆå‘¢ï¼Ÿé‚£ä¹ˆè¯·çœ‹ä¸‹å›¾ã€‚<br><img src="http://img.blog.csdn.net/20151203113652497" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"><br><img src="http://img.blog.csdn.net/20151203113712189" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"><br><img src="http://img.blog.csdn.net/20151203113725790" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"><br><img src="http://img.blog.csdn.net/20151203113742294" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>æ²¡é”™ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„éœ€æ±‚ã€‚</p>
<hr>
<p>####æ€è·¯ä¸€ï¼Œ<br>æ·»åŠ å­—ä½“åº“ï¼Œé€šè¿‡è®¾ç½® TextViewï¼Œåœ¨åˆå§‹åŒ–çš„æ—¶å€™è®¾ç½®æˆ‘ä»¬çš„å­—ä½“ã€‚ä¾‹å¦‚ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">TextView textView = (TextView) findViewById(R.id.custom);</div><div class="line"><span class="comment">// å°†å­—ä½“æ–‡ä»¶ä¿å­˜åœ¨assets/fonts/ç›®å½•ä¸‹</span></div><div class="line">Typeface typeFace =  Typeface.createFromAsset(getAssets(),<span class="string">"fonts/your_font_name.ttf"</span>);</div><div class="line"><span class="comment">// åº”ç”¨å­—ä½“</span></div><div class="line">textView.setTypeface(typeFace);</div></pre></td></tr></table></figure></p>
<p>####æ€è·¯äºŒï¼Œ<br>é€šè¿‡ è‡ªå®šä¹‰ Viewï¼Œæ ¹æ®åˆ†æ•°ç®—å‡ºæ¯ä¸ªå­—çš„ä½ç½®ï¼Œé€šè¿‡canvas ç”»å‡ºã€‚é€šè¿‡å¦‚ä¸‹æ–¹æ³•ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">canvas.drawBitmap(<span class="meta">@NonNull</span> Bitmap bitmap, <span class="keyword">float</span> left, <span class="keyword">float</span> top, <span class="meta">@Nullable</span> Paint paint)</div></pre></td></tr></table></figure></p>
<hr>
<p>####è§£å†³æ–¹æ¡ˆï¼š<br>æŒ‰ç…§ä¸Šé¢çš„æ€è·¯ï¼Œæˆ‘ç›´æ¥å»æ‰¾è®¾è®¡å¦¹å­ï¼Œè¯´èƒ½ç»™æˆ‘åšæˆå­—ä½“åº“å—ï¼Ÿç„¶åæˆ‘å°±è¢«æŠ“æˆåœŸè±†ä¸äº†ã€‚å›æ¥æˆ‘è‡ªå·±äº†è§£äº†ä¸€ä¸‹åšå­—ä½“åº“ï¼Œé€šè¿‡äº†è§£ï¼Œä¸ºè¿™å‡ ä¸ªå­—ï¼ˆ0ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼Œ7ï¼Œ8ï¼Œ9ï¼Œåˆ†ï¼Œ@#%ä½œä¸ºä¸€ä¸ªå­—ï¼‰ï¼Œåšå­—ä½“åº“æ˜¾ç„¶æˆæœ¬æ¯”è¾ƒå¤§ã€‚</p>
<p>æ€è·¯ä¸€ä¸è¡Œï¼Œå°±æ€è·¯äºŒå§ã€‚æ€è·¯éº»çƒ¦åœ¨äºï¼Œè¦åˆ†åˆ«å¤„ç†ï¼Œä¸¤ä¸ªå­—ï¼ˆ0åˆ†ï¼‰ï¼Œä¸‰ä¸ªå­—ï¼ˆ60åˆ†ï¼‰ï¼Œå››ä¸ªå­—ï¼ˆ100åˆ†ï¼‰å’Œ@#%ï¼Œå››ç§æƒ…å†µã€‚</p>
<p>åˆ†æ¸…äº†å‡ ç§çŠ¶æ€ï¼Œå°±å¯ä»¥å¼€å§‹ç€æ‰‹å¼€å‘äº†ï¼Œå°±åœ¨è¿™æ—¶ï¼Œè¿™æ—¶ï¼Œæˆ‘æƒ³åˆ°ï¼Œè¿™ä¸ªï¼Œè¿™ä¸ªï¼Œä¸å°±å’Œå¹´åˆçœ‹çš„ emoji è¡¨æƒ…æ˜¯ä¸€ä¸ªæ„æ€å—ï¼Œåªä¸è¿‡æ¢æˆæˆ‘è‡ªå·±çš„è¡¨æƒ…è€Œå·²ã€‚</p>
<p>å¹´åˆçœ‹çš„ emoji è¡¨æƒ…ï¼Œæ˜¯ <a href="https://github.com/rockerhieu/emojicon" target="_blank" rel="external">github ä¸Šçš„ä¸€ä¸ªé¡¹ç›®</a>ï¼Œå…¶ä¸»è¦åŸç†æ˜¯ï¼Œé€šè¿‡åˆ¤æ–­å­—ç¬¦æ¥æ›¿æ¢ç›¸åº”çš„å­—ç¬¦ç ä¸º emoji å›¾ç‰‡ã€‚</p>
<p>è¿™æ˜¯è‡ªå®šä¹‰çš„ TextView<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FaceRateTextView</span> <span class="keyword">extends</span> <span class="title">TextView</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FaceRateTextView</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context);</div><div class="line">        init();</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FaceRateTextView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs);</div><div class="line">        init();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FaceRateTextView</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</div><div class="line">        init();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (!TextUtils.isEmpty(getText())) &#123;</div><div class="line">            setText(getText());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setText</span><span class="params">(CharSequence text, BufferType type)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (!TextUtils.isEmpty(text)) &#123;</div><div class="line">            SpannableStringBuilder builder = <span class="keyword">new</span> SpannableStringBuilder(text);</div><div class="line">            FontsHandler.addFonts(getContext(), builder, (<span class="keyword">int</span>) getTextSize(), (<span class="keyword">int</span>) getTextSize());</div><div class="line">            text = builder;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">super</span>.setText(text, type);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>FontsHandlerï¼Œæ˜¯é€šè¿‡æ­£åˆ™åˆ¤æ–­å­—ç¬¦ä¸²å½“ä¸­æœ‰æ²¡æœ‰è¦æ›¿æ¢çš„å­—ç¬¦ï¼Œå¹¶ä¸”æ›¿æ¢ä¸º DynamicDrawableSpanã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FontsHandler</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String, Integer&gt; mFonts = <span class="keyword">new</span> HashMap&lt;&gt;(<span class="number">12</span>);</div><div class="line"></div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        mFonts.put(<span class="string">"åˆ†"</span>, R.drawable.ic_face_rate);</div><div class="line">        mFonts.put(<span class="string">"0"</span>, R.drawable.ic_face_rate_0);</div><div class="line">        mFonts.put(<span class="string">"1"</span>, R.drawable.ic_face_rate_1);</div><div class="line">        mFonts.put(<span class="string">"2"</span>, R.drawable.ic_face_rate_2);</div><div class="line">        mFonts.put(<span class="string">"3"</span>, R.drawable.ic_face_rate_3);</div><div class="line">        mFonts.put(<span class="string">"4"</span>, R.drawable.ic_face_rate_4);</div><div class="line">        mFonts.put(<span class="string">"5"</span>, R.drawable.ic_face_rate_5);</div><div class="line">        mFonts.put(<span class="string">"6"</span>, R.drawable.ic_face_rate_6);</div><div class="line">        mFonts.put(<span class="string">"7"</span>, R.drawable.ic_face_rate_7);</div><div class="line">        mFonts.put(<span class="string">"8"</span>, R.drawable.ic_face_rate_8);</div><div class="line">        mFonts.put(<span class="string">"9"</span>, R.drawable.ic_face_rate_9);</div><div class="line">        mFonts.put(<span class="string">"balala"</span>, R.drawable.ic_face_rate_balala);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">addFonts</span><span class="params">(Context context, Spannable spannable, <span class="keyword">int</span> size, <span class="keyword">int</span> textSize)</span> </span>&#123;</div><div class="line">        <span class="keyword">boolean</span> hasChanges = <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Integer&gt; entry : mFonts.entrySet()) &#123;</div><div class="line">            String key = entry.getKey();</div><div class="line">            Matcher matcher = Pattern.compile(Pattern.quote(key)).matcher(spannable);</div><div class="line">            <span class="keyword">while</span> (matcher.find()) &#123;</div><div class="line">                <span class="keyword">boolean</span> set = <span class="keyword">true</span>;</div><div class="line">                <span class="keyword">for</span> (FontsSpan span : spannable.getSpans(matcher.start(),</div><div class="line">                        matcher.end(), FontsSpan.class))</div><div class="line">                    <span class="keyword">if</span> (spannable.getSpanStart(span) &gt;= matcher.start()</div><div class="line">                            &amp;&amp; spannable.getSpanEnd(span) &lt;= matcher.end())</div><div class="line">                        spannable.removeSpan(span);</div><div class="line">                    <span class="keyword">else</span> &#123;</div><div class="line">                        set = <span class="keyword">false</span>;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                <span class="keyword">if</span> (set) &#123;</div><div class="line">                    hasChanges = <span class="keyword">true</span>;</div><div class="line">                    spannable.setSpan(<span class="keyword">new</span> FontsSpan(context, entry.getValue(), size, textSize),</div><div class="line">                            matcher.start(), matcher.end(),</div><div class="line">                            Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> hasChanges;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>FontsSpan ç»§æ‰¿äºDynamicDrawableSpanï¼Œä¸»è¦å®ç°æ›¿æ¢å­—ç¬¦ä¸º drawableã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FontsSpan</span> <span class="keyword">extends</span> <span class="title">DynamicDrawableSpan</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Context mContext;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mResourceId;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mSize;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> mTextSize;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mHeight;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mWidth;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mTop;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Drawable mDrawable;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> WeakReference&lt;Drawable&gt; mDrawableRef;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FontsSpan</span><span class="params">(Context context, <span class="keyword">int</span> resourceId, <span class="keyword">int</span> size, <span class="keyword">int</span> textSize)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(DynamicDrawableSpan.ALIGN_BASELINE);</div><div class="line">        mContext = context;</div><div class="line">        mResourceId = resourceId;</div><div class="line">        mWidth = mHeight = mSize = size;</div><div class="line">        mTextSize = textSize;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Drawable <span class="title">getDrawable</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (mDrawable == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                mDrawable = mContext.getResources().getDrawable(mResourceId);</div><div class="line">                mHeight = mSize;</div><div class="line">                mWidth = mHeight * mDrawable.getIntrinsicWidth() / mDrawable.getIntrinsicHeight();</div><div class="line">                mTop = (mTextSize - mHeight) / <span class="number">2</span>;</div><div class="line">                mDrawable.setBounds(<span class="number">0</span>, mTop, mWidth, mTop + mHeight);</div><div class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">                <span class="comment">// swallow</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> mDrawable;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">(Canvas canvas, CharSequence text, <span class="keyword">int</span> start, <span class="keyword">int</span> end, <span class="keyword">float</span> x, <span class="keyword">int</span> top, <span class="keyword">int</span> y, <span class="keyword">int</span> bottom, Paint paint)</span> </span>&#123;</div><div class="line">        <span class="comment">//super.draw(canvas, text, start, end, x, top, y, bottom, paint);</span></div><div class="line">        Drawable b = getCachedDrawable();</div><div class="line">        canvas.save();</div><div class="line"></div><div class="line">        <span class="keyword">int</span> transY = bottom - b.getBounds().bottom;</div><div class="line">        <span class="keyword">if</span> (mVerticalAlignment == ALIGN_BASELINE) &#123;</div><div class="line">            transY = top + ((bottom - top) / <span class="number">2</span>) - ((b.getBounds().bottom - b.getBounds().top) / <span class="number">2</span>) - mTop;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        canvas.translate(x, transY);</div><div class="line">        b.draw(canvas);</div><div class="line">        canvas.restore();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> Drawable <span class="title">getCachedDrawable</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (mDrawableRef == <span class="keyword">null</span> || mDrawableRef.get() == <span class="keyword">null</span>) &#123;</div><div class="line">            mDrawableRef = <span class="keyword">new</span> WeakReference&lt;Drawable&gt;(getDrawable());</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> mDrawableRef.get();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å…¶å®åŸç†å¾ˆç®€å•ï¼Œå¹¶ä¸å¤æ‚ã€‚<br><a href="https://github.com/KennethYo/ScanNeedleDemo" target="_blank" rel="external">demoä»£ç åœ°å€</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸ä¹…å‰å¼€å‘çš„ç‰ˆæœ¬ä¸­æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼Œæ ¹æ®æœåŠ¡å™¨è¿”å›çš„åˆ†æ•°ï¼Œæ˜¾ç¤ºåˆ†æ•°ï¼Œå„ä½å¯èƒ½è§‰å¾—è¿™æœ‰ä»€ä¹ˆå‘¢ï¼Ÿé‚£ä¹ˆè¯·çœ‹ä¸‹å›¾ã€‚&lt;br&gt;&lt;img src=&quot;http://img.blog.csdn.net/20151203113652497&quot; alt=&quot;è¿™é‡Œå†™å›¾ç‰‡æè¿°&quot;&gt;&lt;br&gt;&lt;img src=
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://www.kennethyo.me/tags/Android/"/>
    
      <category term="View" scheme="http://www.kennethyo.me/tags/View/"/>
    
  </entry>
  
  <entry>
    <title>[åŸ]Android ç¿»è½¬åŠ¨ç”» Rotate3dAnimation æ•ˆæœ</title>
    <link href="http://www.kennethyo.me/2015/10/16/2015-10-16/"/>
    <id>http://www.kennethyo.me/2015/10/16/2015-10-16/</id>
    <published>2015-10-16T09:05:57.000Z</published>
    <updated>2016-09-01T06:38:25.000Z</updated>
    
    <content type="html"><![CDATA[<p>åä¸€å‰è¯·äº†ä¸€å¤©å‡ï¼Œåé¢è¯·äº†ä¸‰å¤©å‡ï¼Œä¸²èµ·æ¥ä¸€å…±ä¼‘æ¯äº†åäºŒå¤©ï¼Œè¿™æœŸé—´è§äº†å¥³æœ‹å‹çš„å®¶é•¿ï¼Œä¹Ÿé¢†å¥³æœ‹å‹è§äº†æˆ‘å®¶é•¿ï¼Œå¥½æ¶ˆæ¯æ˜¯å„æ–¹å®¶é•¿åé¦ˆä¸é”™ï¼Œåæ¶ˆæ¯æ˜¯æ¶¨äº†äº”æ–¤è‚‰ï¼Œæ¯•ç«Ÿæ˜¯åƒäº†12å¤©çš„å‘¼ä¼¦è´å„¿ç‰›ç¾Šè‚‰å“ˆã€‚ç©äº†è¿™ä¹ˆå¤šå¤©ï¼Œå›æ¥è¦æ”¶æ”¶å¿ƒå¥½å¥½å·¥ä½œäº†ï¼Œæ¯•ç«Ÿè¦æ”’é’±å¨¶åª³å¦‡å“ˆ~</p>
<hr>
<p>ä¸Šç­å›æ¥ï¼ŒæŒ‰ç…§äº§å“çš„éœ€æ±‚åšäº†è¿™æ ·ä¸€ä¸ªæ•ˆæœï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://img.blog.csdn.net/20151016162517318" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>è¿™å…¶ä¸­åŒ…å«äº†3ä¸ªåŠ¨ç”»ï¼Œåˆ†åˆ«æ˜¯ç§»åŠ¨åŠ¨ç”»ã€æ”¾å¤§åŠ¨ç”»ã€æ—‹è½¬åŠ¨ç”»ã€‚</p>
<p>å‰ä¸¤ä¸ªåŠ¨ç”»æ¯”è¾ƒå¥½å®Œæˆï¼Œå¯ä»¥ç”¨ TranslateAnimation å’Œ ScaleAnimationæ¥å®Œæˆï¼Œä½†æ˜¯ç¬¬ä¸‰ä¸ªå°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œå› ä¸ºè¿™ä¸ªæ—‹è½¬åŠ¨ç”»æ˜¯æ ¹æ® Y è½´æ¥æ—‹è½¬çš„ï¼Œè€Œ RotateAnimation æ˜¯æ ¹æ®å‚ç›´å±å¹•çš„ Z è½´æ—‹è½¬çš„ï¼Œæ‰€ä»¥ RotateAnimation å¹¶ä¸èƒ½å¤Ÿå®Œæˆæˆ‘ä»¬éœ€è¦çš„æ•ˆæœï¼Œè¿™é‡Œå°±éœ€è¦æˆ‘ä»¬å»ç»§æ‰¿ Animation å»è‡ªå®šä¹‰åŠ¨ç”»äº†ã€‚</p>
<p>ä½†æ˜¯ï¼ï¼ï¼<br>ä½†æ˜¯ APIdemo é‡Œé¢å·²ç»å®ç°äº†è¿™ä¸ªåŠ¨ç”»ï¼Œsoï¼Œæˆ‘ä»¬æ‹¿æ¥ç”¨å°±å¥½äº†ï¼Œä¸‹é¢æ˜¯æˆ‘è´´å‡ºæ¥çš„Rotate3dAnimationï¼Œå…¶ä¸­æˆ‘æ·»åŠ äº†ä¸€ä¸ªæ„é€ ï¼Œæ·»åŠ äº†ç›¸å¯¹è‡ªå·±ä½ç½®çš„ typeã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cn.kenneth.rotate3danimation;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.graphics.Camera;</div><div class="line"><span class="keyword">import</span> android.graphics.Matrix;</div><div class="line"><span class="keyword">import</span> android.view.animation.Animation;</div><div class="line"><span class="keyword">import</span> android.view.animation.Transformation;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rotate3dAnimation</span> <span class="keyword">extends</span> <span class="title">Animation</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mCenterXType = ABSOLUTE;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mCenterYType = ABSOLUTE;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">float</span> mFromDegrees;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">float</span> mToDegrees;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mCenterX;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">float</span> mCenterY;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">float</span> mDepthZ;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">boolean</span> mReverse;</div><div class="line">    <span class="keyword">private</span> Camera mCamera;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * Creates a new 3D rotation on the Y axis. The rotation is defined by its</span></div><div class="line"><span class="comment">     * start angle and its end angle. Both angles are in degrees. The rotation</span></div><div class="line"><span class="comment">     * is performed around a center point on the 2D space, definied by a pair</span></div><div class="line"><span class="comment">     * of X and Y coordinates, called centerX and centerY. When the animation</span></div><div class="line"><span class="comment">     * starts, a translation on the Z axis (depth) is performed. The length</span></div><div class="line"><span class="comment">     * of the translation can be specified, as well as whether the translation</span></div><div class="line"><span class="comment">     * should be reversed in time.</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> fromDegrees the start angle of the 3D rotation</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> toDegrees   the end angle of the 3D rotation</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> centerX     the X center of the 3D rotation</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> centerY     the Y center of the 3D rotation</span></div><div class="line"><span class="comment">     * <span class="doctag">@param</span> reverse     true if the translation should be reversed, false otherwise</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Rotate3dAnimation</span><span class="params">(<span class="keyword">float</span> fromDegrees, <span class="keyword">float</span> toDegrees,</span></span></div><div class="line"><span class="function"><span class="params">                             <span class="keyword">float</span> centerX, <span class="keyword">float</span> centerY, <span class="keyword">float</span> depthZ, <span class="keyword">boolean</span> reverse)</span> </span>&#123;</div><div class="line">        mFromDegrees = fromDegrees;</div><div class="line">        mToDegrees = toDegrees;</div><div class="line">        mCenterX = centerX;</div><div class="line">        mCenterY = centerY;</div><div class="line">        mDepthZ = depthZ;</div><div class="line">        mReverse = reverse;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Rotate3dAnimation</span><span class="params">(<span class="keyword">float</span> fromDegrees, <span class="keyword">float</span> toDegrees,</span></span></div><div class="line"><span class="function"><span class="params">                             <span class="keyword">int</span> centerXType, <span class="keyword">float</span> centerX, <span class="keyword">int</span> centerYType, <span class="keyword">float</span> centerY, <span class="keyword">float</span> depthZ, <span class="keyword">boolean</span> reverse)</span> </span>&#123;</div><div class="line">        mFromDegrees = fromDegrees;</div><div class="line">        mToDegrees = toDegrees;</div><div class="line">        mCenterXType = centerXType;</div><div class="line">        mCenterX = centerX;</div><div class="line">        mCenterYType = centerYType;</div><div class="line">        mCenterY = centerY;</div><div class="line">        mDepthZ = depthZ;</div><div class="line">        mReverse = reverse;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">(<span class="keyword">int</span> width, <span class="keyword">int</span> height, <span class="keyword">int</span> parentWidth, <span class="keyword">int</span> parentHeight)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.initialize(width, height, parentWidth, parentHeight);</div><div class="line">        mCamera = <span class="keyword">new</span> Camera();</div><div class="line">        mCenterX = resolveSize(mCenterXType, mCenterX, width, parentWidth);</div><div class="line">        mCenterY = resolveSize(mCenterYType, mCenterY, height, parentHeight);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">applyTransformation</span><span class="params">(<span class="keyword">float</span> interpolatedTime, Transformation t)</span> </span>&#123;</div><div class="line">        <span class="keyword">final</span> <span class="keyword">float</span> fromDegrees = mFromDegrees;</div><div class="line">        <span class="keyword">float</span> degrees = fromDegrees + ((mToDegrees - fromDegrees) * interpolatedTime);</div><div class="line"></div><div class="line">        <span class="keyword">final</span> <span class="keyword">float</span> centerX = mCenterX;</div><div class="line">        <span class="keyword">final</span> <span class="keyword">float</span> centerY = mCenterY;</div><div class="line">        <span class="keyword">final</span> Camera camera = mCamera;</div><div class="line"></div><div class="line">        <span class="keyword">final</span> Matrix matrix = t.getMatrix();</div><div class="line"></div><div class="line">        camera.save();</div><div class="line">        <span class="keyword">if</span> (mReverse) &#123;</div><div class="line">            camera.translate(<span class="number">0.0f</span>, <span class="number">0.0f</span>, mDepthZ * interpolatedTime);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            camera.translate(<span class="number">0.0f</span>, <span class="number">0.0f</span>, mDepthZ * (<span class="number">1.0f</span> - interpolatedTime));</div><div class="line">        &#125;</div><div class="line">        camera.rotateY(degrees);</div><div class="line">        camera.getMatrix(matrix);</div><div class="line">        camera.restore();</div><div class="line"></div><div class="line">        matrix.preTranslate(-centerX, -centerY);</div><div class="line">        matrix.postTranslate(centerX, centerY);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç§»åŠ¨åŠ¨ç”»ä¹Ÿæ¯”è¾ƒå¥½åšï¼Œç‚¹å‡»çš„æ—¶å€™è®°å½•ç‚¹å‡» icon åœ¨ window ä¸Šçš„ä½ç½®ï¼Œç„¶åä¼ åˆ°ä¸‹ä¸€ä¸ªç•Œé¢ï¼Œè®¡ç®—ä¸€ä¸‹åç§»é‡ã€‚</p>
<p>è¿™é‡Œé¢è¦æ³¨æ„ï¼Œé‡Œé¢çš„ weibo ç­‰ iconï¼Œæˆ‘ç”¨çš„å¹¶ä¸æ˜¯å›¾ç‰‡ï¼Œç”¨çš„æ˜¯FontAwesomeï¼Œå…·ä½“ç”¨æ³•çœ‹ä¸‹é¢åšå®¢ï¼š<br>ä¸­æ–‡åœ°å€ï¼š<a href="http://mp.weixin.qq.com/s?__biz=MjM5NDAxNTY4MA==&amp;mid=208795106&amp;idx=1&amp;sn=7745289b193dc8ff20ba81ff9bb23b21&amp;scene=1&amp;srcid=1016s8Satc5ZO0gDrVLqVIBM&amp;key=b410d3164f5f798e7ec8a5a17847eeddc1247303cf5fe40ac8a564295602dd6161bb83fa346de7cd9878b60274b20e77&amp;ascene=0&amp;uin=MTAxNzk0OTM1&amp;devicetype=iMac+MacBookPro11%2C1+OSX+OSX+10.11+build(15A284" target="_blank" rel="external">ä¼ é€é—¨</a>&amp;version=11020201&amp;pass_ticket=WHgV251%2BEh%2Bkh7UMBqQp034b8MGYzxeoJ7l9Ncwz3iE%3D)<br>é¡¹ç›®ç½‘ç«™ï¼š<a href="http://fortawesome.github.io/Font-Awesome/" target="_blank" rel="external">ä¼ é€é—¨</a></p>
<p>demo ä»£ç åœ°å€ï¼š<a href="https://github.com/KennethYo/Rotate3dAnimation" target="_blank" rel="external">ä¼ é€é—¨</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åä¸€å‰è¯·äº†ä¸€å¤©å‡ï¼Œåé¢è¯·äº†ä¸‰å¤©å‡ï¼Œä¸²èµ·æ¥ä¸€å…±ä¼‘æ¯äº†åäºŒå¤©ï¼Œè¿™æœŸé—´è§äº†å¥³æœ‹å‹çš„å®¶é•¿ï¼Œä¹Ÿé¢†å¥³æœ‹å‹è§äº†æˆ‘å®¶é•¿ï¼Œå¥½æ¶ˆæ¯æ˜¯å„æ–¹å®¶é•¿åé¦ˆä¸é”™ï¼Œåæ¶ˆæ¯æ˜¯æ¶¨äº†äº”æ–¤è‚‰ï¼Œæ¯•ç«Ÿæ˜¯åƒäº†12å¤©çš„å‘¼ä¼¦è´å„¿ç‰›ç¾Šè‚‰å“ˆã€‚ç©äº†è¿™ä¹ˆå¤šå¤©ï¼Œå›æ¥è¦æ”¶æ”¶å¿ƒå¥½å¥½å·¥ä½œäº†ï¼Œæ¯•ç«Ÿè¦æ”’é’±å¨¶åª³å¦‡å“ˆ~&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;ä¸Šç­
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://www.kennethyo.me/tags/Android/"/>
    
      <category term="Animation" scheme="http://www.kennethyo.me/tags/Animation/"/>
    
  </entry>
  
  <entry>
    <title>[åŸ]Android å¯æ‹–æ‹½ GridView å¹¶ä¸”å®æ—¶åˆ‡æ¢å’Œæ‹–åŠ¨åˆ°ä¸‹éƒ¨åˆ é™¤</title>
    <link href="http://www.kennethyo.me/2015/09/29/2015-09-29/"/>
    <id>http://www.kennethyo.me/2015/09/29/2015-09-29/</id>
    <published>2015-09-29T07:22:08.000Z</published>
    <updated>2016-09-01T06:39:45.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å…¬å¸åšäº†ä¸€ä¸ªè¿™æ ·çš„éœ€æ±‚ï¼Œæ‹–åŠ¨GridView ä¸­çš„ item åˆ°æŒ‡å®šåŒºåŸŸåˆ é™¤ï¼Œå…·ä½“æ•ˆæœï¼Œè¯·çœ‹ä¸‹é¢çš„åŠ¨å›¾ã€‚<br><img src="http://img.blog.csdn.net/20150929150020321" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>æ‹–åŠ¨æ•ˆæœæ˜¯é€šè¿‡éšè— GridViewä¸­è¢«é€‰ä¸­çš„ itemï¼Œå¹¶ä¸”åŒæ—¶åœ¨ Window ä¸Šæ³¨å†Œä¸€ä¸ª View æ¥å®ç°ï¼Œå…·ä½“é€»è¾‘å’Œä»£ç ï¼Œè¯·å‚ç…§è¿™ç¯‡åšå®¢<a href="http://blog.csdn.net/xiaanming/article/details/17718579ã€‚" target="_blank" rel="external">http://blog.csdn.net/xiaanming/article/details/17718579ã€‚</a></p>
<p>æˆ‘çš„éœ€æ±‚å½“ä¸­ï¼Œå¤šäº†ä¸€ä¸ªæ‹–åŠ¨åˆ°åº•éƒ¨åŒºåŸŸç¼©å°å¹¶ä¸”åˆ é™¤ã€‚</p>
<p>è€ƒè™‘åˆ°ä» GridView ä¸­æ‹–åŠ¨ä¸€ä¸ª item åˆ°å¦ä¸€ä¸ª View ä¸­ï¼Œå¹¶ä¸”åˆ é™¤ï¼Œåªåœ¨ GridView å½“ä¸­è¿›è¡Œç»˜åˆ¶è¢«æ‹–åŠ¨çš„ item è‚¯å®šæ˜¯è¾¾ä¸åˆ°è¿›å…¥å¦ä¸€ä¸ª view çš„æ•ˆæœï¼Œå³ä½¿åšèµ·æ¥ä¹Ÿæ˜¯ç›¸å½“éº»çƒ¦çš„ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨ GridView å’Œåˆ é™¤åŒºåŸŸçš„ä¸Šä¸€å±‚ View å½“ä¸­è¿›è¡Œç»˜åˆ¶ï¼Œä½†æ˜¯çœ‹åˆ°<a href="http://blog.csdn.net/xiaanming/article/details/17718579" target="_blank" rel="external">æ‹–åŠ¨æ•ˆæœåšå®¢</a>å½“ä¸­æ˜¯ç›´æ¥æ³¨å†Œåœ¨äº† Window ä¸Šï¼Œè¿™æ›´åŠ å‡å°‘äº†å·¥ä½œé‡ï¼Œç›´æ¥åœ¨ GridView å½“ä¸­åˆ¤æ–­å¦‚æœç”¨æˆ·æ‹–åŠ¨çš„åæ ‡y è½´å¤§äºäº† GridView çš„é«˜åº¦ï¼Œå°±å¯ä»¥è¿›è¡Œç¼©å°åŠ¨ç”»äº†ã€‚</p>
<p>ä½†æ˜¯è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œæ³¨å†Œåœ¨ window ä¸Šçš„ View ä¸èƒ½ç›´æ¥åœ¨å…¶æœ€å¤–å±‚çš„  Layout ä¸Šè¿›è¡ŒåŠ¨ç”»ï¼Œæ‰€ä»¥æˆ‘å¯¹ImageView è¿›è¡Œäº†åŒ…è£¹ï¼Œå¹¶ä¸”æ˜¯å¯¹ ImageView è¿›è¡ŒåŠ¨ç”»ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">mDragImageView = <span class="keyword">new</span> ImageView(getContext());</div><div class="line">      mDragImageView.setImageBitmap(bitmap);</div><div class="line">mDragImageView.setBackgroundResource(R.drawable.bg_shadow);</div><div class="line"></div><div class="line">      mDragLayout = <span class="keyword">new</span> FrameLayout(getContext());</div><div class="line">      mDragLayout.addView(mDragImageView);</div><div class="line"></div><div class="line">      mWindowManager.addView(mDragLayout, mWindowLayoutParams);</div></pre></td></tr></table></figure></p>
<p>æœ‰äº†æ‹–åŠ¨æ•ˆæœå®ç°çš„ä»£ç ï¼Œå…¶ä»–éƒ½å¾ˆç®€å•ï¼Œå…·ä½“è¯·å‚ç…§ä»£ç ï¼Œ<br><a href="https://github.com/KennethYo/DragViewAndDelete" target="_blank" rel="external">ä»£ç åœ°å€</a>ï¼Œå…¶ä¸­é‡Œé¢çš„ä¸€äº›è‡ªå®šä¹‰æ ‡ç­¾éƒ½æ˜¯æˆ‘éœ€æ±‚ä¸­è‡ªå®šä¹‰çš„ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘åœ¨å…¬å¸åšäº†ä¸€ä¸ªè¿™æ ·çš„éœ€æ±‚ï¼Œæ‹–åŠ¨GridView ä¸­çš„ item åˆ°æŒ‡å®šåŒºåŸŸåˆ é™¤ï¼Œå…·ä½“æ•ˆæœï¼Œè¯·çœ‹ä¸‹é¢çš„åŠ¨å›¾ã€‚&lt;br&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150929150020321&quot; alt=&quot;è¿™é‡Œå†™å›¾ç‰‡æè¿°&quot;&gt;&lt;/p&gt;
&lt;p&gt;æ‹–åŠ¨
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://www.kennethyo.me/tags/Android/"/>
    
      <category term="View" scheme="http://www.kennethyo.me/tags/View/"/>
    
  </entry>
  
  <entry>
    <title>[åŸ]é«˜ä»¿SinaWeiboæ–°æµªå¾®åšå‘å¸ƒé¡µé¢è¯é¢˜æ•ˆæœ</title>
    <link href="http://www.kennethyo.me/2015/08/10/2015-08-10/"/>
    <id>http://www.kennethyo.me/2015/08/10/2015-08-10/</id>
    <published>2015-08-09T16:06:33.000Z</published>
    <updated>2016-09-01T06:38:45.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åšäº†ä¸€ä¸ªä»¿æ–°æµªå¾®åšè¯é¢˜æ•ˆæœçš„åŠŸèƒ½,ç½‘ä¸Šæœç´¢äº†å‡ ä¸ªæ•ˆæœ,éƒ½å­˜åœ¨ä¸€å®šé—®é¢˜,æœ€ç»ˆå€Ÿé‰´åˆ«äººçš„æ€è·¯,å®Œæˆè¿™ä¸€å¥—æ•ˆæœ.</p>
<p>é¦–å…ˆ,æˆ‘ä»¬æ‹†åˆ†é€»è¾‘ä»¥åŠå¼€å‘é¡ºåº.</p>
<blockquote>
<h6 id="1-å®ç°è¯é¢˜å˜è‰²æ•ˆæœ"><a href="#1-å®ç°è¯é¢˜å˜è‰²æ•ˆæœ" class="headerlink" title="1,å®ç°è¯é¢˜å˜è‰²æ•ˆæœ"></a>1,å®ç°è¯é¢˜å˜è‰²æ•ˆæœ</h6><h6 id="2-å®ç°æ’å…¥è¯é¢˜æ•ˆæœ"><a href="#2-å®ç°æ’å…¥è¯é¢˜æ•ˆæœ" class="headerlink" title="2,å®ç°æ’å…¥è¯é¢˜æ•ˆæœ"></a>2,å®ç°æ’å…¥è¯é¢˜æ•ˆæœ</h6><h6 id="3-å®ç°è¯é¢˜é€‰ä¸­åˆ é™¤æ•ˆæœ"><a href="#3-å®ç°è¯é¢˜é€‰ä¸­åˆ é™¤æ•ˆæœ" class="headerlink" title="3,å®ç°è¯é¢˜é€‰ä¸­åˆ é™¤æ•ˆæœ"></a>3,å®ç°è¯é¢˜é€‰ä¸­åˆ é™¤æ•ˆæœ</h6><h6 id="4-å®ç°ç‚¹å‡»è¯é¢˜-å…‰æ ‡åœ¨è¯é¢˜ä¹‹å"><a href="#4-å®ç°ç‚¹å‡»è¯é¢˜-å…‰æ ‡åœ¨è¯é¢˜ä¹‹å" class="headerlink" title="4,å®ç°ç‚¹å‡»è¯é¢˜,å…‰æ ‡åœ¨è¯é¢˜ä¹‹å"></a>4,å®ç°ç‚¹å‡»è¯é¢˜,å…‰æ ‡åœ¨è¯é¢˜ä¹‹å</h6></blockquote>
<p><img src="http://img.blog.csdn.net/20150809173121271" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>ä¸‹é¢æˆ‘ä»¬å°±ä¸€æ­¥ä¸€æ­¥å®ç°æ•ˆæœ.</p>
<hr>
<h2 id="ä¸€-å®ç°è¯é¢˜å˜è‰²"><a href="#ä¸€-å®ç°è¯é¢˜å˜è‰²" class="headerlink" title="ä¸€,å®ç°è¯é¢˜å˜è‰²"></a>ä¸€,å®ç°è¯é¢˜å˜è‰²</h2><p>å®ç°é€»è¾‘ä¸»è¦æ˜¯é€šè¿‡<code>EditText</code>çš„<code>addTextChangedListener()</code>æ¥è¿›è¡Œç›‘å¬æ–‡æœ¬å˜åŠ¨,é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…å‡ºæ–‡æœ¬ä¸­çš„è¯é¢˜.</p>
<h5 id="åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼è·å–å…¨éƒ¨è¯é¢˜"><a href="#åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼è·å–å…¨éƒ¨è¯é¢˜" class="headerlink" title="åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼è·å–å…¨éƒ¨è¯é¢˜:"></a>åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼è·å–å…¨éƒ¨è¯é¢˜:</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ­£åˆ™è¡¨è¾¾å¼,ä¸€å®šè¦å’ŒæœåŠ¡å™¨ä»¥åŠ iOS ç«¯ç»Ÿä¸€</span></div><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String topicRegex = <span class="string">"#([^#]+?)#"</span>;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;String&gt; <span class="title">findTopic</span><span class="params">(String s)</span> </span>&#123;</div><div class="line"></div><div class="line">        Pattern p = Pattern.compile(topicRegex);</div><div class="line">        Matcher m = p.matcher(s);</div><div class="line"></div><div class="line">        ArrayList&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">while</span> (m.find()) &#123;</div><div class="line">            list.add(m.group());</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> list;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å‡ºçš„è¯é¢˜é›†åˆ-éå†å‡ºæ¯ä¸ªè¯é¢˜çš„-startIndex-ä½ç½®-åæ¥å‘ç°Matcheræ–¹æ³•æ˜¯æœ‰è·å–-index-çš„æ–¹æ³•-å¹¶ä¸”é€šè¿‡EditText-getText-æ–¹æ³•è·å–çš„Editableç›´æ¥å¯¹æ–‡æœ¬è¿›è¡Œæ“ä½œ"><a href="#é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å‡ºçš„è¯é¢˜é›†åˆ-éå†å‡ºæ¯ä¸ªè¯é¢˜çš„-startIndex-ä½ç½®-åæ¥å‘ç°Matcheræ–¹æ³•æ˜¯æœ‰è·å–-index-çš„æ–¹æ³•-å¹¶ä¸”é€šè¿‡EditText-getText-æ–¹æ³•è·å–çš„Editableç›´æ¥å¯¹æ–‡æœ¬è¿›è¡Œæ“ä½œ" class="headerlink" title="é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å‡ºçš„è¯é¢˜é›†åˆ,éå†å‡ºæ¯ä¸ªè¯é¢˜çš„ startIndex ä½ç½®(åæ¥å‘ç°Matcheræ–¹æ³•æ˜¯æœ‰è·å– index çš„æ–¹æ³•),å¹¶ä¸”é€šè¿‡EditText.getText()æ–¹æ³•è·å–çš„Editableç›´æ¥å¯¹æ–‡æœ¬è¿›è¡Œæ“ä½œ:"></a>é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å‡ºçš„è¯é¢˜é›†åˆ,éå†å‡ºæ¯ä¸ªè¯é¢˜çš„ startIndex ä½ç½®(åæ¥å‘ç°<code>Matcher</code>æ–¹æ³•æ˜¯æœ‰è·å– index çš„æ–¹æ³•),å¹¶ä¸”é€šè¿‡<code>EditText.getText()</code>æ–¹æ³•è·å–çš„<code>Editable</code>ç›´æ¥å¯¹æ–‡æœ¬è¿›è¡Œæ“ä½œ:</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTextChanged</span><span class="params">(CharSequence s, <span class="keyword">int</span> start, <span class="keyword">int</span> before, <span class="keyword">int</span> count)</span> </span>&#123;</div><div class="line">        Log.i(<span class="string">"MainActivity"</span>, <span class="string">"onTextChanged"</span>);</div><div class="line">        <span class="keyword">if</span> (TextUtils.isEmpty(s)) <span class="keyword">return</span>;</div><div class="line">        <span class="comment">//1,æŸ¥æ‰¾è¯é¢˜</span></div><div class="line">        String content = s.toString();</div><div class="line">        mTopicList.clear();</div><div class="line">        mTopicList.addAll(findTopic(s.toString()));</div><div class="line"></div><div class="line">        <span class="comment">//2,ä¸ºæŸ¥æ‰¾å‡ºçš„å˜è‰²</span></div><div class="line">        <span class="comment">//é¦–å…ˆè¦ä¸ºeditable,å»é™¤ä¹‹å‰è®¾ç½®çš„colorSpan</span></div><div class="line">        Editable editable = mEditText.getText();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mColorSpans.size(); i++) &#123;</div><div class="line">            editable.removeSpan(mColorSpans.get(i));</div><div class="line">        &#125;</div><div class="line">        mColorSpans.clear();</div><div class="line">        <span class="comment">//ä¸ºeditable,ä¸­çš„è¯é¢˜åŠ å…¥colorSpan</span></div><div class="line">        <span class="keyword">int</span> findPos = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> size = mTopicList.size();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;<span class="comment">//ä¾¿åˆ©è¯é¢˜</span></div><div class="line">            String topic = mTopicList.get(i);</div><div class="line">            findPos = content.indexOf(topic, findPos);</div><div class="line">            <span class="keyword">if</span> (findPos != -<span class="number">1</span>) &#123;</div><div class="line">                ForegroundColorSpan colorSpan = <span class="keyword">new</span> ForegroundColorSpan(Color.BLUE);</div><div class="line">                editable.setSpan(colorSpan, findPos, findPos = findPos + topic.length(), Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);</div><div class="line">                mColorSpans.add(colorSpan);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="äºŒ-å®ç°æ’å…¥è¯é¢˜æ•ˆæœ"><a href="#äºŒ-å®ç°æ’å…¥è¯é¢˜æ•ˆæœ" class="headerlink" title="äºŒ,å®ç°æ’å…¥è¯é¢˜æ•ˆæœ"></a>äºŒ,å®ç°æ’å…¥è¯é¢˜æ•ˆæœ</h2><p>æ–°æµªå¾®åšçš„æ’å…¥è¯é¢˜æ•ˆæœ,æ˜¯å¼€å¯ä¸€ä¸ªæ–°çš„é¡µé¢,ç‚¹å‡»ä¸€ä¸ªè¯é¢˜å,æ’å…¥å…‰æ ‡æ‰€åœ¨çš„ä½ç½®.è¿™é‡Œæˆ‘ç”¨ä¸€ä¸ªæŒ‰é’®æ¨¡ä»¿äº†è¿™ä¸ªåŠ¨ä½œ.è¦æ³¨æ„çš„æ˜¯,è¦è®°å½•æ’å…¥ä¹‹å‰å…‰æ ‡çš„ä½ç½®,å¹¶ä¸”åœ¨æ’å…¥è¯é¢˜å,æŠŠå…‰æ ‡æ”¾ç½®åœ¨è¯é¢˜ä¹‹å:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (v.getId() == R.id.button) &#123;</div><div class="line">            <span class="comment">//æ’å…¥è¯é¢˜</span></div><div class="line">            <span class="keyword">int</span> selectionStart = mEditText.getSelectionStart();</div><div class="line">			<span class="comment">//ä¸‹é¢è¿™äº›æ“ä½œä¹Ÿå¯ä»¥ç›´æ¥æ›¿æ¢ä¸ºæ“ä½œ EditText çš„Editableå®ç°,ä¸‹é¢çš„ä»£ç  review åçœ‹èµ·æ¥ç”±ç‚¹è ¢,ç›´æ¥è°ƒç”¨ insert æ–¹æ³•æ¯”è¾ƒå·§å¦™</span></div><div class="line">            String content = mEditText.getText().toString();</div><div class="line"></div><div class="line">            String firstStr = content.substring(<span class="number">0</span>, selectionStart);</div><div class="line">            String secondStr = content.substring(selectionStart, content.length());</div><div class="line"></div><div class="line">            String insertTopic = <span class="string">"#è¿™æ˜¯ä¸€ä¸ªæ’å…¥çš„è¯é¢˜#"</span>;</div><div class="line">            mEditText.setText(firstStr + insertTopic + secondStr);</div><div class="line">            mEditText.setSelection(selectionStart + insertTopic.length());</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="ä¸‰-å®ç°è¯é¢˜é€‰ä¸­åˆ é™¤æ•ˆæœ"><a href="#ä¸‰-å®ç°è¯é¢˜é€‰ä¸­åˆ é™¤æ•ˆæœ" class="headerlink" title="ä¸‰,å®ç°è¯é¢˜é€‰ä¸­åˆ é™¤æ•ˆæœ"></a>ä¸‰,å®ç°è¯é¢˜é€‰ä¸­åˆ é™¤æ•ˆæœ</h2><p>è¿™é‡Œä¹Ÿæ˜¯è¦æ—¶æ—¶åˆ¤æ–­å…‰æ ‡æ‰€åœ¨çš„ä½ç½®,å½“å…‰æ ‡å‡ºç°åœ¨è¯é¢˜ä¹‹å,å†æ¬¡ç‚¹å‡»åˆ é™¤,å°±æˆªè·ä¸ºé€‰ä¸­è¯é¢˜æ•ˆæœ,å®ç°èµ·æ¥ä¹Ÿæ˜¯å¾ˆç®€å•çš„.</p>
<p>ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯,æˆ‘ä»¬ä¸èƒ½åˆ©ç”¨ activity é‡Œé¢çš„<code>onKeyDown()</code>å’Œ<code>onKeyUp()</code>ä¸¤ä¸ªå›è°ƒ,é€šè¿‡ log å‘ç°æ–‡æœ¬å˜åŠ¨å’ŒæŒ‰é”®ç‚¹å‡»çš„å›è°ƒé¡ºåºä¸º<code>beforeTextChanged-&gt;onTextChanged-&gt;afterTextChanged-&gt;onKeyDown-&gt;onKeyUp</code>.</p>
<p>è¿™ä¹Ÿè¯´æ˜äº†å¦‚æœé€šè¿‡ æ‹¦æˆª<code>onKeyDown()</code>å’Œ<code>onKeyUp()</code>ä¸¤ä¸ªå›è°ƒæ—¶,æ–‡æœ¬æ˜¯å·²ç»åˆ é™¤ä¹‹åçš„æ–‡æœ¬,å¹¶èƒ½æœ‰æ•ˆçš„è¾¾åˆ°æˆ‘ä»¬è¦å®ç°çš„ç›®çš„,é‚£ä¹ˆæœ‰æ²¡æœ‰æ˜¯æ–‡æœ¬æ”¹å˜ä¹‹å‰å°±èƒ½æˆªå–åˆ°æŒ‰é”®çš„æ–¹æ³•å‘¢?</p>
<p>å…¶å®æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›‘å¬<code>EditText</code>çš„<code>setOnKeyListener()</code>æ–¹æ³•æ¥ç›‘å¬æŒ‰é”®(<code>onKey-&gt;beforeTextChanged-&gt;onTextChanged-&gt;afterTextChanged-&gt;onKeyDown-&gt;onKeyUp</code>):</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onKey</span><span class="params">(View v, <span class="keyword">int</span> keyCode, KeyEvent event)</span> </span>&#123;</div><div class="line">        Log.i(<span class="string">"MainActivity"</span>, <span class="string">"onKey"</span>);</div><div class="line">        <span class="keyword">if</span> (keyCode == KeyEvent.KEYCODE_DEL &amp;&amp; event.getAction() == KeyEvent.ACTION_DOWN &amp;&amp; mCheckBox2.isChecked()) &#123;</div><div class="line"></div><div class="line">            <span class="keyword">int</span> selectionStart = mEditText.getSelectionStart();</div><div class="line">            <span class="keyword">int</span> selectionEnd = mEditText.getSelectionEnd();</div><div class="line">			<span class="comment">//å¦‚æœå…‰æ ‡èµ·å§‹å’Œç»“æŸåœ¨åŒä¸€ä½ç½®,è¯´æ˜æ˜¯é€‰ä¸­æ•ˆæœ,ç›´æ¥è¿”å› false äº¤ç»™ç³»ç»Ÿæ‰§è¡Œåˆ é™¤åŠ¨ä½œ</span></div><div class="line">            <span class="keyword">if</span> (selectionStart != selectionEnd) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            Editable editable = mEditText.getText();</div><div class="line">            String content = editable.toString();</div><div class="line">            <span class="keyword">int</span> lastPos = <span class="number">0</span>;</div><div class="line">            <span class="keyword">int</span> size = mTopicList.size();</div><div class="line">            <span class="comment">//éå†åˆ¤æ–­å…‰æ ‡çš„ä½ç½®</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</div><div class="line">                String topic = mTopicList.get(i);</div><div class="line">                lastPos = content.indexOf(topic, lastPos);</div><div class="line">                <span class="keyword">if</span> (lastPos != -<span class="number">1</span>) &#123;</div><div class="line">                    <span class="keyword">if</span> (selectionStart != <span class="number">0</span> &amp;&amp; selectionStart &gt;= lastPos &amp;&amp; selectionStart &lt;= (lastPos + topic.length())) &#123;</div><div class="line">                        <span class="comment">//é€‰ä¸­è¯é¢˜</span></div><div class="line">                        mEditText.setSelection(lastPos, lastPos + topic.length());</div><div class="line">                        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                lastPos += topic.length();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="å››-å®ç°ç‚¹å‡»è¯é¢˜-å…‰æ ‡åœ¨è¯é¢˜ä¹‹å"><a href="#å››-å®ç°ç‚¹å‡»è¯é¢˜-å…‰æ ‡åœ¨è¯é¢˜ä¹‹å" class="headerlink" title="å››,å®ç°ç‚¹å‡»è¯é¢˜,å…‰æ ‡åœ¨è¯é¢˜ä¹‹å"></a>å››,å®ç°ç‚¹å‡»è¯é¢˜,å…‰æ ‡åœ¨è¯é¢˜ä¹‹å</h2><p>é€»è¾‘å¤„ç†å°±æ˜¯ç›‘å¬<code>EditText</code>çš„ç‚¹å‡»äº‹ä»¶,å¤„ç†å…‰æ ‡æ‰€åœ¨ä½ç½®,å¦‚æœåœ¨ä½ç½®åœ¨è¯é¢˜å†…,ç«‹å³æ”¾ç½®åœ¨è¯é¢˜çš„åé¢,é€»è¾‘æ¯”è¾ƒç®€å•,ç›´æ¥ä¸Šä»£ç :<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (v.getId() == R.id.editText &amp;&amp; mCheckBox1.isChecked()) &#123;</div><div class="line">            <span class="keyword">int</span> selectionStart = mEditText.getSelectionStart();</div><div class="line"></div><div class="line">            <span class="keyword">int</span> lastPos = <span class="number">0</span>;</div><div class="line">            <span class="keyword">int</span> size = mTopicList.size();</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</div><div class="line">                String topic = mTopicList.get(i);</div><div class="line">                lastPos = mEditText.getText().toString().indexOf(topic, lastPos);</div><div class="line"></div><div class="line">                <span class="keyword">if</span> (lastPos != -<span class="number">1</span>) &#123;</div><div class="line">                    <span class="keyword">if</span> (selectionStart &gt;= lastPos &amp;&amp; selectionStart &lt;= (lastPos + topic.length())) &#123;</div><div class="line">                        <span class="comment">//åœ¨è¿™position åŒºé—´å°±ç§»åŠ¨å…‰æ ‡</span></div><div class="line">                        mEditText.setSelection(lastPos + topic.length());</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                lastPos = lastPos + topic.length();</div><div class="line">            &#125;</div><div class="line">        &#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>æœ€ç»ˆè¿˜æ˜¯æœ‰ç‚¹å°é—æ†¾æ²¡æœ‰å®Œæˆ.å½“æ‹·è´ä¸€æ®µå·²ç»å˜è‰²çš„è¯é¢˜,å†ç²˜è´´åˆ°æ–‡æœ¬å,æ— æ³•åˆ é™¤æ‰æ‹·è´è¿›æ¥æ–‡æœ¬çš„å˜è‰²æ•ˆæœ,å°è¯•è°ƒç”¨<code>Editable.clearSpans()</code>å»é™¤å…¨éƒ¨ span ä¹Ÿæ— æ³•å®ç°,å¹¶ä¸”è¿™ä¸ªæ–¹æ³•ä¼šå¯¼è‡´ç›´æ¥å¡æ­».åæ¥ç›´æ¥ä½¿ç”¨<code>EditText.setText()</code>æ§åˆ¶æ–‡æœ¬,ç¡®å®è¾¾åˆ°äº†æ•ˆæœ,ä½†æ˜¯å½“è¾“å…¥æ³•æ˜¯ç±»ä¼¼ mx4é»˜è®¤è¾“å…¥æ³•æ•ˆæœæ—¶(æ•ˆæœå¤§æ¦‚æ˜¯,è¾“å…¥çš„æ‹¼éŸ³ç›´æ¥æ˜¾ç¤ºåœ¨ EditText é‡Œé¢,ç‚¹å‡»è¢«é€‰æ±‰å­—,æ›¿æ¢æ‰æ‹¼éŸ³),ä¼šæŠŠè¾“å…¥çš„æ‹¼éŸ³æ”¾å…¥åˆ°æ–‡æœ¬é‡Œ,æ‰€ä»¥ä¸Šé¢çš„ä»£ç ,æˆ‘ä¸€èˆ¬æ˜¯ç›´æ¥æ“ä½œ Editable.</p>
<p>å¦‚æœæœ‰æ›´å¥½çš„æ–¹æ³•æˆ–è€…ä¿®å¤äº†ä¸Šé¢çš„å°é—æ†¾,è¯·ç•™è¨€æŒ‡æ•™.</p>
<p>Demo åœ°å€ï¼š<a href="https://github.com/KennethYo/SinaTopic" target="_blank" rel="external">https://github.com/KennethYo/SinaTopic</a></p>
<p>è½¬è½½è¯·æ³¨æ˜å‡ºå¤„:<a href="http://www.kennethyo.me">http://www.kennethyo.me</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘åšäº†ä¸€ä¸ªä»¿æ–°æµªå¾®åšè¯é¢˜æ•ˆæœçš„åŠŸèƒ½,ç½‘ä¸Šæœç´¢äº†å‡ ä¸ªæ•ˆæœ,éƒ½å­˜åœ¨ä¸€å®šé—®é¢˜,æœ€ç»ˆå€Ÿé‰´åˆ«äººçš„æ€è·¯,å®Œæˆè¿™ä¸€å¥—æ•ˆæœ.&lt;/p&gt;
&lt;p&gt;é¦–å…ˆ,æˆ‘ä»¬æ‹†åˆ†é€»è¾‘ä»¥åŠå¼€å‘é¡ºåº.&lt;/p&gt;
&lt;blockquote&gt;
&lt;h6 id=&quot;1-å®ç°è¯é¢˜å˜è‰²æ•ˆæœ&quot;&gt;&lt;a href=&quot;#1-å®ç°è¯é¢˜å˜è‰²æ•ˆæœ
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://www.kennethyo.me/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>[è¯‘]ä»‹ç»MVP Model-View-Presenteråœ¨Androidä¸­çš„åº”ç”¨</title>
    <link href="http://www.kennethyo.me/2015/05/25/2015-05-25/"/>
    <id>http://www.kennethyo.me/2015/05/25/2015-05-25/</id>
    <published>2015-05-25T05:47:35.000Z</published>
    <updated>2016-09-01T06:39:29.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘å­¦ä¹ MVPæ¨¡å¼æ—¶ç¿»è¯‘çš„ï¼ŒåŸæ–‡æ˜¯<a href="http://konmik.github.io/author/konstantin-mikheev.html" target="_blank" rel="external">Konstantin Mikheev</a>æ‰€å†™ï¼Œ<a href="http://konmik.github.io/introduction-to-model-view-presenter-on-android.html?utm_source=Android+Weekly&amp;utm_campaign=5589504b56-Android_Weekly_148&amp;utm_medium=email&amp;utm_term=0_4eb677ad19-5589504b56-337835113" target="_blank" rel="external">ä¼ é€é—¨</a>ã€‚<br>å› è‹±è¯­æ°´å¹³æœ‰é™ï¼Œç¿»è¯‘çš„å¾ˆç”Ÿç¡¬ï¼ŒåŸºæœ¬é Googleï¼Œè¯·è§è°…ã€‚ä»¥ä¸‹æ˜¯è¯‘æ–‡ã€‚<br>è½¬è½½è¯·æ³¨æ˜å‡ºå¤„:<a href="http://blog.csdn.net/kennethyo" target="_blank" rel="external">http://blog.csdn.net/kennethyo</a></p>
<hr>
<p>è¿™ç¯‡æ–‡ç« æˆ‘ä¼šé€šè¿‡ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­å»ä¸€æ­¥æ­¥ä»‹ç»MVPæ¨¡å¼åœ¨Androidä¸­çš„æœ€ä½³å®è·µã€‚åŒæ—¶æˆ‘ä¹Ÿä¼šä»‹ç»ä¸€ä¸ªä½¿MVPæ¨¡å¼åœ¨Androidå¼€å‘ä¸­å˜ç®€å•çš„libraryã€‚</p>
<h1 id="ç®€å•ï¼Ÿæ€ä¹ˆæ‰èƒ½ä»ä¸­è·ç›Šå‘¢ï¼Ÿ"><a href="#ç®€å•ï¼Ÿæ€ä¹ˆæ‰èƒ½ä»ä¸­è·ç›Šå‘¢ï¼Ÿ" class="headerlink" title="ç®€å•ï¼Ÿæ€ä¹ˆæ‰èƒ½ä»ä¸­è·ç›Šå‘¢ï¼Ÿ"></a>ç®€å•ï¼Ÿæ€ä¹ˆæ‰èƒ½ä»ä¸­è·ç›Šå‘¢ï¼Ÿ</h1><h2 id="ä»€ä¹ˆæ˜¯MVP"><a href="#ä»€ä¹ˆæ˜¯MVP" class="headerlink" title="ä»€ä¹ˆæ˜¯MVP"></a>ä»€ä¹ˆæ˜¯MVP</h2><p><strong>View</strong>å±‚æ˜¯ç”¨æ¥æ˜¾ç¤ºæ•°æ®å’Œç›¸åº”æ•°æ®æ“ä½œçš„ã€‚åœ¨Androidä¸­ï¼Œå®ƒå¯èƒ½æ˜¯Activityï¼ŒFragmentï¼ŒViewæˆ–è€…Dialogã€‚</p>
<p><strong>Model</strong>å±‚æ˜¯æ•°æ®è®¿é—®å±‚ï¼Œä¾‹å¦‚æ•°æ®åº“APIæˆ–è€…è¿œç¨‹æœåŠ¡å™¨è®¿é—®APIã€‚</p>
<p><strong>Presenter</strong>å±‚æä¾›Viewå±‚å’ŒModelå±‚çš„æ•°æ®è¿›è¡Œè”ç³»ã€‚Presenterå±‚ä¹Ÿå¯ä»¥æ§åˆ¶åå°Taskã€‚</p>
<p>åœ¨Androidä¸­ï¼ŒMVPæ¨¡å¼å¯ä»¥æŠŠåå°çº¿ç¨‹ä»Activitys/Views/Fragmentsä¸­è„±ç¦»å‡ºæ¥ï¼Œä½¿å®ƒä»¬åœ¨å¤§éƒ¨åˆ†ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ä¸­æ›´åŠ ç‹¬ç«‹ã€‚è¿™æ ·çš„åº”ç”¨å˜å¾—æ›´åŠ ç®€å•ï¼Œæ•´ä¸ªç¨‹åºçš„ç¨³å®šæ€§æå‡äº†10å€ä¸æ­¢ï¼Œåº”ç”¨ä»£ç å˜å¾—æ›´åŠ å°‘ï¼Œä»£ç å¯ç»´æŠ¤æ€§å˜å¾—æ›´åŠ å‹å–„ï¼Œå¼€å‘è€…çš„ç”Ÿå‘½å˜å¾—æ›´åŠ å¼€å¿ƒã€‚</p>
<h2 id="åœ¨Androidä¸­ï¼Œä¸ºä»€ä¹ˆæ˜¯MVP"><a href="#åœ¨Androidä¸­ï¼Œä¸ºä»€ä¹ˆæ˜¯MVP" class="headerlink" title="åœ¨Androidä¸­ï¼Œä¸ºä»€ä¹ˆæ˜¯MVP"></a>åœ¨Androidä¸­ï¼Œä¸ºä»€ä¹ˆæ˜¯MVP</h2><h3 id="åŸå› 1ï¼šä¿æŒç®€å•å‚»ç“œ"><a href="#åŸå› 1ï¼šä¿æŒç®€å•å‚»ç“œ" class="headerlink" title="åŸå› 1ï¼šä¿æŒç®€å•å‚»ç“œ"></a>åŸå› 1ï¼šä¿æŒç®€å•å‚»ç“œ</h3><p>å¦‚æœä½ è¿˜æ²¡è¯»è¿‡è¿™ç¯‡æ–‡ç« ï¼Œè¯·è¯»ä¸€éï¼š<a href="https://people.apache.org/~fhanik/kiss.html" target="_blank" rel="external">The Kiss Principle</a></p>
<pre><code>Â·å¤§å¤šæ•°Androidç¨‹åºä»…ä»…ä½¿ç”¨äº†View-Modelæ¨¡å¼ã€‚
Â·ç¨‹åºå‘˜éœ€è¦å‚ä¸Viewçš„å¤æ‚æ€§ï¼Œè€Œä¸æ˜¯è§£å†³ä¸šåŠ¡ã€‚
</code></pre><p>åœ¨åº”ç”¨ä¸­ä½ ä»…ä»…ä½¿ç”¨Model-Viewï¼Œæœ€åä¼šè½å¾—â€œä¸€åˆ‡è¿æ¥è¿™ä¸€åˆ‡â€çš„çŠ¶æ€ã€‚</p>
<p><img src="http://img.blog.csdn.net/20150525132155795" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>å¦‚æœè¿™ä¸ªç¤ºä¾‹å›¾çœ‹èµ·æ¥ä¸æ˜¯é‚£ä¹ˆå¤æ‚ï¼Œé‚£ä¹ˆæƒ³æƒ³æ¯ä¸ªViewå¯èƒ½éšæ—¶æ¶ˆå¤±å’Œéšæ—¶å‡ºç°ã€‚åˆ«å¿˜äº†ä¿å­˜å’Œæ¢å¤viewçš„çŠ¶æ€ã€‚ä¸ºä¸´æ—¶View attache å‡ ä¸ªåå°ä»»åŠ¡ï¼Œè›‹ç³•å‡†å¤‡å¥½äº†ï¼</p>
<p>å¦ä¸€ç§â€œä¸€åˆ‡è¿æ¥ç€ä¸€åˆ‡â€å°±æ˜¯ä¸Šå¸å¯¹è±¡ã€‚</p>
<p><img src="http://img.blog.csdn.net/20150525132227292" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>ä¸Šåœ°å¯¹è±¡å¤ªè¿‡äºå¤æ‚ï¼›ä»£ç å—ä¸èƒ½è¢«é‡å¤åˆ©ç”¨ï¼Œæµ‹è¯•æˆ–æ–¹ä¾¿çš„debugå’Œé‡æ„ã€‚</p>
<h4 id="ä½¿ç”¨MVPæ¨¡å¼"><a href="#ä½¿ç”¨MVPæ¨¡å¼" class="headerlink" title="ä½¿ç”¨MVPæ¨¡å¼"></a>ä½¿ç”¨MVPæ¨¡å¼</h4><p><img src="http://img.blog.csdn.net/20150525132427577" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<pre><code>Â·å¤æ‚çš„ä»»åŠ¡è¢«åˆ†è§£æˆç®€å•çš„ä»»åŠ¡ï¼Œå¹¶ä¸”å®¹æ˜“è§£å†³ã€‚
Â·æ›´å°çš„å¯¹è±¡ï¼Œæ›´å°‘çš„bugï¼Œæ›´ç®€å•debugã€‚
Â·å¯æµ‹è¯•ã€‚
</code></pre><h3 id="åŸå› 2ï¼šåå°ä»»åŠ¡"><a href="#åŸå› 2ï¼šåå°ä»»åŠ¡" class="headerlink" title="åŸå› 2ï¼šåå°ä»»åŠ¡"></a>åŸå› 2ï¼šåå°ä»»åŠ¡</h3><p>æ— è®ºä½•æ—¶ï¼Œä½ å†™Activityï¼ŒFragmentæˆ–è€…è‡ªå®šä¹‰Viewï¼Œä½ å¯ä»¥æŠŠæ‰€æœ‰æ–¹æ³•ä¸åå°ä»»åŠ¡çš„å¤–éƒ¨æˆ–è€…é™æ€ç±»è”ç³»èµ·æ¥ã€‚è¿™æ ·ï¼Œä½ çš„åå°ä»»åŠ¡å°†ä¸ä¼šå’Œä¸€ä¸ªActivityè”ç³»ï¼Œä¸ä¼šé€ æˆå†…å­˜æ³„éœ²å’Œä¸ç”¨Activityæ¥æ¶ˆè´¹ã€‚æˆ‘å«è¿™æ ·çš„å¯¹è±¡ä¸ºâ€œPresenterâ€ã€‚</p>
<p>æœ‰é‚£ä¹ˆå‡ ç§å¤„ç†åå°çº¿ç¨‹çš„æ–¹æ³•ï¼Œä½†éƒ½æ˜¯ä¸å¯é çš„ï¼Œä¸è¿‡MVPæ˜¯å¯é çš„ã€‚</p>
<h4 id="ä¸ºä»€ä¹ˆMVPå¯ä»¥"><a href="#ä¸ºä»€ä¹ˆMVPå¯ä»¥" class="headerlink" title="ä¸ºä»€ä¹ˆMVPå¯ä»¥"></a>ä¸ºä»€ä¹ˆMVPå¯ä»¥</h4><p>é€šè¿‡è¿™ä¸ªè§†å›¾ï¼Œæ˜¾ç¤ºäº†ä¸åŒçš„åº”ç”¨æ§ä»¶ï¼Œåœ¨å‘ç”Ÿconfigurationå‘ç”Ÿæ”¹å˜æˆ–è€…å†…å­˜æº¢å‡ºçš„æ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆã€‚æ¯ä¸€ä¸ªAndroidå¼€å‘è€…éƒ½åº”è¯¥çŸ¥é“è¿™ä¸ªè§†å›¾ï¼Œç„¶è€Œè¿™æ ·ä¸€ä¸ªè§†å›¾å¹¶ä¸æ˜¯æ¯ä¸ªå¼€å‘éƒ½çŸ¥é“ã€‚</p>
<p><img src="http://img.blog.csdn.net/20150525133414325" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p><strong>Case 1:</strong>å½“ç”¨æˆ·æ—‹è½¬å±å¹•ï¼Œæ”¹å˜è¯­è¨€è®¾ç½®ï¼Œ attache ä¸€ä¸ªå¤–éƒ¨æ˜¾ç¤ºå™¨ï¼Œç­‰æƒ…å†µï¼Œé€šå¸¸Configurationä¼šå‘ç”Ÿå˜åŒ–ã€‚æ›´å¤šå…³äº[Configuration]<br>(<a href="http://developer.android.com/reference/android/R.attr.html#configChanges)è¯·é˜…è¯»é“¾æ¥ã€‚" target="_blank" rel="external">http://developer.android.com/reference/android/R.attr.html#configChanges)è¯·é˜…è¯»é“¾æ¥ã€‚</a></p>
<p><strong>Case 2:</strong>å½“ç”¨æˆ·åœ¨å¼€å‘è€…è®¾ç½®é‡Œé¢é€‰æ‹©äº†â€œDonâ€™t keep activitiesâ€æˆ–è€…å…¶ä»–Activityåˆ°æœ€é¡¶å±‚ï¼ŒActivityä¼šå‘ç”Ÿrestartã€‚</p>
<p><strong>Case 3:</strong>æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å’Œåº”ç”¨è¿›å…¥åå°ï¼Œprocessä¼šrestartã€‚</p>
<p><strong>æœ€å</strong><br>ç°åœ¨ä½ å¯ä»¥çœ‹åˆ°ï¼ŒFragmentå½“ä¸­è®¾ç½®setRetainInstance(true)åœ¨è¿™é‡Œæ˜¯æ²¡ç”¨å¸®åŠ©çš„ï¼Œæˆ‘ä»¬åªéœ€è¦è®¾ç½®save/restoreå°±å¯ä»¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„å»é™¤Fragmentçš„setRetainInstanceæ–¹æ³•ï¼Œæ¥é™åˆ¶é—®é¢˜çš„æ•°é‡ã€‚</p>
<p><img src="http://img.blog.csdn.net/20150525133504401" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>|Activity, View, Fragment, DialogFragment Static variables and threads | save/restore no change | save/restore reset |<br>ç°åœ¨çœ‹èµ·æ¥çˆ½å¤šäº†ã€‚æˆ‘ä»¬åœ¨åº”ç”¨ä»»ä½•æƒ…å†µä¸‹ï¼Œåªéœ€è¦å†™ä¸¤æ®µä»£ç å°±å¯ä»¥å®Œæˆrestoreï¼š</p>
<pre><code>Â·Activityï¼ŒViewï¼ŒFragmentï¼ŒDialogFragmentçš„save/restoreã€‚
Â·çº¿ç¨‹restartï¼Œrestartåå°è¯·æ±‚ã€‚
</code></pre><p>ç¬¬ä¸€éƒ¨åˆ†ï¼Œæ˜¯Android APIæä¾›çš„æ–¹æ³•ã€‚ç¬¬äºŒéƒ¨åˆ†æ˜¯Presenterå±‚çš„å·¥ä½œã€‚Presenteråªè¦è®°ä½é‚£äº›è¯·æ±‚éœ€è¦è¢«æ‰§è¡Œï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹æ‰§è¡ŒæœŸé—´restartï¼ŒPresenterå°†ä¼šé‡æ–°æ‰§è¡Œå®ƒä»¬ã€‚</p>
<h2 id="ä¸€ä¸ªä¾‹å­"><a href="#ä¸€ä¸ªä¾‹å­" class="headerlink" title="ä¸€ä¸ªä¾‹å­"></a>ä¸€ä¸ªä¾‹å­</h2><p>è¿™ä¸ªä¾‹å­å°†åŠ è½½æœåŠ¡å™¨ä¸Šå¾—æ•°æ®æ¥æ˜¾ç¤ºä¸€äº›itemsã€‚å¦‚æœå‡ºç°é”™è¯¯å°†æ˜¾ç¤ºä¸€ä¸ªtoastã€‚</p>
<p>æˆ‘æ¨èä½¿ç”¨<a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="external">RxJava</a>æ¥æ„å»ºPresenterï¼Œå› ä¸ºè¿™ä¸ªLibraryæ§åˆ¶æ•°æ®æµå¾ˆç®€å•ã€‚</p>
<p>æˆ‘ä¹Ÿè¦æ„Ÿè°¢åˆ›å»º<a href="http://www.icndb.com/" target="_blank" rel="external">The Internet Chuck Norris Database</a>çš„äººï¼Œæˆ‘æŠŠå®ƒç”¨åœ¨äº†æˆ‘ä¾‹å­å½“ä¸­ã€‚</p>
<h2 id="æ²¡ç”¨MVPçš„ä¾‹å­00ï¼š"><a href="#æ²¡ç”¨MVPçš„ä¾‹å­00ï¼š" class="headerlink" title="æ²¡ç”¨MVPçš„ä¾‹å­00ï¼š"></a>æ²¡ç”¨MVPçš„<a href="https://github.com/konmik/MVPExamples/tree/master/example00" target="_blank" rel="external">ä¾‹å­00</a>ï¼š</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_NAME = <span class="string">"Chuck Norris"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> ArrayAdapter&lt;ServerAPI.Item&gt; adapter;</div><div class="line">    <span class="keyword">private</span> Subscription subscription;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line">        ListView listView = (ListView)findViewById(R.id.listView);</div><div class="line">        listView.setAdapter(adapter = <span class="keyword">new</span> ArrayAdapter&lt;&gt;(<span class="keyword">this</span>, R.layout.item));</div><div class="line">        requestItems(DEFAULT_NAME);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onDestroy();</div><div class="line">        unsubscribe();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestItems</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        unsubscribe();</div><div class="line">        subscription = App.getServerAPI()</div><div class="line">            .getItems(name.split(<span class="string">"\\s+"</span>)[<span class="number">0</span>], name.split(<span class="string">"\\s+"</span>)[<span class="number">1</span>])</div><div class="line">            .delay(<span class="number">1</span>, TimeUnit.SECONDS)</div><div class="line">            .observeOn(AndroidSchedulers.mainThread())</div><div class="line">            .subscribe(<span class="keyword">new</span> Action1&lt;ServerAPI.Response&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(ServerAPI.Response response)</span> </span>&#123;</div><div class="line">                    onItemsNext(response.items);</div><div class="line">                &#125;</div><div class="line">            &#125;, <span class="keyword">new</span> Action1&lt;Throwable&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Throwable error)</span> </span>&#123;</div><div class="line">                    onItemsError(error);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemsNext</span><span class="params">(ServerAPI.Item[] items)</span> </span>&#123;</div><div class="line">        adapter.clear();</div><div class="line">        adapter.addAll(items);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemsError</span><span class="params">(Throwable throwable)</span> </span>&#123;</div><div class="line">        Toast.makeText(<span class="keyword">this</span>, throwable.getMessage(), Toast.LENGTH_LONG).show();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">unsubscribe</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (subscription != <span class="keyword">null</span>) &#123;</div><div class="line">            subscription.unsubscribe();</div><div class="line">            subscription = <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸€ä¸ªæœ‰ç»éªŒçš„å¼€å‘ä¼šå‘ç°è¿™ä¸ªä¾‹å­æ˜¯æœ‰ä¸€äº›ç¼ºé™·çš„ï¼š</p>
<pre><code>Â·æ¯æ¬¡ç¿»è½¬å±å¹•éƒ½ä¼šé‡æ–°è¯·æ±‚ä¸€æ¬¡â€”â€”æ¯æ¬¡ç¿»è½¬å±å¹•ç”¨æˆ·éƒ½ä¼šçœ‹ä¸€ä¼šå„¿ç©ºç™½ç•Œé¢ã€‚
Â·å¦‚æœç”¨æˆ·ç»å¸¸ç¿»è½¬å±å¹•ï¼Œå°±ä¼šå¯¼è‡´å†…å­˜æ³„éœ²â€”â€”æ¯ä¸ªå›è°ƒéƒ½ä¼šä¿æŒå¯¹MainActivityçš„å¼•ç”¨ï¼Œå¹¶ä¸”requestè¿è¡Œçš„æ—¶å€™ä¼šæŠŠMainActivityä¿æŒåœ¨å†…å­˜ä¸­ã€‚è¿™ç»å¯¹æœ‰å¯èƒ½å¯¼è‡´å› ä¸ºå†…å­˜æº¢å‡ºè€Œåº”ç”¨crashï¼Œæˆ–è€…åº”ç”¨è¿è¡Œæ˜æ˜¾ç¼“æ…¢ã€‚
</code></pre><h2 id="ä½¿ç”¨MVPçš„ä¾‹å­01"><a href="#ä½¿ç”¨MVPçš„ä¾‹å­01" class="headerlink" title="ä½¿ç”¨MVPçš„ä¾‹å­01"></a>ä½¿ç”¨MVPçš„<a href="https://github.com/konmik/MVPExamples/tree/master/example01" target="_blank" rel="external">ä¾‹å­01</a></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainPresenter</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_NAME = <span class="string">"Chuck Norris"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> ServerAPI.Item[] items;</div><div class="line">    <span class="keyword">private</span> Throwable error;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> MainActivity view;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MainPresenter</span><span class="params">()</span> </span>&#123;</div><div class="line">        App.getServerAPI()</div><div class="line">            .getItems(DEFAULT_NAME.split(<span class="string">"\\s+"</span>)[<span class="number">0</span>], DEFAULT_NAME.split(<span class="string">"\\s+"</span>)[<span class="number">1</span>])</div><div class="line">            .delay(<span class="number">1</span>, TimeUnit.SECONDS)</div><div class="line">            .observeOn(AndroidSchedulers.mainThread())</div><div class="line">            .subscribe(<span class="keyword">new</span> Action1&lt;ServerAPI.Response&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(ServerAPI.Response response)</span> </span>&#123;</div><div class="line">                    items = response.items;</div><div class="line">                    publish();<span class="comment">//onNext</span></div><div class="line">                &#125;</div><div class="line">            &#125;, <span class="keyword">new</span> Action1&lt;Throwable&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Throwable throwable)</span> </span>&#123;</div><div class="line">                    error = throwable;</div><div class="line">                    publish();<span class="comment">//onError</span></div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">    &#125;</div><div class="line">     </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTakeView</span><span class="params">(MainActivity view)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.view = view;</div><div class="line">        publish();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">publish</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (view != <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">if</span> (items != <span class="keyword">null</span>)</div><div class="line">                view.onItemsNext(items);</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (error != <span class="keyword">null</span>)</div><div class="line">                view.onItemsError(error);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»æŠ€æœ¯è§’åº¦è®²ï¼šMainPresenteræœ‰ä¸‰ä¸ªçº¿ç¨‹äº‹ä»¶ï¼šonNextï¼ŒonErrorï¼ŒonTakeviewã€‚é€šè¿‡<code>publish()</code>æ–¹æ³•ï¼ŒonNextæˆ–è€…onErroräº‹ä»¶ä¼šå‘å¸ƒåˆ°MainActivityå®ä¾‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> ArrayAdapter&lt;ServerAPI.Item&gt; adapter;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> MainPresenter presenter;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line"></div><div class="line">        ListView listView = (ListView)findViewById(R.id.listView);</div><div class="line">        listView.setAdapter(adapter = <span class="keyword">new</span> ArrayAdapter&lt;&gt;(<span class="keyword">this</span>, R.layout.item));</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (presenter == <span class="keyword">null</span>)</div><div class="line">            presenter = <span class="keyword">new</span> MainPresenter();</div><div class="line">        presenter.onTakeView(<span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onDestroy();</div><div class="line">        presenter.onTakeView(<span class="keyword">null</span>);</div><div class="line">        <span class="keyword">if</span> (isFinishing())</div><div class="line">            presenter = <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemsNext</span><span class="params">(ServerAPI.Item[] items)</span> </span>&#123;</div><div class="line">        adapter.clear();</div><div class="line">        adapter.addAll(items);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemsError</span><span class="params">(Throwable throwable)</span> </span>&#123;</div><div class="line">        Toast.makeText(<span class="keyword">this</span>, throwable.getMessage(), Toast.LENGTH_LONG).show();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>MainActivity åˆ›å»º MainPresenterï¼Œå¹¶ä¸”ä¿æŒMainPresenteråœ¨onCreateå’ŒonDestoryå‘¨æœŸä¹‹å¤–ã€‚MainActivityç”¨ä¸€ä¸ªé™æ€å˜é‡å¼•ç”¨MainPresenterï¼Œå½“ç”±äºOOMå¯¼è‡´çº¿ç¨‹é‡å¯ï¼ŒMainActivityä¼šæ£€æŸ¥MainPresenteræ˜¯å¦è¿˜å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±å»åˆ›å»ºå®ƒã€‚</p>
<p>æ˜¯çš„ï¼Œæ£€æŸ¥å’Œä½¿ç”¨é™æ€å˜é‡èµ·æ¥æœ‰é‚£ä¹ˆç‚¹è‡ƒè‚¿ï¼Œä½†æ˜¯ç¨åæˆ‘ä¼šç»™å¤§å®¶çœ‹å¦‚ä½•å†™çš„æ›´åŠ ä¼˜é›…ã€‚ï¼šï¼‰</p>
<p>ä¸»è¦æ€æƒ³ï¼š</p>
<pre><code>Â·ä¾‹å­åº”ç”¨ä¸ä¼šåœ¨æ¯æ¬¡ç”¨æˆ·ç¿»è½¬å±å¹•çš„æ—¶å€™é‡æ–°è¯·æ±‚ã€‚
Â·å¦‚æœçº¿ç¨‹è¢«é‡å¯ï¼Œå†æ¬¡åŠ è½½æ•°æ®ã€‚
Â·å½“MainActivityè¢«é”€æ¯åï¼ŒMainPresenterä¸ä¼šä¿æŒåº”ç”¨
</code></pre><p>MainActivityå®ä¾‹ï¼Œè¿™æ ·å½“æ—‹è½¬å±å¹•çš„æ—¶å€™å°±ä¸ä¼šå†…å­˜æ³„éœ²ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰å–æ¶ˆè¯·æ±‚ã€‚</p>
<p>##Nucleus</p>
<p>Nuleus æ˜¯æˆ‘åˆ›å»ºçš„ä¸€ä¸ªlibraryï¼Œçµæ„Ÿæ¥è‡ªäº<a href="https://github.com/square/mortar" target="_blank" rel="external">Mortar</a>libraryå’Œ<a href="https://people.apache.org/~fhanik/kiss.html" target="_blank" rel="external">Keep It Stupid Simple</a>è¿™ç¯‡æ–‡ç« ã€‚</p>
<p>ä¸‹é¢æ˜¯åŠŸèƒ½åˆ—è¡¨ï¼š</p>
<pre><code>Â·æ”¯æŒåœ¨View/Fragment/ActivityçŠ¶æ€Bundleä¸­save/restore Presenterçš„çŠ¶æ€ã€‚Presenterèƒ½å¤Ÿå­˜å‚¨è¯·æ±‚å‚æ•°åˆ°é‡æ–°å¯åŠ¨ã€‚

Â·æä¾›ä¸€ä¸ªå·¥å…·ï¼Œé€šè¿‡ä¸€è¡Œä»£ç å¯ä»¥æŠŠè¯·æ±‚ç»“æœå’Œé”™è¯¯æ”¾åˆ°æ­£ç¡®çš„viewå½“ä¸­å»ï¼Œå› æ­¤æ— éœ€å†å†™`ï¼=null`æ¥æ£€æŸ¥ã€‚

Â·ä¸€ä¸ªPresenterå¯ä»¥è¢«å¤šä¸ªviewå®ä¾‹å¼•ç”¨ã€‚å¦‚æœPresenterå®ä¾‹ä½¿ç”¨[Dagger]ï¼Œå°±ä¸èƒ½è¢«å¤šä¸ªviewå¼•ç”¨ã€‚

Â·é€šè¿‡ä¸€è¡Œä»£ç å°±å¯ä»¥æŠŠPresenterå’Œviewè¿›è¡Œç»‘å®šã€‚

Â·æä¾›viewçš„åŸºç±»ï¼šNucleusView, NucleusFragment, NucleusSupportFragment, NucleusActivityã€‚ä½ ä¹Ÿå¯ä»¥ä»ä»–ä»¬å½“ä¸­copyä»£ç åˆ°ä»»ä½•ç±»å½“ä¸­æ¥åˆ©ç”¨Nucleusçš„Presentersã€‚

Â·Presenteråœ¨çº¿ç¨‹é‡å¯ä¹‹åèƒ½å¤Ÿè‡ªåŠ¨restartã€‚åœ¨`onDestroy`è‡ªåŠ¨å–æ¶ˆæ³¨å†ŒRxJavaã€‚

Â·æœ€åï¼Œè¦ä¿æŒç®€å•æ˜äº†ï¼Œè®©æ¯ä¸€ä¸ªå¼€å‘è€…éƒ½èƒ½å¤Ÿçœ‹æ‡‚ã€‚è¿™é‡Œé€šè¿‡å¤§çº¦180è¡Œä»£ç æ¥é©±åŠ¨Presenterï¼Œ230è¡ŒRxJavaä»£ç æ¥æ”¯æŒã€‚
</code></pre><h2 id="ä½¿ç”¨Nuleusçš„ä¾‹å­02"><a href="#ä½¿ç”¨Nuleusçš„ä¾‹å­02" class="headerlink" title="ä½¿ç”¨Nuleusçš„ä¾‹å­02"></a>ä½¿ç”¨<a href="https://github.com/konmik/nucleus" target="_blank" rel="external">Nuleus</a>çš„<a href="https://github.com/konmik/MVPExamples/tree/master/example02" target="_blank" rel="external">ä¾‹å­02</a></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainPresenter</span> <span class="keyword">extends</span> <span class="title">RxPresenter</span>&lt;<span class="title">MainActivity</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_NAME = <span class="string">"Chuck Norris"</span>;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedState);</div><div class="line"></div><div class="line">        App.getServerAPI()</div><div class="line">            .getItems(DEFAULT_NAME.split(<span class="string">"\\s+"</span>)[<span class="number">0</span>], DEFAULT_NAME.split(<span class="string">"\\s+"</span>)[<span class="number">1</span>])</div><div class="line">            .delay(<span class="number">1</span>, TimeUnit.SECONDS)</div><div class="line">            .observeOn(AndroidSchedulers.mainThread())</div><div class="line">            .compose(<span class="keyword">this</span>.&lt;ServerAPI.Response&gt;deliverLatestCache())</div><div class="line">            .subscribe(<span class="keyword">new</span> Action1&lt;ServerAPI.Response&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(ServerAPI.Response response)</span> </span>&#123;</div><div class="line">                    getView().onItemsNext(response.items);</div><div class="line">                &#125;</div><div class="line">            &#125;, <span class="keyword">new</span> Action1&lt;Throwable&gt;() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Throwable throwable)</span> </span>&#123;</div><div class="line">                    getView().onItemsError(throwable);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@RequiresPresenter</span>(MainPresenter.class)</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">NucleusActivity</span>&lt;<span class="title">MainPresenter</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> ArrayAdapter&lt;ServerAPI.Item&gt; adapter;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.activity_main);</div><div class="line"></div><div class="line">        ListView listView = (ListView)findViewById(R.id.listView);</div><div class="line">        listView.setAdapter(adapter = <span class="keyword">new</span> ArrayAdapter&lt;&gt;(<span class="keyword">this</span>, R.layout.item));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemsNext</span><span class="params">(ServerAPI.Item[] items)</span> </span>&#123;</div><div class="line">        adapter.clear();</div><div class="line">        adapter.addAll(items);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemsError</span><span class="params">(Throwable throwable)</span> </span>&#123;</div><div class="line">        Toast.makeText(<span class="keyword">this</span>, throwable.getMessage(), Toast.LENGTH_LONG).show();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ­£å¦‚ä½ çœ‹åˆ°çš„ï¼Œè¿™ä¸ªä¾‹å­æ˜æ˜¾æ¯”å‰ä¸€ä¸ªä¾‹å­çŸ­ï¼Œå¹¶ä¸”ç®€æ´ã€‚Nucleusç”¨æ¥åˆ›å»ºï¼Œé”€æ¯ï¼Œä¿å­˜Presenterï¼Œ attache æˆ– detachedä¸€ä¸ªviewåˆ°Presenterï¼Œå¹¶ä¸”æŠŠè¯·æ±‚ç»“æœè‡ªåŠ¨å‘é€åˆ°è¢« attache çš„Viewå½“ä¸­ã€‚</p>
<p><code>MainPresenter</code>çš„ä»£ç æ¯”è¾ƒå°‘æ˜¯å› ä¸ºé€šè¿‡<code>deliverLatestCache()</code>æ“ä½œï¼ŒæœŸå»¶è¿Ÿäº†æ•°æ®å’Œé”™è¯¯ï¼Œç›´åˆ°viewæ˜¯å¯ç”¨çš„ï¼Œæ‰ä¼šæŠŠæ•°æ®å’Œé”™è¯¯é€åˆ°viewé‡Œã€‚å®ƒæŠŠæ•°æ®ç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œè¿™æ ·å½“configurationæ”¹å˜çš„æ—¶å€™ï¼Œæ•°æ®è¿˜æ˜¯å¯ç”¨çš„ã€‚</p>
<p><code>MainActivity</code>çš„ä»£ç æ¯”è¾ƒå°‘æ˜¯å› ä¸ºPresenterçš„åˆ›å»ºç”±<code>NucleusActivity</code>æ¥ç®¡ç†ã€‚æ‰€æœ‰ä½ éœ€è¦ç»‘å®špresenterçš„ç±»ï¼Œåªéœ€è¦åœ¨ç±»ä¸Šå£°æ˜<code>@RequiresPresenter(MainPresenter.class)</code>æ³¨é‡Šã€‚</p>
<p>è­¦å‘Šï¼æ³¨é‡Šï¼åœ¨Androidä¸–ç•Œä¸­ï¼Œå¦‚æœä½ ä½¿ç”¨æ³¨é‡Šï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åšæ³•ï¼Œè¿™ä¸ä¼šé™ä½æ€§èƒ½ã€‚æˆ‘å·²Galaxy Sï¼ˆ2010çš„è®¾å¤‡ï¼‰ä½œä¸ºåŸºå‡†æµ‹è¯•ï¼Œå¤„ç†æ³¨é‡Šåªä¼šèŠ±å»0.3msã€‚è¿™ç§æ³¨è§†åªä¼šå‘ç”Ÿåœ¨viewä¸­ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºæ³¨é‡Šæ˜¯å¯¹ç³»ç»Ÿæ€§èƒ½æ²¡æœ‰æ¶ˆè€—çš„ã€‚</p>
<p>##æ›´å¤šä¾‹å­</p>
<p>è¿™æ˜¯ä¸€ä¸ªå‚æ•°æŒä¹…æ€§çš„<a href="https://github.com/konmik/nucleus/tree/master/nucleus-example" target="_blank" rel="external">ä¾‹å­</a>ã€‚<a href="https://github.com/konmik/nucleus/tree/master/nucleus-example-with-tests" target="_blank" rel="external">æµ‹è¯•åˆ—å­</a>ã€‚</p>
<h2 id="deliverLatestCache-æ–¹æ³•"><a href="#deliverLatestCache-æ–¹æ³•" class="headerlink" title="deliverLatestCache()æ–¹æ³•"></a><code>deliverLatestCache()</code>æ–¹æ³•</h2><p>è¿™æ˜¯RxPresenterçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒæœ‰ä¸‰ç§ç‰ˆæœ¬ï¼š</p>
<p>Â·<code>deliver()</code>å»¶è¿ŸonNextï¼ŒonErrorå’ŒonCompleteåˆ°viewå˜æˆå¯ç”¨çš„æ‰ä¼šé‡Šæ”¾ã€‚å½“ä½ åšä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™å¯ä»¥ä½¿ç”¨å®ƒï¼Œä¾‹å¦‚ç™»å½•åˆ°web serviceã€‚<a href="http://konmik.github.io/nucleus/nucleus/presenter/RxPresenter.html#deliver(" target="_blank" rel="external">Javadoc</a>)</p>
<p>Â·<code>deliverLatest()</code>å¦‚æœæœ‰ä¸€ä¸ªæ–°çš„onNextå¯ç”¨ï¼Œå°†ä¼šæŠ›å¼ƒè€çš„onNextã€‚å¦‚æœä½ æœ‰æ•°æ®éœ€è¦æ›´æ–°ï¼Œè¿™å°†ä¸ä¼šç§¯ç´¯æ²¡æœ‰å¿…è¦çš„æ•°æ®ã€‚<a href="http://konmik.github.io/nucleus/nucleus/presenter/RxPresenter.html#deliverLatest(" target="_blank" rel="external">Javadoc</a>)</p>
<p>Â·<code>deliverLastestCache()</code>å’Œ<code>deliverLatest()</code>æ¯”è¾ƒç›¸ä¼¼ï¼Œå®ƒä¿å­˜æœ€åä¸€æ¬¡æ•°æ®åœ¨å†…å­˜ä¸­ï¼Œå½“å¦ä¸€ä¸ªviewå˜æˆå¯ç”¨çš„ï¼ˆä¾‹å¦‚ï¼šconfiguration æ”¹å˜ï¼‰ï¼Œå®ƒå°†é‡æ–°å‘é€æ•°æ®åˆ°viewã€‚å¦‚æœä½ ä¸æƒ³save/restoreè¯·æ±‚ç»“æœåˆ°ä½ çš„viewä¸­ï¼ˆè¿”å›ç»“æœæ¯”è¾ƒå¤§æˆ–è€…ä¸æ–¹ä¾¿å­˜å‚¨åˆ°Bundleä¸­ï¼‰ï¼Œè¿™ä¸ªæ–¹æ³•å°†å…è®¸ä½ å»åšå‡ºæ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚<a href="http://konmik.github.io/nucleus/nucleus/presenter/RxPresenter.html#deliverLatestCache(" target="_blank" rel="external">Javadoc</a>)</p>
<h2 id="Presenterçš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Presenterçš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Presenterçš„ç”Ÿå‘½å‘¨æœŸ"></a>Presenterçš„ç”Ÿå‘½å‘¨æœŸ</h2><p>Presenterçš„ç”Ÿå‘½å‘¨æœŸä¸Androidçš„æ§ä»¶ç›¸æ¯”ï¼Œæ˜æ˜¾å°‘ä¸€äº›ã€‚</p>
<p>Â·<code>void onCreate(Bundle savedState)</code> - å½“Presenterè¢«åˆ›å»ºçš„æ—¶å€™ä¼šè¢«è°ƒç”¨ã€‚<a href="http://konmik.github.io/nucleus/nucleus/presenter/Presenter.html#onCreate(android.os.Bundle" target="_blank" rel="external">Javadoc</a>)</p>
<p>Â·<code>void onDestroy()</code> - ç¦»å¼€viewçš„æ—¶å€™ä¼šè¢«è°ƒç”¨ã€‚<a href="http://konmik.github.io/nucleus/nucleus/presenter/Presenter.html#onDestroy(" target="_blank" rel="external">Javadoc</a>)</p>
<p>Â·<code>void onSave(Bundle state)</code> - å½“Viewçš„<code>onSaveInstanceState</code>è¢«è°ƒç”¨æ—¶ä¼šè°ƒç”¨ï¼Œä¿æŒPresenterçš„çŠ¶æ€ã€‚<a href="http://konmik.github.io/nucleus/nucleus/presenter/Presenter.html#onTakeView(ViewType" target="_blank" rel="external">Javadoc</a>)</p>
<p>Â·<code>void onTakeView(ViewType view)</code> -åœ¨Activityæˆ–è€…Fragmentè°ƒç”¨<code>onResume()</code>ï¼Œæˆ–è€…åœ¨<code>android.view.View#onAttachedToWindow()</code>æœŸé—´ã€‚ <a href="http://konmik.github.io/attachenucleus/nucleus/presenter/Presenter.html#onTakeView(ViewType" target="_blank" rel="external">Javadoc</a>)</p>
<p>Â·<code>void onDropView()</code> - Activityæˆ–è€…Fragmentè°ƒç”¨<code>onPause()</code>ï¼Œæˆ–è€…åœ¨<code>android.view.View#onDetachedFromWindow()</code>æœŸé—´ã€‚<a href="http://konmik.github.io/nucleus/nucleus/presenter/Presenter.html#onDropView(" target="_blank" rel="external">Javadoc</a>)</p>
<h2 id="Viewå›æ”¶å’ŒViewæ ˆ"><a href="#Viewå›æ”¶å’ŒViewæ ˆ" class="headerlink" title="Viewå›æ”¶å’ŒViewæ ˆ"></a>Viewå›æ”¶å’ŒViewæ ˆ</h2><p>é€šå¸¸ä½ çš„viewï¼ˆFragmentå’Œè‡ªå®šä¹‰viewï¼‰åœ¨ä¸ç”¨æˆ·çš„äº¤äº’ä¸‹éšæœº attache å’Œ detachedã€‚æ¯æ¬¡viewè¢« detachedçš„æ—¶å€™ä¸å»é”€æ¯Presenterï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚ä½ å¯ä»¥ä»»ä½•æ—¶é—´ detachedå’Œ attache viewï¼Œpresenterä¼šæ¯”è¿™äº›åŠ¨ä½œæ´»çš„æ›´æŒä¹…ï¼Œç»§ç»­åå°çš„å·¥ä½œã€‚</p>
<p>è”æƒ³åˆ°viewçš„å›æ”¶ï¼Œæœ‰ä¸ªé—®é¢˜ï¼šfragmentæ— æ³•çŸ¥é“æ˜¯å¦å› ä¸ºé…ç½®æ”¹å˜æˆ–è€…è¢«å¼¹å‡ºæ ˆè¢« detachedã€‚</p>
<p>Nucleusçš„æ„è§æ˜¯ï¼šé”€æ¯presenteråªèƒ½å‘ç”Ÿåœ¨viewçš„<code>onDetachedFromWindow()/onDestroy()</code>å¹¶ä¸”activityæ˜¯finishçš„ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ é”€æ¯viewæ˜¯åœ¨æ­£å¸¸çš„activityç”Ÿå‘½å‘¨æœŸï¼Œä½ å¯å‘å‡ºä¿¡å·æ¥é€šçŸ¥presenterä¹Ÿåº”è¯¥è¢«é”€æ¯ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ç”¨<code>NucleusLayout.destroyPresenter()</code>å’Œ<code>NucleusFragment.destroyPresenter()</code>ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢æ˜¯æˆ‘åœ¨æˆ‘çš„é¡¹ç›®é‡Œé¢å¦‚ä½•ç®¡ç†Fragment <code>pop()</code>æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">fragment = fragmentManager.findFragmentById(R.id.fragmentStackContainer);</div><div class="line">   fragmentManager.popBackStackImmediate();</div><div class="line">   <span class="keyword">if</span> (fragment <span class="keyword">instanceof</span> NucleusFragment)</div><div class="line">       ((NucleusFragment)fragment).destroyPresenter();</div></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥å¯¹replace Fragmentåšç±»ä¼¼çš„æ“ä½œã€‚å‹æ ˆæ“ä½œçš„æ—¶å€™ä¹Ÿå¯ä»¥ã€‚</p>
<p>æ¯æ¬¡viewä»Activity detachedçš„æ—¶å€™ï¼Œä½ å¯ä»¥å†³å®šå»é”€æ¯presenteræ¥é¿å…è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯ä½ ä¹Ÿå°†åœ¨viewè¢«detachçš„æ—¶å€™å¤±å»åå°ä»»åŠ¡ã€‚</p>
<p>å› æ­¤ï¼Œviewå›æ”¶è¿™éƒ¨åˆ†ï¼Œå®Œå…¨å–å†³äºä½ ã€‚ä¹Ÿè®¸ï¼Œæˆ‘ä¼šæ‰¾åˆ°æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚æœä½ çŸ¥é“ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚</p>
<h1 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h1><h2 id="æŠŠä½ çš„è¯·æ±‚å‚æ•°æ”¾åœ¨Presenteré‡Œ"><a href="#æŠŠä½ çš„è¯·æ±‚å‚æ•°æ”¾åœ¨Presenteré‡Œ" class="headerlink" title="æŠŠä½ çš„è¯·æ±‚å‚æ•°æ”¾åœ¨Presenteré‡Œ"></a>æŠŠä½ çš„è¯·æ±‚å‚æ•°æ”¾åœ¨Presenteré‡Œ</h2><p>è¿™ä¸ªè§„åˆ™å¾ˆç®€å•ï¼šä¸»è¦æ˜¯ä¸ºäº†ç®¡ç†è¯·æ±‚ã€‚æ‰€ä»¥viewè‡ªå·±ä¸åº”è¯¥æŒæ§å’Œé‡å¯è¯·æ±‚ã€‚ä»Viewçš„è§’åº¦æ¥çœ‹ï¼Œåå°ä»»åŠ¡ï¼Œæ°¸è¿œä¸ä¼šæ¶ˆå¤±ï¼Œä¸éœ€è¦ä»»ä½•å›è°ƒä¹Ÿä¼šè¿”å›ä¸€ä¸ªç»“æœæˆ–é”™è¯¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainPresenter</span> <span class="keyword">extends</span> <span class="title">RxPresenter</span>&lt;<span class="title">MainActivity</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String name = DEFAULT_NAME;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedState);</div><div class="line">        <span class="keyword">if</span> (savedState != <span class="keyword">null</span>)</div><div class="line">            name = savedState.getString(NAME_KEY);</div><div class="line">        ...</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onSave</span><span class="params">(@NonNull Bundle state)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onSave(state);</div><div class="line">        state.putString(NAME_KEY, name);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æˆ‘å»ºè®®ä½¿ç”¨<a href="https://github.com/frankiesardo/icepick" target="_blank" rel="external">Icepick</a>libraryã€‚æ— éœ€ä½¿ç”¨æ³¨è§£ï¼Œå°±å¯ä»¥å‡å°‘ä»£ç é‡ï¼Œå¹¶ä¸”ç®€åŒ–åº”ç”¨é€»è¾‘â€”â€”è¿™ä¸€åˆ‡éƒ½å‘ç”Ÿåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ã€‚å¯ä»¥é…åˆ<a href="http://jakewharton.github.io/butterknife" target="_blank" rel="external">ButterKnife</a>ä½¿ç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainPresenter</span> <span class="keyword">extends</span> <span class="title">RxPresenter</span>&lt;<span class="title">MainActivity</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Icicle</span> String name = DEFAULT_NAME;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedState);</div><div class="line">        Icepick.restoreInstanceState(<span class="keyword">this</span>, savedState);</div><div class="line">        ...</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onSave</span><span class="params">(@NonNull Bundle state)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onSave(state);</div><div class="line">        Icepick.saveInstanceState(<span class="keyword">this</span>, state);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ æœ‰è¶…è¿‡2ä¸ªçš„è¯·æ±‚å‚æ•°ï¼Œè¿™ä¸ªlibraryä¼šå­˜å‚¨å®ƒä»¬ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª<code>BasePresenter</code>ï¼Œå¹¶ä¸”æŠŠIcepickæ”¾åœ¨ç±»é‡Œï¼Œè¿™æ ·æ‰€æœ‰çš„å­ç±»å°†ä¼šè·å¾—<code>@Icicle</code>ï¼Œæ— éœ€å†æ¬¡å®ç°<code>onSave</code>ã€‚è¿™ä¹Ÿå·¥ä½œåœ¨activityï¼ŒFragmentå’Œviewã€‚</p>
<h2 id="åœ¨onTakeViewä¸»çº¿ç¨‹ä¸­ï¼Œæ‰§è¡Œä¸€ä¸ªå³æ—¶æŸ¥è¯¢Javadoc"><a href="#åœ¨onTakeViewä¸»çº¿ç¨‹ä¸­ï¼Œæ‰§è¡Œä¸€ä¸ªå³æ—¶æŸ¥è¯¢Javadoc" class="headerlink" title="åœ¨onTakeViewä¸»çº¿ç¨‹ä¸­ï¼Œæ‰§è¡Œä¸€ä¸ªå³æ—¶æŸ¥è¯¢Javadoc)"></a>åœ¨onTakeViewä¸»çº¿ç¨‹ä¸­ï¼Œæ‰§è¡Œä¸€ä¸ªå³æ—¶æŸ¥è¯¢<a href="http://konmik.github.io/nucleus/nucleus/presenter/Presenter.html#onTakeView(ViewType" target="_blank" rel="external">Javadoc</a>)</h2><p>æœ‰æ—¶å€™ï¼Œä½ è¦æŸ¥è¯¢ä¸€æ®µå°æ•°æ®ï¼Œä¾‹å¦‚ä»æ•°æ®åº“ä¸­è¯»å–ä¸€å°æ®µæ•°æ®ã€‚è™½ç„¶ä½ å¯ä»¥ç”¨Nucleusç®€å•çš„åˆ›å»ºä¸€ä¸ªè¯·æ±‚ï¼Œä½†æ˜¯ä½ ä¸å¿…åˆ°å¤„ä½¿ç”¨Nucleusã€‚å¦‚æœåœ¨ä¸€ä¸ªFragmentåˆ›å»ºçš„è¿‡ç¨‹ä¸­åˆ›å»ºä¸€ä¸ªåå°è¯·æ±‚ï¼Œç”¨æˆ·ä¼šçœ‹åˆ°ä¸€ä¸ªç©ºç™½å±å¹•ä¸€å°ä¼šå„¿ï¼Œå°½ç®¡è¿™ä¸ªè¯·æ±‚å°±å‡ æ¯«ç§’ã€‚å› æ­¤ï¼Œä¸ºäº†æ˜¯ä»£ç æ›´ç®€çŸ­ï¼Œæ›´å‹å–„ï¼Œä½¿ç”¨ä¸»çº¿ç¨‹å§ã€‚</p>
<h2 id="ä¸è¦å°è¯•ç”¨Presenteræ§åˆ¶ä½ çš„View"><a href="#ä¸è¦å°è¯•ç”¨Presenteræ§åˆ¶ä½ çš„View" class="headerlink" title="ä¸è¦å°è¯•ç”¨Presenteræ§åˆ¶ä½ çš„View"></a>ä¸è¦å°è¯•ç”¨Presenteræ§åˆ¶ä½ çš„View</h2><p>è¿™ä¹ˆåšä¸æ˜¯ä¸ªå¥½æ–¹å¼â€”â€”åº”ç”¨çš„é€»è¾‘ä¼šå˜å¾—æ›´å¤æ‚ï¼Œè¿™æ˜¯ä¸æ­£å¸¸çš„æ–¹å¼ã€‚</p>
<p>æ­£å¸¸çš„æ–¹å¼æ˜¯ï¼Œæ§åˆ¶æµåº”è¯¥æ˜¯ä»ç”¨æˆ·ï¼Œé€šè¿‡Viewï¼Œåˆ°Presenterï¼Œå†åˆ°Modelã€‚ç”¨æˆ·æ˜¯æ§åˆ¶åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªæ¥æºã€‚å› æ­¤æˆ‘ä»¬çš„æ§åˆ¶æµåº”è¯¥æ˜¯ä»ç”¨æˆ·å¼€å§‹ï¼Œè€Œä¸æ˜¯ä»åº”ç”¨çš„å†…éƒ¨çš„ç»“æ„ã€‚</p>
<p>å½“æ§åˆ¶æµæ˜¯ä»Viewåˆ°Presenterï¼Œç„¶åPresenteråˆ°Modelï¼Œè¿™æ˜¯ä¸€ä¸ªçº¿æ€§æµï¼Œè¿™æ ·å¾ˆå¥½å†™ä»£ç ã€‚è¿™æ ·ä½ å¾—åˆ°äº†ä¸€ä¸ªç®€å•çš„åºåˆ—ï¼Œuser-&gt;view-&gt;presenter-&gt;model-&gt;dataã€‚ä½†æ˜¯ï¼Œå½“æ§åˆ¶æµæ˜¯è¿™ä¸ªæ ·å­çš„ï¼šuser-&gt;view-&gt;presenter-&gt;view-&gt;presenter-&gt;model-&gt;dataï¼Œè¿™åªæ˜¯è¿åäº†KISSåŸåˆ™ã€‚</p>
<p>Fragmentï¼Ÿæ˜¯çš„ï¼ŒFragmentæœ‰æ—¶å€™ä¼šè¿åæ­£å¸¸çš„æ§åˆ¶æµã€‚ä»–ä»¬å¤ªå¤æ‚äº†ã€‚è¿™é‡Œæœ‰ä¸€ç¯‡ä¸é”™çš„æ–‡ç« ï¼Œå…³äºæ€è€ƒFragmentï¼š<a href="http://corner.squareup.com/2014/10/advocating-against-android-fragments.html" target="_blank" rel="external">Advocating Against Android Fragments</a>ã€‚ä½†æ˜¯<a href="https://github.com/square/flow" target="_blank" rel="external">Flow</a>ä¹Ÿæ²¡æœ‰ç®€åŒ–å¤ªå¤šã€‚</p>
<h2 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h2><p>å¦‚æœä½ ç†Ÿæ‚‰MVCï¼Œåˆ«ç”¨äº†ã€‚MVCå®Œå…¨ä¸åŒäºMVPï¼ŒMVCå¹¶æ²¡æœ‰è§£å†³å¼€å‘é¢ä¸´çš„é—®é¢˜ã€‚</p>
<p>ä»€ä¹ˆæ˜¯MVCï¼Ÿ</p>
<pre><code>Â·Modelåº”ç”¨å†…éƒ¨çš„é€»è¾‘éƒ¨åˆ†ã€‚è´Ÿè´£æ•°æ®å­˜å‚¨ã€‚
Â·Viewå”¯ä¸€å’ŒMVPå…±åŒçš„éƒ¨åˆ†ï¼Œåº”ç”¨ä¸­å‘ˆç°åˆ°å±å¹•çš„éƒ¨åˆ†ã€‚
Â·Controllerè¾“å…¥è®¾å¤‡ï¼Œä¾‹å¦‚é”®ç›˜ï¼Œé¼ æ ‡ï¼Œæ“çºµæ†ã€‚
</code></pre><p>å½“ä½ æœ‰ä¸€å°ç”µè„‘å’Œä¸€ä¸ªç”¨é”®ç›˜ç®€å•é©±åŠ¨çš„æ¸¸æˆçš„æ—¶å€™ï¼ŒMVCå‡ºç°æœ‰å¾ˆé•¿ä¸€æ®µæ—¶é—´äº†ã€‚æ²¡æœ‰windowsï¼Œæ²¡æœ‰å›¾å½¢äº¤äº’ç•Œé¢ï¼Œåº”ç”¨ç¨‹åºæ¥æ”¶è¾“å…¥ï¼ˆControllerï¼‰ï¼Œç»´æŒä¸€äº›çŠ¶æ€ï¼ˆModelï¼‰ï¼Œäº§ç”Ÿè¾“å‡ºï¼ˆViewï¼‰ã€‚æ§åˆ¶æµæ˜¯è¿™æ ·çš„ï¼šController-&gt;Model-&gt;Viewã€‚è¿™ç§æ¨¡å¼ç»å¯¹ä¸èƒ½ç”¨åœ¨Androidä¸­ã€‚</p>
<p>æœ‰å¾ˆå¤šæ··æ·†çš„MVCæ¨¡å¼ã€‚äººä»¬ç›¸ä¿¡ä»–ä»¬ä½¿ç”¨çš„æ˜¯MVCï¼Œå®é™…ä¸Šä»–ä»¬å¯èƒ½ç”¨çš„æ˜¯MVPï¼ˆWebå¼€å‘ï¼‰ã€‚å¾ˆå¤šAndroidå¼€å‘ï¼Œè®¤ä¸ºControllerå°±æ˜¯æ§åˆ¶Viewï¼Œå› æ­¤ä»–ä»¬å°è¯•æŠ½å–Viewçš„é€»è¾‘ä»£ç æ¥å‡å°‘Viewçš„ä»£ç ï¼Œç”¨Controlleræ¥æ§åˆ¶Viewã€‚æˆ‘ä¸ªäººæ²¡çœ‹åˆ°è¿™ç§æ–¹å¼æœ‰ä»»ä½•å¥½å¤„ã€‚</p>
<h2 id="ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„çš„å¤æ‚å…³ç³»æ•°æ®åº“é¡¹ç›®"><a href="#ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„çš„å¤æ‚å…³ç³»æ•°æ®åº“é¡¹ç›®" class="headerlink" title="ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„çš„å¤æ‚å…³ç³»æ•°æ®åº“é¡¹ç›®"></a>ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„çš„å¤æ‚å…³ç³»æ•°æ®åº“é¡¹ç›®</h2><p><a href="https://github.com/google/auto/tree/master/value" target="_blank" rel="external">AutoValue</a>æ˜¯ä¸€ä¸ªè¿™æ ·çš„libraryï¼Œåœ¨å®ƒçš„æè¿°ä¸­å†™äº†ä¸€å †å¥½å¤„ï¼Œæˆ‘æ¨èçœ‹çœ‹å®ƒã€‚<a href="https://github.com/frankiesardo/auto-parcel" target="_blank" rel="external">AutoParcel</a>æ˜¯AutoValueä¸€ä¸ªAndroidé¡¹ç›®ã€‚ä½¿ç”¨çš„ä¸»è¦åŸå› æ˜¯ï¼Œä¸ç”¨æ”¹å˜å¯¹è±¡ï¼Œé€šè¿‡AutoParcelè½¬æ¢ï¼Œè€Œä¸ç”¨å…³å¿ƒå…¶å½±å“äº†åº”ç”¨ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ã€‚ä»–ä»¬éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
<h1 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h1><p>å°è¯•MVPï¼Œå¹¶ä¸”åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚ï¼šï¼‰</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘å­¦ä¹ MVPæ¨¡å¼æ—¶ç¿»è¯‘çš„ï¼ŒåŸæ–‡æ˜¯&lt;a href=&quot;http://konmik.github.io/author/konstantin-mikheev.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Konstantin Mikheev&lt;/
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://www.kennethyo.me/tags/Android/"/>
    
      <category term="MVP" scheme="http://www.kennethyo.me/tags/MVP/"/>
    
  </entry>
  
  <entry>
    <title>[åŸ]Androidè·å–è¿è¥å•†</title>
    <link href="http://www.kennethyo.me/2015/05/08/2015-05-08/"/>
    <id>http://www.kennethyo.me/2015/05/08/2015-05-08/</id>
    <published>2015-05-08T08:40:08.000Z</published>
    <updated>2016-09-01T06:39:08.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©æ¥åˆ°ä¸€ä¸ªæ–°éœ€æ±‚ï¼Œè¦ç»™æœåŠ¡å™¨ä¸Šé€è®¾å¤‡è¿è¥å•†åç§°ï¼Œä¹‹åæˆ‘çš„ç¬¬ä¸€ååº”æ˜¯ï¼Œumengéƒ½æ— æ³•ç²¾ç¡®ç»Ÿè®¡è¿è¥å•†ï¼Œæˆ‘å¦‚ä½•åˆ¤æ–­ä¸Šé€å…·ä½“çš„è¿è¥å•†å‘¢ï¼Ÿå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://img.blog.csdn.net/20150508163804803" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p>è¿™å¼ å›¾é‡Œåæ˜ äº†å‹ç›Ÿç»Ÿè®¡åˆ°ç”¨æˆ·æ‰‹æœºçš„è¿è¥å•†åç§°ï¼Œè¿™äº›åç§°ä»€ä¹ˆæ ·å­çš„éƒ½æœ‰ã€‚æœ‰ä»€ä¹ˆåŠæ³•ç²¾ç¡®åˆ¤æ–­å…·ä½“æ˜¯ä»€ä¹ˆè¿è¥å•†å‘¢ï¼Ÿæ¯”å¦‚ï¼Œåªè¿”å›â€œä¸­å›½ç§»åŠ¨â€ï¼Œâ€œä¸­å›½è”é€šâ€ï¼Œâ€œä¸­å›½ç”µä¿¡â€ã€‚</p>
<p>æˆ‘è¿™é‡Œè§£å†³çš„æ–¹æ¡ˆæ˜¯é€šè¿‡è®¾å¤‡çš„MCC/MNCä»£ç æ¥åˆ¤æ–­ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦äº†è§£MCC/MNCæ˜¯ä»€ä¹ˆï¼Œè¯·çœ‹<a href="http://zh.wikipedia.org/wiki/%E7%A7%BB%E5%8A%A8%E8%AE%BE%E5%A4%87%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%A0%81" target="_blank" rel="external">WIKIç™¾ç§‘</a>ã€‚é€šè¿‡é˜…è¯»ï¼Œæˆ‘ä»¬èƒ½å¤ŸçŸ¥é“ï¼Œåªè¦å¯¹æ¯”MCC/MNCç¼–ç ï¼Œå°±èƒ½çŸ¥é“å…·ä½“æ˜¯ä»€ä¹ˆè¿è¥å•†äº†ã€‚</p>
<p>å…¶æ¬¡ï¼Œå°±æ˜¯å…·ä½“ä»£ç äº†ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code>&lt;span class=&quot;hljs-javadoc&quot;&gt;/**
     * è¿”å›è¿è¥å•† éœ€è¦åŠ å…¥æƒé™ &amp;lt;uses-permission android:name=&quot;android.permission.READ_PHONE_STATE&quot;/&amp;gt; &amp;lt;BR&amp;gt;
     *
     *&lt;span class=&quot;hljs-javadoctag&quot;&gt; @return&lt;/span&gt; 1,ä»£è¡¨ä¸­å›½ç§»åŠ¨ï¼Œ2ï¼Œä»£è¡¨ä¸­å›½è”é€šï¼Œ3ï¼Œä»£è¡¨ä¸­å›½ç”µä¿¡ï¼Œ0ï¼Œä»£è¡¨æœªçŸ¥
     *&lt;span class=&quot;hljs-javadoctag&quot;&gt; @author&lt;/span&gt; youzc@yiche.com
     */&lt;/span&gt;
 &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getOperators&lt;/span&gt;(Context context) {
        &lt;span class=&quot;hljs-comment&quot;&gt;// ç§»åŠ¨è®¾å¤‡ç½‘ç»œä»£ç ï¼ˆè‹±è¯­ï¼šMobile Network Codeï¼ŒMNCï¼‰æ˜¯ä¸ç§»åŠ¨è®¾å¤‡å›½å®¶ä»£ç ï¼ˆMobile Country Codeï¼ŒMCCï¼‰ï¼ˆä¹Ÿç§°ä¸ºâ€œMCC /&lt;/span&gt;
        &lt;span class=&quot;hljs-comment&quot;&gt;// MNCâ€ï¼‰ç›¸ç»“åˆ, ä¾‹å¦‚46000ï¼Œå‰ä¸‰ä½æ˜¯MCCï¼Œåä¸¤ä½æ˜¯MNC è·å–æ‰‹æœºæœåŠ¡å•†ä¿¡æ¯&lt;/span&gt;
        &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; OperatorsName = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;
        String IMSI =  (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE).getSubscriberId();
        &lt;span class=&quot;hljs-comment&quot;&gt;// IMSIå·å‰é¢3ä½460æ˜¯å›½å®¶ï¼Œç´§æ¥ç€åé¢2ä½00 è¿è¥å•†ä»£ç &lt;/span&gt;
        System.out.println(IMSI);
        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (IMSI.startsWith(&lt;span class=&quot;hljs-string&quot;&gt;&quot;46000&quot;&lt;/span&gt;) || IMSI.startsWith(&lt;span class=&quot;hljs-string&quot;&gt;&quot;46002&quot;&lt;/span&gt;) || IMSI.startsWith(&lt;span class=&quot;hljs-string&quot;&gt;&quot;46007&quot;&lt;/span&gt;)) {
            OperatorsName = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;
        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (IMSI.startsWith(&lt;span class=&quot;hljs-string&quot;&gt;&quot;46001&quot;&lt;/span&gt;) || IMSI.startsWith(&lt;span class=&quot;hljs-string&quot;&gt;&quot;46006&quot;&lt;/span&gt;)) {
            OperatorsName = &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;;
        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (IMSI.startsWith(&lt;span class=&quot;hljs-string&quot;&gt;&quot;46003&quot;&lt;/span&gt;) || IMSI.startsWith(&lt;span class=&quot;hljs-string&quot;&gt;&quot;46005&quot;&lt;/span&gt;)) {
            OperatorsName = &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;
        }
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; OperatorsName;
    }
</code></pre><p>é€šè¿‡å®¢æˆ·ç«¯æœ¬åœ°æ¯”å¯¹MCC/MNCç¡®å®šè¿è¥å•†è¿™ç§æ–¹å¼ï¼Œæœ¬èº«æˆ‘æ˜¯ä¸èµåŒçš„ï¼Œæˆ‘è®¤ä¸ºæŠŠMCC/MNCä¸Šé€åˆ°æœåŠ¡å™¨ï¼Œç”±æœåŠ¡å™¨åˆ¤æ–­è¿™æ‰æ˜¯æœ€ä¼˜æ–¹æ¡ˆã€‚å› ä¸ºåº”ç”¨æ‰“å¥½åŒ…åˆ†å‘å‡ºå»ï¼Œä»£ç å°±æ˜¯æ­»çš„ï¼Œæœªæ¥ä¸å¯ä»¥æ‰©å±•æ¯”å¯¹ï¼Œä½†æ˜¯æœåŠ¡å™¨æ˜¯å¯ä»¥åŠ¨æ€çš„ï¼Œéšæ—¶é…ç½®æ¯”å¯¹çš„MCC/MNCç¼–ç ã€‚</p>
<pre><code>&lt;div&gt;
    ä½œè€…ï¼šzh08070005 å‘è¡¨äº2015/5/8 16:40:08 [åŸæ–‡é“¾æ¥](http://blog.csdn.net/kennethyo/article/details/45582153)
&lt;/div&gt;
&lt;div&gt;
é˜…è¯»ï¼š814 è¯„è®ºï¼š0 [æŸ¥çœ‹è¯„è®º](http://blog.csdn.net/kennethyo/article/details/45582153#comments)
&lt;/div&gt;
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»Šå¤©æ¥åˆ°ä¸€ä¸ªæ–°éœ€æ±‚ï¼Œè¦ç»™æœåŠ¡å™¨ä¸Šé€è®¾å¤‡è¿è¥å•†åç§°ï¼Œä¹‹åæˆ‘çš„ç¬¬ä¸€ååº”æ˜¯ï¼Œumengéƒ½æ— æ³•ç²¾ç¡®ç»Ÿè®¡è¿è¥å•†ï¼Œæˆ‘å¦‚ä½•åˆ¤æ–­ä¸Šé€å…·ä½“çš„è¿è¥å•†å‘¢ï¼Ÿå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150508163804803&quot; alt=&quot;
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://www.kennethyo.me/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>[åŸ]WebViewå¡«å‘â€”â€”å°åŠŸèƒ½ç¯‡</title>
    <link href="http://www.kennethyo.me/2015/04/22/2015-04-22-16-31-06/"/>
    <id>http://www.kennethyo.me/2015/04/22/2015-04-22-16-31-06/</id>
    <published>2015-04-22T08:31:06.000Z</published>
    <updated>2017-03-06T11:06:45.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸¤å¤©è´Ÿè´£ä¿®æ”¹äº†å‡ ä¸ªå…³äºåœ¨webviewä¸­æ‰“å¼€å…¬å¸ç§»åŠ¨ç«™çš„bugã€‚æœ¬èº«ä¸æ˜¯å¾ˆéš¾è§£ï¼Œç½‘ä¸ŠæŸ¥æŸ¥éƒ½æœ‰ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¿…è¦è®°å½•ä¸‹æ¥ä½œä¸ºå¤‡å¿˜ã€‚</p>
<h3 id="Webviewä¸­ä¸Šä¼ æ–‡ä»¶"><a href="#Webviewä¸­ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="Webviewä¸­ä¸Šä¼ æ–‡ä»¶"></a>Webviewä¸­ä¸Šä¼ æ–‡ä»¶</h3><p>è¿™é‡Œçš„æ•ˆæœç±»ä¼¼åœ¨pcç«¯ä¸Šä¼ æ–‡ä»¶æ•ˆæœï¼Œç‚¹å‡»æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶é€‰æ‹©å™¨ï¼Œä¸Šä¼ æ–‡ä»¶å›¾ç‰‡ä¹‹ç±»çš„ã€‚</p>
<p><code>openFileChooserï¼ˆï¼‰</code>æ–¹æ³•çš„é‡è½½æ˜¯å› ä¸ºåœ¨ä¸åŒç³»ç»Ÿä¸­è°ƒç”¨çš„æ–¹æ³•å‚æ•°ä¸ä¸€æ ·ï¼Œå…·ä½“çœ‹æ³¨é‡Šã€‚</p>
<p><code>ValueCallback&amp;lt;Uri&amp;gt; mUploadMessage</code>ä½œä¸ºæˆå‘˜å˜é‡çš„ç›®çš„æ˜¯æˆ‘ä»¬è¦åœ¨æ‰“å¼€çš„ç³»ç»Ÿæ–‡ä»¶é€‰æ‹©å™¨<code>finish()</code>ååœ¨<code>onActivityResult()</code>æ—¶è°ƒç”¨ã€‚</p>
<p>å…·ä½“å®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;initWebView&lt;/span&gt;(){
    webView.setWebChromeClient(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; MyWebChromeClient());
}

 &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; ValueCallback&amp;lt;Uri&amp;gt; mUploadMessage;
&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MyWebChromeClient&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;WebChromeClient&lt;/span&gt; {&lt;/span&gt;

    &lt;span class=&quot;hljs-comment&quot;&gt;// jsä¸Šä¼ æ–‡ä»¶çš„&amp;lt;input type=&quot;file&quot; /&amp;gt;äº‹ä»¶æ•è·&lt;/span&gt;
    &lt;span class=&quot;hljs-comment&quot;&gt;// Android &amp;gt; 4.1.1 è°ƒç”¨è¿™ä¸ªæ–¹æ³•&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;openFileChooser&lt;/span&gt;(ValueCallback&amp;lt;Uri&amp;gt; uploadMsg, String acceptType, String capture) {
      mUploadMessage = uploadMsg;

      Intent intent = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Intent(Intent.ACTION_GET_CONTENT);
      intent.addCategory(Intent.CATEGORY_OPENABLE);
      intent.setType(TextUtils.isEmpty(acceptType) ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;image/*&quot;&lt;/span&gt; : acceptType);

      MobileSiteActivity.&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.startActivityForResult(
          Intent.createChooser(intent, ToolBox.getString(R.string.web_activity_please_chooser)),
          MobileSiteActivity.FILECHOOSER_RESULTCODE);

    }

    &lt;span class=&quot;hljs-comment&quot;&gt;// 3.0 + è°ƒç”¨è¿™ä¸ªæ–¹æ³•&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;openFileChooser&lt;/span&gt;(ValueCallback&amp;lt;Uri&amp;gt; uploadMsg, String acceptType) {
      openFileChooser(uploadMsg, acceptType, &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;);
    }

    &lt;span class=&quot;hljs-comment&quot;&gt;// Android &amp;lt; 3.0 è°ƒç”¨è¿™ä¸ªæ–¹æ³•&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;openFileChooser&lt;/span&gt;(ValueCallback&amp;lt;Uri&amp;gt; uploadMsg) {
      openFileChooser(uploadMsg, &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;);
    }
  }
  &lt;span class=&quot;hljs-annotation&quot;&gt;@Override&lt;/span&gt;
  &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onActivityResult&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; requestCode, &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; resultCode, Intent data) {
    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (FILECHOOSER_RESULTCODE == requestCode) {
      &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; == mUploadMessage) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;
      Uri result = data == &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; || resultCode != RESULT_OK ? &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; : data.getData();
      mUploadMessage.onReceiveValue(result);
      mUploadMessage = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;
      &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;
    }
  }
`&lt;/pre&gt;

### WebViewå½“ä¸­ç½‘é¡µä¸­çš„åœ°å›¾ä¸ºç™½è‰²ï¼Œä¸æ˜¾ç¤ºåœ°å›¾

è¿™ä¸ªé—®é¢˜å…¶å®å°±æ˜¯ä½ æ²¡æœ‰æ‰“å¼€Javascriptæ”¯æŒã€‚æ‰“å¼€å°±å¥½å•¦~

&lt;pre class=&quot;prettyprint&quot;&gt;`webView.setJavaScriptEnabled(&lt;span class=&quot;hljs-keyword&quot;&gt;true&lt;/span&gt;);&lt;span class=&quot;hljs-comment&quot;&gt;// è®¾ç½®æ”¯æŒjavascriptè„šæœ¬&lt;/span&gt;`&lt;/pre&gt;

### WebViewä¸­è·³è½¬ç³»ç»Ÿæ‹¨å·é”®ç›˜

ä¸¾ä¸€åä¸‰ï¼Œæ—¢ç„¶è¦æ‰“å¼€ç³»ç»Ÿæ‹¨å·é”®ç›˜ï¼Œé‚£é‚®ç®±ï¼Œåœ°å›¾ä¹Ÿå¯ä»¥æ”¯æŒã€‚

&lt;pre class=&quot;prettyprint&quot;&gt;`webView.setWebViewClient(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; WebViewClient() {
      &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;shouldOverrideUrlLoading&lt;/span&gt;(WebView view, String url) {

        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (url.startsWith(&lt;span class=&quot;hljs-string&quot;&gt;&quot;mailto:&quot;&lt;/span&gt;) || url.startsWith(&lt;span class=&quot;hljs-string&quot;&gt;&quot;geo:&quot;&lt;/span&gt;) || url.startsWith(&lt;span class=&quot;hljs-string&quot;&gt;&quot;tel:&quot;&lt;/span&gt;)) {
          Intent intent = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Intent(Intent.ACTION_VIEW, Uri.parse(url));
          startActivity(intent);
          &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;true&lt;/span&gt;;
        }
        view.loadUrl(url);
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;true&lt;/span&gt;;
      }
    });`&lt;/pre&gt;

### WebViewä¸­æ”¯æŒä¸‹è½½

è¿™é‡Œè¦ç»™WebViewè®¾ç½®ä¸€ä¸ªä¸‹è½½ç›‘å¬ï¼Œç›‘å¬ä¼šå›è°ƒç»™ä½ ä¸‹è½½åœ°å€ï¼Œè¿™é‡Œå¯ä»¥æ‰“å¼€ç³»ç»Ÿæµè§ˆå™¨å»æ¿€æ´»ä¸‹è½½ï¼Œç”¨DownloadMangerç›´æ¥å»ä¸‹è½½ä¹Ÿå¯ä»¥ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯ç¬¬ä¸€ç§æ–¹å¼ï¼Œè¿™ç§æ–¹å¼æˆ‘è®¤ä¸ºæ¯”è¾ƒç¬¦åˆç”¨æˆ·ä¹ æƒ¯å“ˆã€‚

&lt;pre class=&quot;prettyprint&quot;&gt;` webView.setDownloadListener(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; MyWebViewDownLoadListener());`&lt;/pre&gt;

&lt;pre class=&quot;prettyprint&quot;&gt;`
 &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MyWebViewDownLoadListener&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DownloadListener&lt;/span&gt; {&lt;/span&gt;

    &lt;span class=&quot;hljs-annotation&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;onDownloadStart&lt;/span&gt;(String url, String userAgent, String contentDisposition,
        String mimetype, &lt;span class=&quot;hljs-keyword&quot;&gt;long&lt;/span&gt; contentLength) {

      &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt; != url) {
        Uri uri = Uri.parse(url);
        Intent intent = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Intent(Intent.ACTION_VIEW, uri);
        startActivity(intent);
      }
    }

  }

        &lt;div&gt;
            ä½œè€…ï¼šzh08070005 å‘è¡¨äº2015/4/22 16:31:06 [åŸæ–‡é“¾æ¥](http://blog.csdn.net/kennethyo/article/details/45196891)
        &lt;/div&gt;
        &lt;div&gt;
        é˜…è¯»ï¼š521 è¯„è®ºï¼š0 [æŸ¥çœ‹è¯„è®º](http://blog.csdn.net/kennethyo/article/details/45196891#comments)
        &lt;/div&gt;
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™ä¸¤å¤©è´Ÿè´£ä¿®æ”¹äº†å‡ ä¸ªå…³äºåœ¨webviewä¸­æ‰“å¼€å…¬å¸ç§»åŠ¨ç«™çš„bugã€‚æœ¬èº«ä¸æ˜¯å¾ˆéš¾è§£ï¼Œç½‘ä¸ŠæŸ¥æŸ¥éƒ½æœ‰ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¿…è¦è®°å½•ä¸‹æ¥ä½œä¸ºå¤‡å¿˜ã€‚&lt;/p&gt;
&lt;h3 id=&quot;Webviewä¸­ä¸Šä¼ æ–‡ä»¶&quot;&gt;&lt;a href=&quot;#Webviewä¸­ä¸Šä¼ æ–‡ä»¶&quot; class=&quot;headerlink&quot; titl
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://www.kennethyo.me/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>[åŸ]Androidç¨‹åºçŒ¿å¦‚ä½•æ³¡è®¾è®¡å¦¹ä¹‹å¿«é€ŸæŒæ¡dpå’Œpxæ‰å¯ä»¥</title>
    <link href="http://www.kennethyo.me/2015/01/25/2015-01-25/"/>
    <id>http://www.kennethyo.me/2015/01/25/2015-01-25/</id>
    <published>2015-01-25T14:44:22.000Z</published>
    <updated>2016-09-01T06:35:53.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç›¸ä¿¡å¾ˆå¤šAndroidç¨‹åºçŒ¿å·²ç»å¯¹èº«è¾¹çš„è®¾è®¡å¦¹å‚æ¶ä¸‰å°ºäº†ï¼Œé‚£ä¹ˆå¦‚ä½•åšå¾—è®¾è®¡å¦¹çš„å¥½æ„Ÿå‘¢ï¼Œå­¦å¥½è¿™ç¯‡æ–‡ç« å°±å¯ä»¥äº†ã€‚</p>
<p>ç¨‹åºçŒ¿ä¸UIè®¾è®¡å¦¹è®¨è®ºè®¾è®¡ç¨¿å’Œåˆ‡å›¾çš„æ—¶å€™ï¼Œç»å¸¸ä¼šå› ä¸ºdpå’Œpxçš„é—®é¢˜æçš„ä¸æ„‰å¿«ï¼Œè¿™é‡Œå¯ä»¥åˆ†æå‡ºä¸¤ä¸ªåŸå› ï¼š</p>
<p>1ï¼Œç¨‹åºçŒ¿åŸå› ï¼Œä¸æ‡‚dpå’Œpxçš„æ¢ç®—å…³ç³»ã€‚åŒ…æ‹¬æˆ‘ï¼Œä»¥åŠæˆ‘è§åˆ°çš„å¤§å¤šæ•°å¼€å‘ï¼Œæ›´å¤šçš„æ—¶å€™å…¶å®ä¸æ˜¯å¾ˆå…³å¿ƒdpå’Œpxæ˜¯å¦‚ä½•æ¥çš„ï¼Œä»¥åŠå¦‚ä½•è½¬æ¢çš„ï¼ŒåªçŸ¥é“æŒæ¡ä¸€èˆ¬æƒ…å†µç”¨dpï¼Œå­—ä½“å¤§å°ç”¨spï¼Œç”»çº¿ç”¨pxã€‚</p>
<p>2ï¼Œè®¾è®¡å¦¹åŸå› ï¼Œè®¾è®¡ä¸å‡ºdpæ ‡æ³¨ï¼Œæˆ–è€…ç”šè‡³å°±ä¸æ‡‚dpæ˜¯ä»€ä¹ˆä¸œä¸œã€‚å¤§å¤šæ•°å…¬å¸å¹¶ä¸ä¼šä¸ºAndroidä¸“é—¨åšä¸€å¥—è®¾è®¡ç¨¿ï¼Œåªä¼šå‡ºä¸€ç‰ˆiOSè®¾è®¡ç¨¿ï¼Œè€ŒiOSçš„è®¾è®¡ç¨¿éƒ½æ˜¯ç”¨pxå»æ ‡æ³¨çš„ï¼Œåˆå› ä¸ºä¸Šé¢çš„ç¬¬ä¸€ä¸ªåŸå› ï¼ŒAndroidç¨‹åºçŒ¿ä¹Ÿæä¸æ˜ç™½æ ‡æ³¨çš„pxåº”è¯¥ç”¨å¤šå°‘dpã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬å°±ç”¨ç®€å•çš„æ–¹å¼å»å¢è¿›ç¨‹åºçŒ¿å’Œè®¾è®¡å¦¹æ„Ÿæƒ…å§ï¼</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦äº†è§£è¿™å¼ å›¾ï¼š</p>
<p><img src="http://img.blog.csdn.net/20150125224509843?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>è¿™é‡Œé¢åˆ—ä¸¾äº†ç›®å‰Androidå¼€å‘å¸¸è§çš„5ç§dpiï¼Œdpiæ˜¯æŒ‡æ¯è‹±å¯¸çš„åƒç´ ï¼ˆä¾‹å¦‚ï¼šä¸€ä¸ªå®½æ˜¯1.5è‹±å¯¸240åƒç´ ï¼Œé«˜æ˜¯2è‹±å¯¸320åƒç´ çš„æ‰‹æœºçš„dpiæ˜¯ï¼š240px/1.5in=320px/2in=160dpiï¼Œæ—¢å¯¹è§’çº¿ä¸Šçš„æ¯è‹±å¯¸çš„åƒç´ ï¼‰ï¼Œä¸Šé¢è¿™å¼ è¡¨é‡Œè¿˜å°‘ä¸€ç§ï¼Œå°±æ˜¯LDPIï¼Œæ˜¯MDPIçš„0.75å€ï¼Œä¹Ÿå°±æ˜¯120DPIã€‚</p>
<p>ä¸‹é¢è¿™å¼ å›¾æ˜¯å„ç§dpiå¯¹åº”çš„ä¸»æµæ‰‹æœºå±å¹•ï¼š</p>
<p><img src="http://img.blog.csdn.net/20150125224550469?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>è¯·æŒ‰ç…§å›¾ä¸­ä¸‹æ–¹çš„å…¬å¼ï¼Œåˆ†åˆ«è®¡ç®—ä¸€ä¸‹å±å¹•dpiã€‚åœ¨mdpiä¸­ï¼Œdp/pixel = DPI/160ï¼Œå³1dipç­‰ä»·äºDPIä¸º160çš„è®¾å¤‡ä¸­çš„1ä¸ªåƒç´ ç‚¹ã€‚é‚£ä¹ˆåœ¨xhdpi 320dpiä¸­ï¼Œå°±æ˜¯1dpç­‰ä»·äº2åƒç´ ï¼ˆå†æ¬¡å¼ºè°ƒï¼Œä¸€å®šç”¨è®¡ç®—å™¨ç®—ä¸€ç®—å•Šï¼Œè¿˜æœ‰dpiæ˜¯å¯¹è§’çº¿ä¸Šçš„åƒç´ å¯†åº¦ï¼‰ã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µè®¾è®¡å¦¹å‡ºçš„å›¾ä¼šæ˜¯xhdpiï¼Œæ—¢èƒ½ç…§é¡¾iOSï¼Œåˆä¼šç…§é¡¾åˆ°Androidã€‚æ—¢ç„¶æ˜¯xhdpiï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨1dp=2pxæ¥åº”å¯¹è®¾è®¡å¦¹çš„æ ‡æ³¨ã€‚å¦‚æœä¸æ˜¯xhdpiçš„å›¾ï¼Œä½ ä¹Ÿå¯ä»¥æŒ‰ç…§è¿™ä¸ª0.75:1:1.5:2:3:4è¿™ä¸ªæ¯”ä¾‹å»æ¢ç®—ä¸€ä¸‹ã€‚</p>
<p>å¸®åˆ°è¿™é‡Œäº†ï¼Œå‰©ä¸‹çš„è¿˜å¾—çœ‹ä½ çš„ä¿®ä¸ºäº†ã€‚</p>
<p>ä¸‹é¢æˆ‘å†ç»™å‡ºå‡ ä¸ªå¸¸ç”¨çš„&#20540;ï¼š</p>
<p>Launcher iconï¼š48dp*48dp</p>
<p>Action bar iconsï¼š32dp*32dp</p>
<p>Small iconsï¼š16dp*16dp</p>
<p>Notification iconsï¼š24dp*24dp</p>
<p>å¦‚æœè¿™äº›ä½ è¿˜ä¸æ»¡æ„ï¼Œå†ç»™ä½ æ¥å¼ å›¾ï¼ŒåŒ…ä½ æ»¡æ„ï¼š</p>
<p><img src="http://img.blog.csdn.net/20150125224602388?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>å†…å®¹å‚è€ƒä¸ç½‘ç»œå’Œ<a href="http://developer.android.com/guide/practices/screens_support.html#range" target="_blank" rel="external">Android.com</a></p>
<p>å¦‚æœæ‰“ä¸å¼€çš„è¯è¯·çœ‹è¿™é‡Œ<a href="http://www.kennethyo.me/post/category/cheng-xu-yuan-de-wu-qi-zhi-vpn">ã€Šç¨‹åºå‘˜çš„æ­¦å™¨ä¹‹ä¸€VPNã€‹</a></p>
<pre><code>&lt;div&gt;
    ä½œè€…ï¼šzh08070005 å‘è¡¨äº2015/1/25 22:44:22 [åŸæ–‡é“¾æ¥](http://blog.csdn.net/kennethyo/article/details/43123731)
&lt;/div&gt;
&lt;div&gt;
é˜…è¯»ï¼š1117 è¯„è®ºï¼š0 [æŸ¥çœ‹è¯„è®º](http://blog.csdn.net/kennethyo/article/details/43123731#comments)
&lt;/div&gt;
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç›¸ä¿¡å¾ˆå¤šAndroidç¨‹åºçŒ¿å·²ç»å¯¹èº«è¾¹çš„è®¾è®¡å¦¹å‚æ¶ä¸‰å°ºäº†ï¼Œé‚£ä¹ˆå¦‚ä½•åšå¾—è®¾è®¡å¦¹çš„å¥½æ„Ÿå‘¢ï¼Œå­¦å¥½è¿™ç¯‡æ–‡ç« å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç¨‹åºçŒ¿ä¸UIè®¾è®¡å¦¹è®¨è®ºè®¾è®¡ç¨¿å’Œåˆ‡å›¾çš„æ—¶å€™ï¼Œç»å¸¸ä¼šå› ä¸ºdpå’Œpxçš„é—®é¢˜æçš„ä¸æ„‰å¿«ï¼Œè¿™é‡Œå¯ä»¥åˆ†æå‡ºä¸¤ä¸ªåŸå› ï¼š&lt;/p&gt;
&lt;p&gt;1ï¼Œç¨‹åºçŒ¿åŸå› ï¼Œä¸æ‡‚dpå’Œpx
    
    </summary>
    
      <category term="Android" scheme="http://www.kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://www.kennethyo.me/tags/Android/"/>
    
  </entry>
  
</feed>
